

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/test_reptilia/reptilia/pyrate_mcmc_logs/rjmcmc/RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-199.90097184292873, -200.88889488497614,-201.87681792702352,-202.8647409690709,-203.85266401111832,-204.8405870531657,-205.8285100952131,-206.8164331372605,-207.8043561793079,-208.7922792213553,-209.78020226340269,-210.76812530545007,-211.75604834749748,-212.74397138954487,-213.73189443159225,-214.71981747363967,-215.70774051568705,-216.69566355773443,-217.68358659978185,-218.67150964182923,-219.65943268387664,-220.64735572592403,-221.6352787679714,-222.62320181001883,-223.6111248520662,-224.5990478941136,-225.586970936161,-226.5748939782084,-227.56281702025578,-228.5507400623032,-229.53866310435058,-230.526586146398,-231.51450918844537,-232.50243223049276,-233.49035527254014,-234.47827831458756,-235.46620135663494,-236.45412439868235,-237.44204744072974,-238.42997048277712,-239.41789352482454,-240.40581656687192,-241.39373960891933,-242.38166265096672,-243.3695856930141,-244.3575087350615,-245.3454317771089,-246.33335481915628,-247.3212778612037,-248.30920090325108,-249.29712394529847,-250.28504698734588,-251.27297002939326,-252.26089307144068,-253.24881611348806,-254.23673915553545,-255.22466219758283,-256.21258523963024,-257.2005082816777,-258.188431323725,-259.17635436577245,-260.1642774078198,-261.1522004498672,-262.14012349191455,-263.128046533962,-264.11596957600943,-265.10389261805676,-266.0918156601042,-267.07973870215153,-268.067661744199,-269.0555847862464,-270.04350782829374,-271.0314308703412,-272.0193539123885,-273.00727695443595,-273.9951999964834,-274.9831230385307,-275.97104608057816,-276.9589691226255,-277.94689216467293,-278.93481520672026,-279.9227382487677,-280.91066129081514,-281.89858433286247,-282.8865073749099,-283.87443041695724,-284.8623534590047,-285.8502765010521,-286.83819954309945,-287.8261225851469,-288.8140456271942,-289.80196866924166,-290.7898917112891,-291.77781475333643,-292.76573779538387,-293.7536608374312,-294.74158387947864,-295.72950692152597,-296.7174299635734,-297.70535300562085)
rate=c(0.49796108805249584, 0.5006385093010546,0.501410489642791,0.058993386219019145,0.05898620368834808,0.05898820723025649,0.0589897312417239,0.05898820723025649,0.0589925353792741,0.0589925353792741,0.05899139636231236,0.05899139636231236,0.05898820723025649,0.05898620368834808,0.058982373076367715,0.0589812672518335,0.05898033844272398,0.058975044026764345,0.058957782257805055,0.05894764905308489,0.05892662918116277,0.05892267861569919,0.058908439717369664,0.058904383811693065,0.058893957939187884,0.05887516026920115,0.059177544253295744,0.06541419378244234,0.1628873131263475,0.16378587751549922,0.16379560430131873,0.16379159691737563,0.1637888646054421,0.1637888646054421,0.1638035127744184,0.16389009696553675,0.1640567494714049,0.16418764743593073,0.16420716354655407,0.16420716354655407,0.16421983113294353,0.16422685698542788,0.16424814284126033,0.1642664139075966,0.16428044428955257,0.1649036990703927,0.17155456759560683,0.3597634090186916,0.36518468738635823,0.36531556220745065,0.364659370245391,0.364631499533027,0.4008055198731053,1.1962169231538073,0.16131473600362767,0.16078829034145273,0.16098739828932504,0.16107785857752582,0.1611628290574092,0.16123823736993417,0.1619555253351599,0.17210975816477003,0.1648296296092576,0.16338424576101893,0.16334032600558962,0.16328076980086959,0.1632158254010302,0.1630624317792531,0.1630010770680796,0.16288432995102503,0.16283617633355188,0.16276838017156928,0.1627483781641136,0.1627296973665602,0.1627217402024543,0.1626969095707309,0.1626840038138842,0.1626779127020654,0.16266861124842918,0.16266455672060648,0.16264728452553345,0.1626034722372363,0.16265629919657537,0.1626840038138842,0.16268461615044835,0.16270060403527037,0.16276838017156928,0.1627880113590892,0.16309904091611588,0.16476951617828373,0.1683681386440169,0.18595671516560083,0.5442618197723812,0.6253481595276651,0.6377688641648778,0.6399531216258973,0.6423874314653526,0.6398169458643721,0.6386907780872996,0.6406415360974902)
minHPD=c(0.33412792885092213, 0.3470468594904712,0.34687286250638655,0.048828969199262766,0.04892179512189804,0.04882476867242452,0.048828969199262766,0.048828969199262766,0.04883112135184032,0.048971134034366544,0.04898681923997568,0.048971134034366544,0.04899188999993861,0.04899524195555942,0.04899188999993861,0.049010696084061105,0.049010696084061105,0.04899524195555942,0.04885991166065871,0.04882476867242452,0.048861721147947464,0.048846394536417787,0.048828969199262766,0.04882476867242452,0.048846394536417787,0.048181006910550474,0.044981117699604736,0.0492263021071922,0.12346406000934047,0.14083237819325098,0.14039354174372737,0.14039354174372737,0.14046421580687754,0.14046421580687754,0.14039354174372737,0.1406726234235968,0.1411588045640543,0.14211016662674975,0.1410511144725543,0.1411243173800378,0.14213535062457233,0.14211016662674975,0.14206468290165428,0.14211016662674975,0.14124178253850386,0.13645697051526115,0.13925841839501954,0.15985256114094865,0.28215569642744204,0.28403334266268293,0.2848556954100319,0.2820236887857166,0.2813381545078682,0.7410252739161332,0.06883822228899762,0.07392291978572266,0.07801675220122126,0.07823220632097319,0.07823220632097319,0.0782278397549447,0.07552182478085756,0.11524944176353892,0.10447156515083254,0.1152307597003978,0.1152492664015873,0.1152492664015873,0.11426183358164228,0.11496754261320638,0.1152492664015873,0.1152307597003978,0.11496754261320638,0.11448742435667583,0.11448742435667583,0.11448742435667583,0.11448742435667583,0.11426183358164228,0.11428852917278746,0.11496754261320638,0.1152307597003978,0.11496754261320638,0.11496754261320638,0.11496754261320638,0.11448742435667583,0.11426183358164228,0.11351867596770415,0.1152492664015873,0.11215164623410802,0.111327150581386,0.1105914854430629,0.07979573682454291,0.09432913975990799,0.09737156383662239,0.11351867596770415,0.12323242193790676,0.12763287627373465,0.12763287627373465,0.13139680905003642,0.1280892686375215,0.12763287627373465,0.12763287627373465)
maxHPD=c(0.6899652284516143, 0.6900596737395894,0.6899652284516143,0.07058299512171357,0.07035407421152094,0.07023597343696758,0.07023597343696758,0.07023597343696758,0.07023597343696758,0.07035407421152094,0.07035407421152094,0.07035407421152094,0.07035407421152094,0.07035407421152094,0.0703481978369602,0.07035407421152094,0.07035407421152094,0.07035407421152094,0.07024696590424971,0.07023597343696758,0.07035407421152094,0.07035407421152094,0.07035407421152094,0.07043159106575249,0.07058299512171357,0.07035407421152094,0.07574051217620148,0.1774767282122078,0.19833203679537534,0.18936896708591106,0.18823897126975014,0.18820842850036912,0.18823897126975014,0.18820842850036912,0.18796891025531287,0.18806499684995448,0.18842805257829334,0.1893707214028809,0.18842805257829334,0.18848663497617915,0.18956253319982044,0.18956253319982044,0.18960464756304332,0.189783269152843,0.1893707214028809,0.19497133999146302,0.370290942456881,0.4449431667746545,0.4545655543586592,0.45456598420078326,0.45566972122654026,0.45456598420078326,1.334603412266457,1.810663512409787,0.2119171933782454,0.207914044668583,0.21016217680468488,0.2099722092429417,0.2099722092429417,0.2099722092429417,0.21235356444377843,0.9973580299697657,0.2211658911570307,0.20849433712174273,0.20822567634600872,0.20822567634600872,0.20706734429500998,0.20733435055219998,0.20747513269306858,0.20747513269306858,0.20735925984105896,0.20696422149341562,0.20696422149341562,0.20696102050269063,0.20696102050269063,0.20696422149341562,0.20735925984105896,0.20828388498802805,0.20880207537090206,0.2086322755309474,0.2086322755309474,0.20880207537090206,0.20857345462209712,0.20897032880785923,0.20878658518214724,0.2110224367689662,0.20884626682502155,0.20884626682502155,0.2125110829370515,0.3119241978963652,0.5812984107046407,1.0238551841951102,1.4588999183878364,1.5586146058267025,1.5560863968957033,1.5415829125469331,1.5418889376796634,1.5165737222859832,1.5085863554561725,1.5112133296538597)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.9917298636507659), xlim = c(-298.1993145266445,-199.40701032190503), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (Reptilia_cleaned_pyrate_input_1_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-199.9059613532421, -200.90386341591625,-201.90176547859036,-202.8996675412645,-203.89756960393865,-204.8954716666128,-205.8933737292869,-206.89127579196105,-207.8891778546352,-208.88707991730934,-209.88498197998345,-210.8828840426576,-211.88078610533174,-212.87868816800588,-213.87659023068,-214.87449229335414,-215.87239435602828,-216.87029641870242,-217.86819848137654,-218.86610054405068,-219.86400260672482,-220.86190466939897,-221.85980673207308,-222.85770879474723,-223.85561085742137,-224.8535129200955,-225.85141498276965,-226.84931704544377,-227.8472191081179,-228.84512117079205,-229.84302323346617,-230.8409252961403,-231.83882735881446,-232.8367294214886,-233.83463148416274,-234.83253354683686,-235.830435609511,-236.82833767218514,-237.82623973485926,-238.8241417975334,-239.82204386020754,-240.8199459228817,-241.81784798555583,-242.81575004822994,-243.8136521109041,-244.81155417357823,-245.80945623625234,-246.8073582989265,-247.80526036160063,-248.80316242427477,-249.80106448694892,-250.79896654962306,-251.79686861229717,-252.79477067497132,-253.79267273764546,-254.79057480031958,-255.78847686299372,-256.78637892566786,-257.784280988342,-258.78218305101615,-259.7800851136903,-260.77798717636443,-261.7758892390385,-262.77379130171266,-263.7716933643868,-264.76959542706095,-265.7674974897351,-266.76539955240924,-267.7633016150834,-268.76120367775746,-269.7591057404316,-270.75700780310575,-271.7549098657799,-272.75281192845404,-273.7507139911282,-274.7486160538023,-275.74651811647647,-276.7444201791506,-277.74232224182475,-278.74022430449884,-279.738126367173,-280.7360284298471,-281.73393049252127,-282.7318325551954,-283.72973461786955,-284.72763668054364,-285.7255387432178,-286.7234408058919,-287.72134286856607,-288.7192449312402,-289.71714699391435,-290.7150490565885,-291.71295111926264,-292.7108531819368,-293.7087552446109,-294.70665730728507,-295.70455936995916,-296.7024614326333,-297.70036349530744)
counts=c(0.0146, 0.0044,0.9974,0.0026,0.0008,0.0001,0.0003,0.0003,0.0003,0.0001,0.0003,0.0003,0.0001,0.0004,0.0004,0.0005,0.0013,0.0006,0.0016,0.0015,0.0006,0.0005,0.0008,0.0017,0.006,0.071,0.5716,0.3369,0.0188,0.0017,0.0013,0.0008,0.0007,0.0017,0.0038,0.0073,0.0042,0.0008,0.0004,0.0008,0.0002,0.0011,0.0017,0.0048,0.1166,0.4265,0.4334,0.0217,0.0054,0.0049,0.029,0.9455,0.7365,0.2767,0.0047,0.0033,0.0017,0.0018,0.0027,0.1599,0.0608,0.1431,0.0016,0.0014,0.0013,0.0034,0.0036,0.0018,0.0011,0.0013,0.0011,0.001,0.001,0.001,0.0015,0.0011,0.001,0.0007,0.001,0.0007,0.001,0.0022,0.0014,0.0012,0.003,0.002,0.007,0.0425,0.0754,0.2142,0.2964,0.0898,0.0265,0.0121,0.0092,0.0094,0.0083,0.009,0.0062)
plot(mids,counts,type = 'h', xlim = c(-298.1993145266445,-199.40701032190503), ylim=c(0,0.9974), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.0341853944922585
bf6 = 0.20731715879542692
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-199.90097184292873, -200.88889488497614,-201.87681792702352,-202.8647409690709,-203.85266401111832,-204.8405870531657,-205.8285100952131,-206.8164331372605,-207.8043561793079,-208.7922792213553,-209.78020226340269,-210.76812530545007,-211.75604834749748,-212.74397138954487,-213.73189443159225,-214.71981747363967,-215.70774051568705,-216.69566355773443,-217.68358659978185,-218.67150964182923,-219.65943268387664,-220.64735572592403,-221.6352787679714,-222.62320181001883,-223.6111248520662,-224.5990478941136,-225.586970936161,-226.5748939782084,-227.56281702025578,-228.5507400623032,-229.53866310435058,-230.526586146398,-231.51450918844537,-232.50243223049276,-233.49035527254014,-234.47827831458756,-235.46620135663494,-236.45412439868235,-237.44204744072974,-238.42997048277712,-239.41789352482454,-240.40581656687192,-241.39373960891933,-242.38166265096672,-243.3695856930141,-244.3575087350615,-245.3454317771089,-246.33335481915628,-247.3212778612037,-248.30920090325108,-249.29712394529847,-250.28504698734588,-251.27297002939326,-252.26089307144068,-253.24881611348806,-254.23673915553545,-255.22466219758283,-256.21258523963024,-257.2005082816777,-258.188431323725,-259.17635436577245,-260.1642774078198,-261.1522004498672,-262.14012349191455,-263.128046533962,-264.11596957600943,-265.10389261805676,-266.0918156601042,-267.07973870215153,-268.067661744199,-269.0555847862464,-270.04350782829374,-271.0314308703412,-272.0193539123885,-273.00727695443595,-273.9951999964834,-274.9831230385307,-275.97104608057816,-276.9589691226255,-277.94689216467293,-278.93481520672026,-279.9227382487677,-280.91066129081514,-281.89858433286247,-282.8865073749099,-283.87443041695724,-284.8623534590047,-285.8502765010521,-286.83819954309945,-287.8261225851469,-288.8140456271942,-289.80196866924166,-290.7898917112891,-291.77781475333643,-292.76573779538387,-293.7536608374312,-294.74158387947864,-295.72950692152597,-296.7174299635734,-297.70535300562085)
rate=c(6.499623359284383, 0.5683573542514982,0.5595937119736196,0.15137963661320786,0.15097608297517837,0.1510031390778292,0.15104958590035683,0.151143090794727,0.15122844396043578,0.15127854081806896,0.15127854081806896,0.15124859662269474,0.15112320468928675,0.14883165773036344,0.13286248540936846,0.041410321570146735,0.03715906526321319,0.03702089936200301,0.03702089936200301,0.037020310691133824,0.0370182377261368,0.037011151566547426,0.0370182377261368,0.037014630565698745,0.037008333786342884,0.0370182377261368,0.03718527293758492,0.042419694966225316,0.12669170587087775,0.1266762234512588,0.1265755177086822,0.1265653035784694,0.12657280563685036,0.12660554836250879,0.1267535205887162,0.12734511767651252,0.1295698268717146,0.13730588450518305,0.1530548102533232,0.16282790352869086,0.17013670449996976,0.18070940667875962,0.2147195332677334,0.24240281126632152,0.24336236567382505,0.24335506707802224,0.24324119898358132,0.24327590321361192,0.244269967457713,0.24515258081594732,0.24519608960525813,0.24580251107660495,0.2501208135381565,0.2550361585818949,0.2530718747274478,0.24990105565939985,0.24313074676286484,0.16129869083923662,0.1273179389078564,0.124985685017999,0.12456722611393514,0.12444936676185286,0.1240148382914486,0.12341851560595318,0.12276011085827962,0.12248732036894128,0.12232348833888779,0.12210755508026283,0.12194615441766529,0.12188417177463723,0.12185634400432929,0.12184988248042447,0.12185306097922916,0.12186280224000778,0.12187448555290745,0.12191447073677099,0.12193276640730916,0.12193714420557294,0.12194868211586005,0.12206406123592156,0.12213388709914902,0.12229656425533827,0.12260662149448358,0.12293352810588684,0.12320183415573674,0.12342563964325405,0.12341851560595318,0.12341681669930286,0.12342563964325405,0.12343695102240387,0.12344168671355689,0.12345028620804988,0.1234990602744569,0.12374131995516362,0.12452276914842098,0.12532174868582033,0.12595670137148016,0.1261726326505775,0.12630507333303476,0.12632818979366003)
minHPD=c(3.1423302522608365, 0.3607073295477434,0.13979485208761747,0.11863846451915208,0.1198776120546598,0.12013079269124903,0.11983257623643646,0.1198776120546598,0.11983257623643646,0.11992658637523726,0.11990758526045235,0.11983257623643646,0.11998759968800495,0.04154601534660334,0.02840312448276731,0.024570196140347937,0.024151743158603304,0.024531866281860933,0.024531866281860933,0.024595900452506637,0.024570196140347937,0.024575237698007606,0.024575237698007606,0.024595900452506637,0.024531866281860933,0.024151743158603304,0.02312507787899806,0.02440856494416877,0.09066786949960558,0.09190017437791355,0.09190751330620275,0.09066786949960558,0.09077747536505489,0.09190751330620275,0.09164164641094572,0.08911616245206305,0.08651033171696264,0.09920030880825553,0.11503440127530293,0.11503440127530293,0.11503544370917888,0.11518452108215745,0.11660398047511407,0.18566544055034787,0.19302940289543985,0.19370822882761377,0.19365925460063566,0.19383462562154488,0.19623391048396338,0.19597481673830058,0.1938349361018754,0.19365925460063566,0.18533340436360127,0.18921552085116553,0.12257509738379217,0.10704903612330155,0.09027389121353749,0.0903172171764954,0.08655544172637888,0.08488786925156697,0.08488786925156697,0.08488786925156697,0.08395278402688962,0.07071102160951487,0.08045297281653743,0.08455403096636528,0.08455403096636528,0.08488786925156697,0.08488786925156697,0.08530954174372614,0.08488786925156697,0.08488786925156697,0.08488786925156697,0.08489979265190899,0.08489979265190899,0.08532449136999934,0.085059925272478,0.08530954174372614,0.08530954174372614,0.08489979265190899,0.08489979265190899,0.08495339735961661,0.08455403096636528,0.08489979265190899,0.08463650690353723,0.0829194965967046,0.08455403096636528,0.08454093229876286,0.08421358986456498,0.0827207943975487,0.08236146031839615,0.08233549084646814,0.08426818462525221,0.0791136953051265,0.07389558190600745,0.06727230340340226,0.06727230340340226,0.07155457975413135,0.07284263652158537,0.070961555885957)
maxHPD=c(10.766773221154303, 0.8115668492540556,0.7680183642746025,0.19123199915298228,0.18564852272330448,0.18567142520998353,0.18502832495867763,0.18480536820042398,0.18480536820042398,0.18502832495867763,0.18502832495867763,0.18502832495867763,0.18567142520998353,0.18480164307851343,0.16807643011032036,0.15432524238701317,0.050977603899901414,0.05007840013733486,0.05007840013733486,0.05012860947686278,0.05009101754721962,0.05009101754721962,0.05009101754721962,0.05012860947686278,0.050087979781220315,0.04982257667838892,0.05184757883450626,0.13822862519993928,0.15924806590783916,0.1590402556604981,0.15855976792170534,0.1572739175636724,0.15742104251240988,0.15855976792170534,0.15892125267654816,0.15998357496458154,0.21066732953679976,0.24528738034990538,0.2553479175898925,0.2535777010474726,0.253791882923613,0.25440200278369485,0.26604183808345166,0.3016405242640489,0.29611535517484916,0.29573622817506406,0.2954392026480745,0.2957183884658888,0.2989351659616025,0.3008961512301483,0.2989351659616025,0.3037492168908112,0.39464256045419066,0.5464639726646927,0.48364410374569583,0.4138607176529238,0.3403373879197756,0.28644641846017704,0.24977709877366946,0.2316909296126336,0.2269373999534769,0.2240097878103517,0.2182391001043165,0.1842298188121373,0.16859224577228626,0.16796195388051186,0.1654786943123466,0.16306155783129514,0.1628302587690216,0.16300552981293073,0.16233177852259675,0.16233177852259675,0.16233177852259675,0.16242449913171295,0.16242449913171295,0.162958245799906,0.16273023838362188,0.16300552981293073,0.16306155783129514,0.16273023838362188,0.16304923848652308,0.16416651728292758,0.16465501366210966,0.16740694058786368,0.16902541292664172,0.1702772181285379,0.17135670686521742,0.17135670686521742,0.17135670686521742,0.1702772181285379,0.1702772181285379,0.1712525103371487,0.175346325793764,0.1782305274600211,0.2255797658113219,0.43041899648824067,0.5806875982600558,0.6252507365892094,0.6382773001152047,0.6382773001152047)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 11.843450543269734), xlim = c(-298.1993145266445,-199.40701032190503), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-199.9059613532421, -200.90386341591625,-201.90176547859036,-202.8996675412645,-203.89756960393865,-204.8954716666128,-205.8933737292869,-206.89127579196105,-207.8891778546352,-208.88707991730934,-209.88498197998345,-210.8828840426576,-211.88078610533174,-212.87868816800588,-213.87659023068,-214.87449229335414,-215.87239435602828,-216.87029641870242,-217.86819848137654,-218.86610054405068,-219.86400260672482,-220.86190466939897,-221.85980673207308,-222.85770879474723,-223.85561085742137,-224.8535129200955,-225.85141498276965,-226.84931704544377,-227.8472191081179,-228.84512117079205,-229.84302323346617,-230.8409252961403,-231.83882735881446,-232.8367294214886,-233.83463148416274,-234.83253354683686,-235.830435609511,-236.82833767218514,-237.82623973485926,-238.8241417975334,-239.82204386020754,-240.8199459228817,-241.81784798555583,-242.81575004822994,-243.8136521109041,-244.81155417357823,-245.80945623625234,-246.8073582989265,-247.80526036160063,-248.80316242427477,-249.80106448694892,-250.79896654962306,-251.79686861229717,-252.79477067497132,-253.79267273764546,-254.79057480031958,-255.78847686299372,-256.78637892566786,-257.784280988342,-258.78218305101615,-259.7800851136903,-260.77798717636443,-261.7758892390385,-262.77379130171266,-263.7716933643868,-264.76959542706095,-265.7674974897351,-266.76539955240924,-267.7633016150834,-268.76120367775746,-269.7591057404316,-270.75700780310575,-271.7549098657799,-272.75281192845404,-273.7507139911282,-274.7486160538023,-275.74651811647647,-276.7444201791506,-277.74232224182475,-278.74022430449884,-279.738126367173,-280.7360284298471,-281.73393049252127,-282.7318325551954,-283.72973461786955,-284.72763668054364,-285.7255387432178,-286.7234408058919,-287.72134286856607,-288.7192449312402,-289.71714699391435,-290.7150490565885,-291.71295111926264,-292.7108531819368,-293.7087552446109,-294.70665730728507,-295.70455936995916,-296.7024614326333,-297.70036349530744)
counts=c(0.9983, 0.0596,0.9183,0.0167,0.0023,0.0018,0.003,0.0025,0.0012,0.0004,0.001,0.0052,0.0785,0.3757,0.3355,0.2025,0.0069,0.0006,0.0002,0.0001,0.0002,0.0005,0.0003,0.0006,0.0039,0.0471,0.4923,0.4556,0.0041,0.002,0.0007,0.0005,0.0024,0.0047,0.0286,0.0648,0.2258,0.1492,0.0227,0.0064,0.0287,0.1935,0.2756,0.0041,0.0038,0.0015,0.0021,0.0292,0.0016,0.003,0.0284,0.1038,0.0189,0.0577,0.058,0.2337,0.4041,0.1412,0.0219,0.0108,0.0091,0.0187,0.0181,0.0123,0.0061,0.0073,0.0041,0.0022,0.0013,0.0011,0.0007,0.0006,0.0014,0.0012,0.0009,0.0007,0.0004,0.0013,0.0025,0.0042,0.0073,0.0078,0.0071,0.0071,0.002,0.0029,0.0015,0.0011,0.0012,0.0024,0.003,0.009,0.0265,0.025,0.0186,0.0077,0.0062,0.0045,0.0022)
plot(mids,counts,type = 'h', xlim = c(-298.1993145266445,-199.40701032190503), ylim=c(0,0.9983), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-199.90097184292873, -200.88889488497614,-201.87681792702352,-202.8647409690709,-203.85266401111832,-204.8405870531657,-205.8285100952131,-206.8164331372605,-207.8043561793079,-208.7922792213553,-209.78020226340269,-210.76812530545007,-211.75604834749748,-212.74397138954487,-213.73189443159225,-214.71981747363967,-215.70774051568705,-216.69566355773443,-217.68358659978185,-218.67150964182923,-219.65943268387664,-220.64735572592403,-221.6352787679714,-222.62320181001883,-223.6111248520662,-224.5990478941136,-225.586970936161,-226.5748939782084,-227.56281702025578,-228.5507400623032,-229.53866310435058,-230.526586146398,-231.51450918844537,-232.50243223049276,-233.49035527254014,-234.47827831458756,-235.46620135663494,-236.45412439868235,-237.44204744072974,-238.42997048277712,-239.41789352482454,-240.40581656687192,-241.39373960891933,-242.38166265096672,-243.3695856930141,-244.3575087350615,-245.3454317771089,-246.33335481915628,-247.3212778612037,-248.30920090325108,-249.29712394529847,-250.28504698734588,-251.27297002939326,-252.26089307144068,-253.24881611348806,-254.23673915553545,-255.22466219758283,-256.21258523963024,-257.2005082816777,-258.188431323725,-259.17635436577245,-260.1642774078198,-261.1522004498672,-262.14012349191455,-263.128046533962,-264.11596957600943,-265.10389261805676,-266.0918156601042,-267.07973870215153,-268.067661744199,-269.0555847862464,-270.04350782829374,-271.0314308703412,-272.0193539123885,-273.00727695443595,-273.9951999964834,-274.9831230385307,-275.97104608057816,-276.9589691226255,-277.94689216467293,-278.93481520672026,-279.9227382487677,-280.91066129081514,-281.89858433286247,-282.8865073749099,-283.87443041695724,-284.8623534590047,-285.8502765010521,-286.83819954309945,-287.8261225851469,-288.8140456271942,-289.80196866924166,-290.7898917112891,-291.77781475333643,-292.76573779538387,-293.7536608374312,-294.74158387947864,-295.72950692152597,-296.7174299635734,-297.70535300562085)
net_rate=c(-6.221008639555551, -0.06828866618526708,-0.043148293010980686,-0.09748682951791267,-0.0926738785655474,-0.09271203676236321,-0.09283732569567629,-0.09303921401465888,-0.09315449590948224,-0.09329668427094939,-0.09329795393063837,-0.09322700752907573,-0.09291089052408802,-0.08574598407075226,-0.04450669444539411,-0.007579234016524564,0.02074216098797598,0.021765420632733533,0.02175112606776175,0.021734032967049073,0.02169400538779822,0.021685831247369915,0.02166004761339188,0.021647313792455165,0.021582283225037382,0.021487201366570396,0.023668802086065092,0.03552239763671372,0.03315650829203423,0.03770318596573798,0.03798943989992779,0.03800073733960533,0.037986761602690995,0.037952753706177386,0.037660590888304896,0.036478324929545156,0.030908257256580515,0.011981706298332685,-0.012441424319237568,-0.01654143676520006,-0.017384260387001162,-0.01804510322339083,-0.03167506098680517,-0.07676392285181416,-0.07905620215245972,-0.07417897281360909,-0.030260060234729463,0.10959697296999034,0.12269384655702595,0.12120712367510553,0.1196619981922278,0.11855432800388134,0.3511029138606827,0.91953526675787,-0.11321499767664109,-0.10450723511460658,-0.08044014509656121,-0.0303903194974589,0.013528209784683526,0.02210012977679261,0.028405683262486478,0.16032299290425123,0.052503555204606096,0.03611899914085646,0.03815661925636409,0.03899751135260745,0.0394212211395952,0.039661202054969306,0.03976648814251762,0.039757800955661136,0.03974812149225409,0.039666149488994225,0.03962000670298607,0.03957022674272937,0.03955197163249163,0.03947298143450705,0.039422493017874656,0.0393759598326819,0.039321315897637696,0.0391996106384993,0.03897580057655077,0.03854166697957525,0.03769391107640945,0.03700680340774568,0.03602768487104508,0.03486554109639643,0.035767431329342195,0.036230216372394486,0.037817379074000686,0.053143547546259835,0.08793850051334606,0.24221148461962894,0.48406383907393,0.550036652570806,0.5401617341833548,0.5241799187546465,0.5121469892627545,0.5042854485625033,0.5013465281842643,0.5044925634498423)
net_minHPD=c(-10.424856156124575, -0.3408873063968551,-0.3351229800735333,-0.13450168716318983,-0.12780132658924384,-0.12780132658924384,-0.12780132658924384,-0.12780132658924384,-0.12780054188093523,-0.1278636137041985,-0.1278636137041985,-0.12780132658924384,-0.12780132658924384,-0.12780132658924384,-0.11042639477715052,-0.09861058447400695,0.0043311237964060514,0.0044728247129412965,0.00452423303799325,0.00452423303799325,0.0044728247129412965,0.00445320945912786,0.004358175311822768,0.004354801959537892,0.004085936273558938,0.0043311237964060514,-0.04067219088019593,-0.0762706873214281,-0.03879176790543633,-0.003680745333746821,-0.003010384293947871,-0.0030164597710560515,-0.0029680165447023565,-0.002991794047250196,-0.003493981532233792,-0.003791674690150376,-0.045774938807354365,-0.08395170724641504,-0.0945716020884301,-0.09587351896690754,-0.09715059605511445,-0.09738507081173217,-0.1080544698178274,-0.14290113275686478,-0.1357113184505947,-0.1513163381834416,-0.13565961280922545,-0.08085667159755969,0.022010964896080232,0.02027338956153185,0.020381148715770236,0.020650580144998265,-0.054262248186003226,0.38232279223923443,-0.4019817942076163,-0.28556836505625105,-0.2077164001477715,-0.15608673169544218,-0.10007997253474124,-0.07953789256691216,-0.07955787125334257,-0.10567090228135476,-0.09516645451762654,-0.03597639308303818,-0.02969802694381697,-0.030235072865784918,-0.028747142258883918,-0.02525635587062744,-0.023545890331400837,-0.018693335077976825,-0.02360057852659883,-0.023442560068691,-0.023460192971480165,-0.023442560068691,-0.023460192971480165,-0.023545890331400837,-0.023460192971480165,-0.023545890331400837,-0.024522257898092495,-0.024522257898092495,-0.024981495801430997,-0.025819776568166142,-0.02683839758058154,-0.03032100243723776,-0.032562291010200514,-0.0325095403041088,-0.030235072865784918,-0.03101672363966103,-0.03563859576397983,-0.09563530365863065,-0.06197266331040094,-0.05322279387833134,-0.029759261255081132,-0.018975476933453972,-0.02877039815330565,-0.06418789996598762,-0.0959518336667391,-0.07448002313290547,-0.1039078988631097,-0.10570261691045357)
net_maxHPD=c(-2.8136425412977366, 0.1794812224149302,0.3134182233492998,-0.0561977843303787,-0.05895502417177207,-0.05918062050923761,-0.0594574097580966,-0.059670844688336375,-0.059636342003841936,-0.059636342003841936,-0.059636342003841936,-0.059409072200666664,-0.05890183060714093,0.016181391198648525,0.03499038300868793,0.03674707659010147,0.038865115656120205,0.037117047347930775,0.037117047347930775,0.037117047347930775,0.037117047347930775,0.037106184459114164,0.03706230262459639,0.037117047347930775,0.03717539729424921,0.03798045758426071,0.0477012808696711,0.14344998828412872,0.08931285435706661,0.08083430912973383,0.08044612975998586,0.0803347820492943,0.08044612975998586,0.08044612975998586,0.08047458191344208,0.08486415075642278,0.08956075531728687,0.07311899700758431,0.05758240543307683,0.05452448661078889,0.05331810088205795,0.05326242618725721,0.05471488823141066,-0.015097704157467834,-0.019907242609411457,-0.01374388099879012,0.13775210922725764,0.22573129061460406,0.22449019873740297,0.2191447677530577,0.21967391719907112,0.22737455972300444,1.1065033170630336,1.5383783498069203,0.040424170256083455,0.052333693517620405,0.08024084121452876,0.08604810859751927,0.09624105939746111,0.09660401067963854,0.1005205589266417,0.8733151945938239,0.11001311133636478,0.10811348863194371,0.1024703652945408,0.09798875131281319,0.09718135117291325,0.097109901387427,0.09798875131281319,0.10249338566802305,0.09718135117291325,0.09718135117291325,0.097109901387427,0.097109901387427,0.097109901387427,0.09748638523922293,0.09798875131281319,0.09798875131281319,0.09718135117291325,0.09718135117291325,0.09718135117291325,0.09718135117291325,0.09718135117291325,0.09718135117291325,0.09814506087355938,0.10169047712517934,0.10451144031574497,0.10463943982160184,0.10542159717986464,0.2080809795385583,0.4806788270255532,0.921919391545061,1.345871861676458,1.4483110450206647,1.4907636508661362,1.508852388364849,1.508852388364849,1.5133437549136763,1.4906060774483767,1.4915013430741455)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-11.467341771737033, 1.6922161847876125), xlim = c(-298.1993145266445,-199.40701032190503), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-199.90097184292873, -200.88889488497614,-201.87681792702352,-202.8647409690709,-203.85266401111832,-204.8405870531657,-205.8285100952131,-206.8164331372605,-207.8043561793079,-208.7922792213553,-209.78020226340269,-210.76812530545007,-211.75604834749748,-212.74397138954487,-213.73189443159225,-214.71981747363967,-215.70774051568705,-216.69566355773443,-217.68358659978185,-218.67150964182923,-219.65943268387664,-220.64735572592403,-221.6352787679714,-222.62320181001883,-223.6111248520662,-224.5990478941136,-225.586970936161,-226.5748939782084,-227.56281702025578,-228.5507400623032,-229.53866310435058,-230.526586146398,-231.51450918844537,-232.50243223049276,-233.49035527254014,-234.47827831458756,-235.46620135663494,-236.45412439868235,-237.44204744072974,-238.42997048277712,-239.41789352482454,-240.40581656687192,-241.39373960891933,-242.38166265096672,-243.3695856930141,-244.3575087350615,-245.3454317771089,-246.33335481915628,-247.3212778612037,-248.30920090325108,-249.29712394529847,-250.28504698734588,-251.27297002939326,-252.26089307144068,-253.24881611348806,-254.23673915553545,-255.22466219758283,-256.21258523963024,-257.2005082816777,-258.188431323725,-259.17635436577245,-260.1642774078198,-261.1522004498672,-262.14012349191455,-263.128046533962,-264.11596957600943,-265.10389261805676,-266.0918156601042,-267.07973870215153,-268.067661744199,-269.0555847862464,-270.04350782829374,-271.0314308703412,-272.0193539123885,-273.00727695443595,-273.9951999964834,-274.9831230385307,-275.97104608057816,-276.9589691226255,-277.94689216467293,-278.93481520672026,-279.9227382487677,-280.91066129081514,-281.89858433286247,-282.8865073749099,-283.87443041695724,-284.8623534590047,-285.8502765010521,-286.83819954309945,-287.8261225851469,-288.8140456271942,-289.80196866924166,-290.7898917112891,-291.77781475333643,-292.76573779538387,-293.7536608374312,-294.74158387947864,-295.72950692152597,-296.7174299635734,-297.70535300562085)
rate=c(0.1487644290190897, 1.739418880798307,1.8142356594211244,6.344655622017895,6.583068416005052,6.581293874292798,6.575779519056402,6.56709227403829,6.56153717757309,6.555301279811289,6.555498667661333,6.558559631421558,6.572474996403713,6.89745678668075,9.639745552873332,14.969219715702353,25.987475729384013,26.707223332093257,26.71423824120078,26.72092389658517,26.721511483963432,26.72360780823961,26.7165441354312,26.7169877671957,26.716249991646713,26.686570925689868,25.740405467444084,15.023985091201602,7.928040758186009,7.93441987543242,7.94778567201739,7.949189197756324,7.948271533209391,7.946292958384449,7.924751541202326,7.842970150933323,7.492092854029288,6.54223588977551,5.640421116771648,5.513964586484169,5.487875341764827,5.46780309769362,5.0873302513279235,4.137190291637949,4.095507816896684,4.0983813404814375,4.105589796460326,4.1063175161963255,4.0708243550899565,4.041210256060245,4.040612266405608,4.017400189827815,3.777112990952484,3.420179434244122,3.61812983116738,3.8541944210085464,4.240669103507398,5.37898575813575,7.04078055153425,7.486021819627179,7.5730913973584615,7.622316707316769,7.705208166859083,7.8346495146289765,7.9665924080014126,8.023972954541646,8.064891842235555,8.119723129649495,8.139203706093436,8.146695655789959,8.149303244624695,8.149356306579362,8.14850130947938,8.146768182703738,8.1452511714193,8.143038845639254,8.141948735788393,8.140908853891114,8.13953407419371,8.132832136710654,8.119680387037228,8.093567916120588,8.03529561232217,7.98486143409884,7.918532267721615,7.840586783925038,7.880296395877623,7.897905480880366,7.897709356634354,7.892846327694208,7.888402758618273,7.878141663226133,7.830256796627021,7.551544430016265,6.5678727247952775,5.910427481331287,5.5274320577985385,5.432201315959643,5.409327133684342,5.416963718721333)
minHPD=c(0.1487644290190897, 1.739418880798307,1.8142356594211244,6.344655622017895,6.583068416005052,6.581293874292798,6.575779519056402,6.56709227403829,6.56153717757309,6.555301279811289,6.555498667661333,6.558559631421558,6.572474996403713,6.89745678668075,9.639745552873332,14.969219715702353,25.987475729384013,26.707223332093257,26.71423824120078,26.72092389658517,26.721511483963432,26.72360780823961,26.7165441354312,26.7169877671957,26.716249991646713,26.686570925689868,25.740405467444084,15.023985091201602,7.928040758186009,7.93441987543242,7.94778567201739,7.949189197756324,7.948271533209391,7.946292958384449,7.924751541202326,7.842970150933323,7.492092854029288,6.54223588977551,5.640421116771648,5.513964586484169,5.487875341764827,5.46780309769362,5.0873302513279235,4.137190291637949,4.095507816896684,4.0983813404814375,4.105589796460326,4.1063175161963255,4.0708243550899565,4.041210256060245,4.040612266405608,4.017400189827815,3.777112990952484,3.420179434244122,3.61812983116738,3.8541944210085464,4.240669103507398,5.37898575813575,7.04078055153425,7.486021819627179,7.5730913973584615,7.622316707316769,7.705208166859083,7.8346495146289765,7.9665924080014126,8.023972954541646,8.064891842235555,8.119723129649495,8.139203706093436,8.146695655789959,8.149303244624695,8.149356306579362,8.14850130947938,8.146768182703738,8.1452511714193,8.143038845639254,8.141948735788393,8.140908853891114,8.13953407419371,8.132832136710654,8.119680387037228,8.093567916120588,8.03529561232217,7.98486143409884,7.918532267721615,7.840586783925038,7.880296395877623,7.897905480880366,7.897709356634354,7.892846327694208,7.888402758618273,7.878141663226133,7.830256796627021,7.551544430016265,6.5678727247952775,5.910427481331287,5.5274320577985385,5.432201315959643,5.409327133684342,5.416963718721333)
maxHPD=c(0.1487644290190897, 1.739418880798307,1.8142356594211244,6.344655622017895,6.583068416005052,6.581293874292798,6.575779519056402,6.56709227403829,6.56153717757309,6.555301279811289,6.555498667661333,6.558559631421558,6.572474996403713,6.89745678668075,9.639745552873332,14.969219715702353,25.987475729384013,26.707223332093257,26.71423824120078,26.72092389658517,26.721511483963432,26.72360780823961,26.7165441354312,26.7169877671957,26.716249991646713,26.686570925689868,25.740405467444084,15.023985091201602,7.928040758186009,7.93441987543242,7.94778567201739,7.949189197756324,7.948271533209391,7.946292958384449,7.924751541202326,7.842970150933323,7.492092854029288,6.54223588977551,5.640421116771648,5.513964586484169,5.487875341764827,5.46780309769362,5.0873302513279235,4.137190291637949,4.095507816896684,4.0983813404814375,4.105589796460326,4.1063175161963255,4.0708243550899565,4.041210256060245,4.040612266405608,4.017400189827815,3.777112990952484,3.420179434244122,3.61812983116738,3.8541944210085464,4.240669103507398,5.37898575813575,7.04078055153425,7.486021819627179,7.5730913973584615,7.622316707316769,7.705208166859083,7.8346495146289765,7.9665924080014126,8.023972954541646,8.064891842235555,8.119723129649495,8.139203706093436,8.146695655789959,8.149303244624695,8.149356306579362,8.14850130947938,8.146768182703738,8.1452511714193,8.143038845639254,8.141948735788393,8.140908853891114,8.13953407419371,8.132832136710654,8.119680387037228,8.093567916120588,8.03529561232217,7.98486143409884,7.918532267721615,7.840586783925038,7.880296395877623,7.897905480880366,7.897709356634354,7.892846327694208,7.888402758618273,7.878141663226133,7.830256796627021,7.551544430016265,6.5678727247952775,5.910427481331287,5.5274320577985385,5.432201315959643,5.409327133684342,5.416963718721333)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 29.395968589063575), xlim = c(-298.1993145266445,-199.40701032190503), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()