pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/reptilia/pyrate_mcmc_logs/bdnn3_cross/Reptilia_cleaned_pyrate_input_1_BDS_BDNN_8_4Tc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(298.8661469593528, 285.00001,285.0,275.00001,275.0,265.00001,265.0,260.00001,260.0,255.00001,255.0,250.00001,250.0,245.00001,245.0,240.00001,240.0,235.00001,235.0,225.00001,225.0,215.00001,215.0,205.00001,205.0,199.11282125900559)
sp_mean=c(0.22321911762156085, 0.22321911762156085,0.18670438125411967,0.18670438125411967,0.21365230110076014,0.21365230110076014,0.2760948706464844,0.2760948706464844,0.2777124253127308,0.2777124253127308,0.2876340003451345,0.2876340003451345,0.26540596362199653,0.26540596362199653,0.2325321318362083,0.2325321318362083,0.1766589502169558,0.1766589502169558,0.11832811860244884,0.11832811860244884,0.05976764704660089,0.05976764704660089,0.04358803342195634,0.04358803342195634,0.13653240038133763,0.13653240038133763)
sp_lwr=c(0.1363448364748309, 0.1363448364748309,0.11239481964218473,0.11239481964218473,0.12132806588285032,0.12132806588285032,0.21542108121728065,0.21542108121728065,0.23228173299605445,0.23228173299605445,0.24336974359202296,0.24336974359202296,0.2233664083111788,0.2233664083111788,0.20144849429353642,0.20144849429353642,0.15318697231153763,0.15318697231153763,0.09981545690230412,0.09981545690230412,0.04426632847651669,0.04426632847651669,0.030312130187036136,0.030312130187036136,0.08336126738212288,0.08336126738212288)
sp_upr=c(0.3353443608476254, 0.3353443608476254,0.2627985741244152,0.2627985741244152,0.3002187048972501,0.3002187048972501,0.3424964453376561,0.3424964453376561,0.32651109928148697,0.32651109928148697,0.32555863679628116,0.32555863679628116,0.30634283249843564,0.30634283249843564,0.26525023075021714,0.26525023075021714,0.20155904809314507,0.20155904809314507,0.13682428161748417,0.13682428161748417,0.07427888208701985,0.07427888208701985,0.05587667322825028,0.05587667322825028,0.19016739754185935,0.19016739754185935)
ex_mean=c(0.13527492698181698, 0.13527492698181698,0.14335473808317178,0.14335473808317178,0.14783416383106274,0.14783416383106274,0.18232905728461185,0.18232905728461185,0.18612000249864633,0.18612000249864633,0.2003272325314472,0.2003272325314472,0.191123432160612,0.191123432160612,0.18350194392442162,0.18350194392442162,0.15767770317946744,0.15767770317946744,0.07020724692547727,0.07020724692547727,0.04057925115250954,0.04057925115250954,0.10793179262136673,0.10793179262136673,0.4619491515889456,0.4619491515889456)
ex_lwr=c(0.09159038414722666, 0.09159038414722666,0.10192631289541619,0.10192631289541619,0.11407721268656397,0.11407721268656397,0.1492414237064478,0.1492414237064478,0.15296777903941153,0.15296777903941153,0.17490976640773406,0.17490976640773406,0.16390886497073573,0.16390886497073573,0.1554844398558635,0.1554844398558635,0.12982668363921304,0.12982668363921304,0.05075129302610105,0.05075129302610105,0.026341648901188935,0.026341648901188935,0.08557265164459424,0.08557265164459424,0.380510952181553,0.380510952181553)
ex_upr=c(0.1904450482324891, 0.1904450482324891,0.19270484301318588,0.19270484301318588,0.1828504411981994,0.1828504411981994,0.22125316012529883,0.22125316012529883,0.21703509321813869,0.21703509321813869,0.22723499473196046,0.22723499473196046,0.2154916039828226,0.2154916039828226,0.20625047295198864,0.20625047295198864,0.18223093793236375,0.18223093793236375,0.09339188192091998,0.09339188192091998,0.05426140196830548,0.05426140196830548,0.13138032396521035,0.13138032396521035,0.5552866476243753,0.5552866476243753)
div_mean=c(0.08794419063974379, 0.08794419063974379,0.043349643170947964,0.043349643170947964,0.06581813726969747,0.06581813726969747,0.09376581336187244,0.09376581336187244,0.09159242281408439,0.09159242281408439,0.0873067678136872,0.0873067678136872,0.07428253146138468,0.07428253146138468,0.04903018791178665,0.04903018791178665,0.018981247037488658,0.018981247037488658,0.0481208716769714,0.0481208716769714,0.019188395894091347,0.019188395894091347,-0.06434375919941032,-0.06434375919941032,-0.32541675120760805,-0.32541675120760805)
div_lwr=c(-0.02242460842810487, -0.02242460842810487,-0.049319653305241795,-0.049319653305241795,-0.02473436419145117,-0.02473436419145117,0.021724387067826173,0.021724387067826173,0.03864351688352324,0.03864351688352324,0.0398459332369939,0.0398459332369939,0.02778117457063453,0.02778117457063453,0.00632932787076862,0.00632932787076862,-0.01487825872417628,-0.01487825872417628,0.01951388793337172,0.01951388793337172,-0.001677839154041079,-0.001677839154041079,-0.0911654966648132,-0.0911654966648132,-0.42260104800514126,-0.42260104800514126)
div_upr=c(0.20038143703916275, 0.20038143703916275,0.1292992647217803,0.1292992647217803,0.16144175188599635,0.16144175188599635,0.16473667138945042,0.16473667138945042,0.14783009816296627,0.14783009816296627,0.13433345091225243,0.13433345091225243,0.12241164063145171,0.12241164063145171,0.09117223191378152,0.09117223191378152,0.056430637282320895,0.056430637282320895,0.07340904932753448,0.07340904932753448,0.04103292395656209,0.04103292395656209,-0.03888942916889143,-0.03888942916889143,-0.21927344154995998,-0.21927344154995998)
long_mean=c(7.651690651418993, 7.651690651418993,7.1602165774128155,7.1602165774128155,6.858640469525182,6.858640469525182,5.545154887523255,5.545154887523255,5.4163895759580765,5.4163895759580765,5.016163798803696,5.016163798803696,5.257106931558666,5.257106931558666,5.47841041486338,5.47841041486338,6.392403962189758,6.392403962189758,14.582021423618734,14.582021423618734,25.55094595888835,25.55094595888835,9.383316147797393,9.383316147797393,2.1861298858945193,2.1861298858945193)
long_lwr=c(4.862639832609299, 4.862639832609299,5.000162388315811,5.000162388315811,5.322898424636548,5.322898424636548,4.504414277891408,4.504414277891408,4.463115882505447,4.463115882505447,4.400730623289647,4.400730623289647,4.487800292820158,4.487800292820158,4.690004275141473,4.690004275141473,5.396560345297278,5.396560345297278,9.69619802576361,9.69619802576361,17.0054223218356,17.0054223218356,7.501919434724205,7.501919434724205,1.8008716836217749,1.8008716836217749)
long_upr=c(10.250246499397926, 10.250246499397926,9.483846537437975,9.483846537437975,8.442665695048325,8.442665695048325,6.685008073726293,6.685008073726293,6.358817237134313,6.358817237134313,5.7172336373081025,5.7172336373081025,5.923251821122575,5.923251821122575,6.252026232123241,6.252026232123241,7.568232042112448,7.568232042112448,18.49658025568815,18.49658025568815,34.55306168241085,34.55306168241085,11.4424176361098,11.4424176361098,2.628045248807636,2.628045248807636)
xlim = c(298.8661469593528, 199.11282125900559)
ylim = c(0.030312130187036136, 0.3424964453376561)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.026341648901188935, 0.5552866476243753)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.42260104800514126, 0.20038143703916275)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(1.8008716836217749, 34.55306168241085)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()