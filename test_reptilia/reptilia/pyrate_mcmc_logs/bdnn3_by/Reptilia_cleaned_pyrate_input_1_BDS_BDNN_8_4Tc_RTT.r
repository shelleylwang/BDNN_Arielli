pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/reptilia/pyrate_mcmc_logs/bdnn3_by/Reptilia_cleaned_pyrate_input_1_BDS_BDNN_8_4Tc_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5))
time_vec=c(299.80747472163097, 290.10001,290.1,283.50001,283.5,273.00001,273.0,264.30001,264.3,259.50001,259.5,252.00001,252.0,247.00001,247.0,242.00001,242.0,237.00001,237.0,227.00001,227.0,217.00001,217.0,208.00001,208.0,198.89910667054104)
sp_mean=c(0.20398329343790964, 0.20398329343790964,0.18948712158723868,0.18948712158723868,0.19206606572217244,0.19206606572217244,0.23669525343209233,0.23669525343209233,0.2715548948438624,0.2715548948438624,0.27169582076316556,0.27169582076316556,0.2717447405302002,0.2717447405302002,0.23765484259024777,0.23765484259024777,0.19504883832384406,0.19504883832384406,0.13968730858138362,0.13968730858138362,0.07049649835498668,0.07049649835498668,0.05125604495233895,0.05125604495233895,0.0919809146969213,0.0919809146969213)
sp_lwr=c(0.1104060326276496, 0.1104060326276496,0.11612236941120459,0.11612236941120459,0.13553455249374996,0.13553455249374996,0.16704181050287226,0.16704181050287226,0.21492164640080155,0.21492164640080155,0.2295765726740028,0.2295765726740028,0.2335193152095813,0.2335193152095813,0.20154342528042996,0.20154342528042996,0.16107238067747107,0.16107238067747107,0.11520189071959477,0.11520189071959477,0.05600838734117179,0.05600838734117179,0.03680189271274719,0.03680189271274719,0.05497564254739996,0.05497564254739996)
sp_upr=c(0.3008097083334479, 0.3008097083334479,0.2633292381194886,0.2633292381194886,0.2669669753061099,0.2669669753061099,0.3017193584803353,0.3017193584803353,0.31500471027707533,0.31500471027707533,0.3103402830421638,0.3103402830421638,0.3070028736073996,0.3070028736073996,0.27249334482307264,0.27249334482307264,0.22504020370262995,0.22504020370262995,0.16137140466419952,0.16137140466419952,0.08808169725056325,0.08808169725056325,0.06498857778196905,0.06498857778196905,0.13063316589372548,0.13063316589372548)
ex_mean=c(0.14138575564667102, 0.14138575564667102,0.13320509111007245,0.13320509111007245,0.13668541397361952,0.13668541397361952,0.15630774830601832,0.15630774830601832,0.1844752242003706,0.1844752242003706,0.19816556090245477,0.19816556090245477,0.20766347387572787,0.20766347387572787,0.1879765129046343,0.1879765129046343,0.16307007127771314,0.16307007127771314,0.08815200603346789,0.08815200603346789,0.043658438654025085,0.043658438654025085,0.08018947021999666,0.08018947021999666,0.323709244851489,0.323709244851489)
ex_lwr=c(0.09383843994487262, 0.09383843994487262,0.08793841736347187,0.08793841736347187,0.1044934847183425,0.1044934847183425,0.12557423666147013,0.12557423666147013,0.149812210863385,0.149812210863385,0.1670674786245332,0.1670674786245332,0.18210445605084238,0.18210445605084238,0.16151238700354908,0.16151238700354908,0.13774395893987762,0.13774395893987762,0.06402185044088145,0.06402185044088145,0.030535413961238784,0.030535413961238784,0.06209763664170322,0.06209763664170322,0.27265913915462253,0.27265913915462253)
ex_upr=c(0.20137261027451456, 0.20137261027451456,0.17574263029518655,0.17574263029518655,0.1762080847471814,0.1762080847471814,0.18889686368197678,0.18889686368197678,0.21874574838092037,0.21874574838092037,0.2322429173505985,0.2322429173505985,0.23647707956362563,0.23647707956362563,0.2143639273807756,0.2143639273807756,0.1911275472787525,0.1911275472787525,0.10918075707230229,0.10918075707230229,0.05728939887764888,0.05728939887764888,0.09915683254438068,0.09915683254438068,0.387188674406876,0.387188674406876)
div_mean=c(0.0625975377912383, 0.0625975377912383,0.05628203047716625,0.05628203047716625,0.05538065174855274,0.05538065174855274,0.08038750512607445,0.08038750512607445,0.08707967064349151,0.08707967064349151,0.07353025986071063,0.07353025986071063,0.0640812666544724,0.0640812666544724,0.04967832968561406,0.04967832968561406,0.03197876704613068,0.03197876704613068,0.05153530254791578,0.05153530254791578,0.026838059700961606,0.026838059700961606,-0.028933425267657624,-0.028933425267657624,-0.23172833015456765,-0.23172833015456765)
div_lwr=c(-0.0319156973508706, -0.0319156973508706,-0.027877620767707903,-0.027877620767707903,-0.014196718524602706,-0.014196718524602706,0.003808508328318888,0.003808508328318888,0.02996045297285077,0.02996045297285077,0.017892659486048346,0.017892659486048346,0.01491631197108892,0.01491631197108892,0.005607010541999385,0.005607010541999385,-0.005752397045460711,-0.005752397045460711,0.018195878454563094,0.018195878454563094,0.005881375949801329,0.005881375949801329,-0.05357674994868784,-0.05357674994868784,-0.29854234495246285,-0.29854234495246285)
div_upr=c(0.185004692895864, 0.185004692895864,0.13459011110825586,0.13459011110825586,0.13152878828776157,0.13152878828776157,0.15257427669762158,0.15257427669762158,0.14902112080604782,0.14902112080604782,0.11962348552015764,0.11962348552015764,0.10741574717213301,0.10741574717213301,0.0954908591757396,0.0954908591757396,0.07276130989945057,0.07276130989945057,0.08226346198195027,0.08226346198195027,0.04721386005566684,0.04721386005566684,-0.00636292088541434,-0.00636292088541434,-0.16798055759934555,-0.16798055759934555)
long_mean=c(7.343320815870918, 7.343320815870918,7.721062361789564,7.721062361789564,7.455408384233195,7.455408384233195,6.470440215468076,6.470440215468076,5.475680522548119,5.475680522548119,5.08287988997124,5.08287988997124,4.839050446756437,4.839050446756437,5.350002855827002,5.350002855827002,6.176768779034913,6.176768779034913,11.548419081926403,11.548419081926403,23.50183797954573,23.50183797954573,12.649176030931558,12.649176030931558,3.113234002503328,3.113234002503328)
long_lwr=c(4.722549417189294, 4.722549417189294,5.106753709879863,5.106753709879863,5.675108502738527,5.675108502738527,5.243755960093147,5.243755960093147,4.571517423317485,4.571517423317485,4.305836369125437,4.305836369125437,4.221445016682844,4.221445016682844,4.602931603246356,4.602931603246356,5.232108161475733,5.232108161475733,8.707802039389735,8.707802039389735,16.16967012968346,16.16967012968346,9.846615808327766,9.846615808327766,2.5587172668217173,2.5587172668217173)
long_upr=c(10.089369408184629, 10.089369408184629,9.995997322853164,9.995997322853164,9.569974651486216,9.569974651486216,7.890503665333837,7.890503665333837,6.6750233124315095,6.6750233124315095,5.985605386715605,5.985605386715605,5.483963712805157,5.483963712805157,6.099898238191503,6.099898238191503,7.259846513025513,7.259846513025513,14.664706985767502,14.664706985767502,30.863136012104977,30.863136012104977,15.790827018830191,15.790827018830191,3.636183125317182,3.636183125317182)
xlim = c(299.80747472163097, 198.89910667054104)
ylim = c(0.03680189271274719, 0.31500471027707533)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
ylim = c(0.030535413961238784, 0.387188674406876)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.29854234495246285, 0.185004692895864)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(2.5587172668217173, 30.863136012104977)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()