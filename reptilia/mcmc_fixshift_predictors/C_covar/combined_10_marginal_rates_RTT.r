# 1 files combined:
# 	C:\Users\SimoesLabAdmin\Documents\BDNN_Arielli\reptilia\mcmc_fixshift_predictors\C_covar/combined_10_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/reptilia/mcmc_fixshift_predictors/C_covar/C_covar_rep_combined_10_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.113033,0.113033,0.113033,0.113033,0.113033,0.113033,0.113033,0.113033,0.113033,0.033365,0.033365,0.033365,0.033365,0.033365,0.033365,0.033365,0.033365,0.033365,0.047332,0.047332,0.047332,0.047332,0.047332,0.047332,0.047332,0.047332,0.047332,0.047332,0.151006,0.151006,0.151006,0.151006,0.151006,0.151006,0.151006,0.151006,0.151006,0.151006,0.136549,0.136549,0.136549,0.136549,0.136549,0.181435,0.181435,0.181435,0.181435,0.181435,0.614301,0.614301,0.614301,0.614301,0.614301,0.141799,0.141799,0.141799,0.141799,0.141799,0.141799,0.141799,0.098347,0.098347,0.098347,0.098347,0.098347,0.121911,0.121911,0.121911,0.121911,0.121911,0.121911,0.121911,0.121911,0.121911,0.021615,0.021615,0.021615,0.021615,0.021615,0.021615,0.021615,0.021615,0.021615,0.021615,0.058557,0.058557,0.058557,0.058557,0.058557,0.058557,0.058557,0.195859,0.195859,0.195859,0.195859,0.195859,0.195859,0.195859)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.188343,0.188343,0.188343,0.188343,0.188343,0.188343,0.188343,0.188343,0.188343,0.070825,0.070825,0.070825,0.070825,0.070825,0.070825,0.070825,0.070825,0.070825,0.087322,0.087322,0.087322,0.087322,0.087322,0.087322,0.087322,0.087322,0.087322,0.087322,0.221734,0.221734,0.221734,0.221734,0.221734,0.221734,0.221734,0.221734,0.221734,0.221734,0.254917,0.254917,0.254917,0.254917,0.254917,0.305756,0.305756,0.305756,0.305756,0.305756,0.939785,0.939785,0.939785,0.939785,0.939785,0.347772,0.347772,0.347772,0.347772,0.347772,0.347772,0.347772,0.424092,0.424092,0.424092,0.424092,0.424092,0.36018,0.36018,0.36018,0.36018,0.36018,0.36018,0.36018,0.36018,0.36018,0.141224,0.141224,0.141224,0.141224,0.141224,0.141224,0.141224,0.141224,0.141224,0.141224,0.228741,0.228741,0.228741,0.228741,0.228741,0.228741,0.228741,0.99547,0.99547,0.99547,0.99547,0.99547,0.99547,0.99547)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.260068,0.260068,0.260068,0.260068,0.260068,0.260068,0.260068,0.260068,0.260068,0.067657,0.067657,0.067657,0.067657,0.067657,0.067657,0.067657,0.067657,0.067657,0.026265,0.026265,0.026265,0.026265,0.026265,0.026265,0.026265,0.026265,0.026265,0.026265,0.09767,0.09767,0.09767,0.09767,0.09767,0.09767,0.09767,0.09767,0.09767,0.09767,0.176221,0.176221,0.176221,0.176221,0.176221,0.174667,0.174667,0.174667,0.174667,0.174667,0.345432,0.345432,0.345432,0.345432,0.345432,0.180895,0.180895,0.180895,0.180895,0.180895,0.180895,0.180895,0.056376,0.056376,0.056376,0.056376,0.056376,0.055717,0.055717,0.055717,0.055717,0.055717,0.055717,0.055717,0.055717,0.055717,0.053715,0.053715,0.053715,0.053715,0.053715,0.053715,0.053715,0.053715,0.053715,0.053715,0.043423,0.043423,0.043423,0.043423,0.043423,0.043423,0.043423,0.028933,0.028933,0.028933,0.028933,0.028933,0.028933,0.028933)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.385088,0.385088,0.385088,0.385088,0.385088,0.385088,0.385088,0.385088,0.385088,0.120597,0.120597,0.120597,0.120597,0.120597,0.120597,0.120597,0.120597,0.120597,0.061004,0.061004,0.061004,0.061004,0.061004,0.061004,0.061004,0.061004,0.061004,0.061004,0.154276,0.154276,0.154276,0.154276,0.154276,0.154276,0.154276,0.154276,0.154276,0.154276,0.319549,0.319549,0.319549,0.319549,0.319549,0.281998,0.281998,0.281998,0.281998,0.281998,0.586853,0.586853,0.586853,0.586853,0.586853,0.381959,0.381959,0.381959,0.381959,0.381959,0.381959,0.381959,0.276346,0.276346,0.276346,0.276346,0.276346,0.260475,0.260475,0.260475,0.260475,0.260475,0.260475,0.260475,0.260475,0.260475,0.231645,0.231645,0.231645,0.231645,0.231645,0.231645,0.231645,0.231645,0.231645,0.231645,0.200853,0.200853,0.200853,0.200853,0.200853,0.200853,0.200853,0.328704,0.328704,0.328704,0.328704,0.328704,0.328704,0.328704)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.245388,-0.245388,-0.245388,-0.245388,-0.245388,-0.245388,-0.245388,-0.245388,-0.245388,-0.072105,-0.072105,-0.072105,-0.072105,-0.072105,-0.072105,-0.072105,-0.072105,-0.072105,0.003791,0.003791,0.003791,0.003791,0.003791,0.003791,0.003791,0.003791,0.003791,0.003791,0.01743,0.01743,0.01743,0.01743,0.01743,0.01743,0.01743,0.01743,0.01743,0.01743,-0.135805,-0.135805,-0.135805,-0.135805,-0.135805,-0.062988,-0.062988,-0.062988,-0.062988,-0.062988,0.139266,0.139266,0.139266,0.139266,0.139266,-0.169436,-0.169436,-0.169436,-0.169436,-0.169436,-0.169436,-0.169436,-0.07834,-0.07834,-0.07834,-0.07834,-0.07834,-0.064322,-0.064322,-0.064322,-0.064322,-0.064322,-0.064322,-0.064322,-0.064322,-0.064322,-0.169487,-0.169487,-0.169487,-0.169487,-0.169487,-0.169487,-0.169487,-0.169487,-0.169487,-0.169487,-0.074062,-0.074062,-0.074062,-0.074062,-0.074062,-0.074062,-0.074062,0.091173,0.091173,0.091173,0.091173,0.091173,0.091173,0.091173)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.112793,-0.112793,-0.112793,-0.112793,-0.112793,-0.112793,-0.112793,-0.112793,-0.112793,-0.016382,-0.016382,-0.016382,-0.016382,-0.016382,-0.016382,-0.016382,-0.016382,-0.016382,0.050334,0.050334,0.050334,0.050334,0.050334,0.050334,0.050334,0.050334,0.050334,0.050334,0.106566,0.106566,0.106566,0.106566,0.106566,0.106566,0.106566,0.106566,0.106566,0.106566,0.039152,0.039152,0.039152,0.039152,0.039152,0.090953,0.090953,0.090953,0.090953,0.090953,0.48914,0.48914,0.48914,0.48914,0.48914,0.093608,0.093608,0.093608,0.093608,0.093608,0.093608,0.093608,0.258231,0.258231,0.258231,0.258231,0.258231,0.232208,0.232208,0.232208,0.232208,0.232208,0.232208,0.232208,0.232208,0.232208,0.034165,0.034165,0.034165,0.034165,0.034165,0.034165,0.034165,0.034165,0.034165,0.034165,0.148292,0.148292,0.148292,0.148292,0.148292,0.148292,0.148292,0.888749,0.888749,0.888749,0.888749,0.888749,0.888749,0.888749)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.150593309,0.150593309,0.150593309,0.150593309,0.150593309,0.150593309,0.150593309,0.150593309,0.150593309,0.051465939,0.051465939,0.051465939,0.051465939,0.051465939,0.051465939,0.051465939,0.051465939,0.051465939,0.067013593,0.067013593,0.067013593,0.067013593,0.067013593,0.067013593,0.067013593,0.067013593,0.067013593,0.067013593,0.187694931,0.187694931,0.187694931,0.187694931,0.187694931,0.187694931,0.187694931,0.187694931,0.187694931,0.187694931,0.198550183,0.198550183,0.198550183,0.198550183,0.198550183,0.242995082,0.242995082,0.242995082,0.242995082,0.242995082,0.773415705,0.773415705,0.773415705,0.773415705,0.773415705,0.236059473,0.236059473,0.236059473,0.236059473,0.236059473,0.236059473,0.236059473,0.237457085,0.237457085,0.237457085,0.237457085,0.237457085,0.230948012,0.230948012,0.230948012,0.230948012,0.230948012,0.230948012,0.230948012,0.230948012,0.230948012,0.070975694,0.070975694,0.070975694,0.070975694,0.070975694,0.070975694,0.070975694,0.070975694,0.070975694,0.070975694,0.141043408,0.141043408,0.141043408,0.141043408,0.141043408,0.141043408,0.141043408,0.593525375,0.593525375,0.593525375,0.593525375,0.593525375,0.593525375,0.593525375)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.327875427,0.327875427,0.327875427,0.327875427,0.327875427,0.327875427,0.327875427,0.327875427,0.327875427,0.094223283,0.094223283,0.094223283,0.094223283,0.094223283,0.094223283,0.094223283,0.094223283,0.094223283,0.042952764,0.042952764,0.042952764,0.042952764,0.042952764,0.042952764,0.042952764,0.042952764,0.042952764,0.042952764,0.1254975,0.1254975,0.1254975,0.1254975,0.1254975,0.1254975,0.1254975,0.1254975,0.1254975,0.1254975,0.244286837,0.244286837,0.244286837,0.244286837,0.244286837,0.228754102,0.228754102,0.228754102,0.228754102,0.228754102,0.468200432,0.468200432,0.468200432,0.468200432,0.468200432,0.278170935,0.278170935,0.278170935,0.278170935,0.278170935,0.278170935,0.278170935,0.165712241,0.165712241,0.165712241,0.165712241,0.165712241,0.154742374,0.154742374,0.154742374,0.154742374,0.154742374,0.154742374,0.154742374,0.154742374,0.154742374,0.139973184,0.139973184,0.139973184,0.139973184,0.139973184,0.139973184,0.139973184,0.139973184,0.139973184,0.139973184,0.11054999,0.11054999,0.11054999,0.11054999,0.11054999,0.11054999,0.11054999,0.147835141,0.147835141,0.147835141,0.147835141,0.147835141,0.147835141,0.147835141)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.177282127,-0.177282127,-0.177282127,-0.177282127,-0.177282127,-0.177282127,-0.177282127,-0.177282127,-0.177282127,-0.042757353,-0.042757353,-0.042757353,-0.042757353,-0.042757353,-0.042757353,-0.042757353,-0.042757353,-0.042757353,0.024060825,0.024060825,0.024060825,0.024060825,0.024060825,0.024060825,0.024060825,0.024060825,0.024060825,0.024060825,0.06219742,0.06219742,0.06219742,0.06219742,0.06219742,0.06219742,0.06219742,0.06219742,0.06219742,0.06219742,-0.045736649,-0.045736649,-0.045736649,-0.045736649,-0.045736649,0.01424095,0.01424095,0.01424095,0.01424095,0.01424095,0.305215272,0.305215272,0.305215272,0.305215272,0.305215272,-0.042111444,-0.042111444,-0.042111444,-0.042111444,-0.042111444,-0.042111444,-0.042111444,0.071744828,0.071744828,0.071744828,0.071744828,0.071744828,0.076205628,0.076205628,0.076205628,0.076205628,0.076205628,0.076205628,0.076205628,0.076205628,0.076205628,-0.068997483,-0.068997483,-0.068997483,-0.068997483,-0.068997483,-0.068997483,-0.068997483,-0.068997483,-0.068997483,-0.068997483,0.030493412,0.030493412,0.030493412,0.030493412,0.030493412,0.030493412,0.030493412,0.445690244,0.445690244,0.445690244,0.445690244,0.445690244,0.445690244,0.445690244)
trans=0.5
age=(0:(123-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.0950170000000001), xlim = c(-129.15,-18.85), ylab = 'Speciation rate', xlab = 'Ma',main='Reptilia Marginal RTT' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.6455383), xlim = c(-129.15,-18.85), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.2699268, 0.9776239000000001), xlim = c(-129.15,-18.85), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,rev(1/M_mean),type = 'n', xlim = c(-129.15,-18.85), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()