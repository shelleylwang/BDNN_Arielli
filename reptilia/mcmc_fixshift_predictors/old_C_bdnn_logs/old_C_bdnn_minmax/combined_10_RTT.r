pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/reptilia/mcmc_fixshift_predictors/C_bdnn_minmax/rep_combined_10_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5), oma=c(0,0,4,0))
time_vec=c(299.05577697384314, 290.10001,290.1,283.50001,283.5,273.00001,273.0,264.30001,264.3,259.50001,259.5,252.00001,252.0,247.00001,247.0,242.00001,242.0,237.00001,237.0,227.00001,227.0,217.00001,217.0,208.00001,208.0,197.74635229363398)
sp_mean=c(0.6329879787665244, 0.6329879787665244,0.10608980437627605,0.10608980437627605,0.09719423970868848,0.09719423970868848,0.2025162578867045,0.2025162578867045,0.23765431423713773,0.23765431423713773,0.18343756139305695,0.18343756139305695,0.7437702921641274,0.7437702921641274,0.21269310009813724,0.21269310009813724,0.20478400942535685,0.20478400942535685,0.15794407927427806,0.15794407927427806,0.05635636331667805,0.05635636331667805,0.042275669978418286,0.042275669978418286,0.06931377260631029,0.06931377260631029)
sp_lwr=c(0.22291510649796947, 0.22291510649796947,0.041203092676863416,0.041203092676863416,0.04115008348316584,0.04115008348316584,0.044739231864242716,0.044739231864242716,0.13329519275966936,0.13329519275966936,0.1062119020376617,0.1062119020376617,0.5399765092029285,0.5399765092029285,0.15586244388979,0.15586244388979,0.15244983250518293,0.15244983250518293,0.1145812753413967,0.1145812753413967,0.03458983055305821,0.03458983055305821,0.02712630750108686,0.02712630750108686,0.03988386468156262,0.03988386468156262)
sp_upr=c(1.120138776607142, 1.120138776607142,0.17826046644957175,0.17826046644957175,0.15837704928860022,0.15837704928860022,0.3592871214864053,0.3592871214864053,0.348870805067797,0.348870805067797,0.26457490836704817,0.26457490836704817,0.9604321604626666,0.9604321604626666,0.2688323575316082,0.2688323575316082,0.26132689021731015,0.26132689021731015,0.1996045223004772,0.1996045223004772,0.0779232354486695,0.0779232354486695,0.057731137756872414,0.057731137756872414,0.099311208931841,0.099311208931841)
ex_mean=c(0.17721900243293554, 0.17721900243293554,0.11842247684909105,0.11842247684909105,0.12334971110000652,0.12334971110000652,0.15437601241661708,0.15437601241661708,0.18893332487417255,0.18893332487417255,0.19868556503504947,0.19868556503504947,0.39008761738319064,0.39008761738319064,0.21157596860292482,0.21157596860292482,0.20473976456895598,0.20473976456895598,0.10238370473231378,0.10238370473231378,0.04176227063943534,0.04176227063943534,0.08132763767698974,0.08132763767698974,0.31905107359997537,0.31905107359997537)
ex_lwr=c(0.04213702574652636, 0.04213702574652636,0.059331823173044994,0.059331823173044994,0.05997406936983847,0.05997406936983847,0.04251018572750641,0.04251018572750641,0.10435098167888722,0.10435098167888722,0.11681794382566296,0.11681794382566296,0.23770888737448223,0.23770888737448223,0.15844930629245035,0.15844930629245035,0.13759509478123425,0.13759509478123425,0.07104289967906831,0.07104289967906831,0.023482905264616476,0.023482905264616476,0.05626858439452989,0.05626858439452989,0.2515827562748932,0.2515827562748932)
ex_upr=c(0.3423115961013196, 0.3423115961013196,0.1818356193184252,0.1818356193184252,0.19168346053920926,0.19168346053920926,0.2793279980379296,0.2793279980379296,0.2822006456253532,0.2822006456253532,0.28128494583332025,0.28128494583332025,0.5471804413247724,0.5471804413247724,0.2662094467253758,0.2662094467253758,0.27444516734586955,0.27444516734586955,0.13413930651405473,0.13413930651405473,0.06210246428506337,0.06210246428506337,0.10743189361034218,0.10743189361034218,0.3869205807024061,0.3869205807024061)
div_mean=c(0.4557689763335959, 0.4557689763335959,-0.01233267247281498,-0.01233267247281498,-0.026155471391317766,-0.026155471391317766,0.04814024547008815,0.04814024547008815,0.04872098936296277,0.04872098936296277,-0.015248003641991335,-0.015248003641991335,0.3536826747809361,0.3536826747809361,0.0011171314952129173,0.0011171314952129173,4.424485640092975e-05,4.424485640092975e-05,0.05556037454196394,0.05556037454196394,0.014594092677242963,0.014594092677242963,-0.0390519676985705,-0.0390519676985705,-0.24973730099366237,-0.24973730099366237)
div_lwr=c(0.04366954820718441, 0.04366954820718441,-0.10045822544287406,-0.10045822544287406,-0.10921437064887407,-0.10921437064887407,-0.136333097796889,-0.136333097796889,-0.08229655611121105,-0.08229655611121105,-0.11828598605420454,-0.11828598605420454,0.13690111517619197,0.13690111517619197,-0.07205494793676626,-0.07205494793676626,-0.08414466870914011,-0.08414466870914011,0.005603222856747206,0.005603222856747206,-0.009991809737795468,-0.009991809737795468,-0.06842062075049889,-0.06842062075049889,-0.32395909324983585,-0.32395909324983585)
div_upr=c(0.9515360125854949, 0.9515360125854949,0.07848878819495894,0.07848878819495894,0.05612259221995649,0.05612259221995649,0.2349879557804484,0.2349879557804484,0.1850257568681467,0.1850257568681467,0.09091950648846375,0.09091950648846375,0.575393302208697,0.575393302208697,0.07632081807084623,0.07632081807084623,0.08497009472064912,0.08497009472064912,0.10572852648767413,0.10572852648767413,0.03972039535055632,0.03972039535055632,-0.011211836363388458,-0.011211836363388458,-0.1769666168635465,-0.1769666168635465)
long_mean=c(7.13124319375271, 7.13124319375271,9.133607738995284,9.133607738995284,8.844198194945346,8.844198194945346,7.962395675130491,7.962395675130491,5.64295533445061,5.64295533445061,5.276720652141759,5.276720652141759,2.684011678173194,2.684011678173194,4.811149663207255,4.811149663207255,5.036728925498445,5.036728925498445,10.023071509214,10.023071509214,25.483546576699702,25.483546576699702,12.630765047563305,12.630765047563305,3.1716754017763793,3.1716754017763793)
long_lwr=c(1.8349646346799886, 1.8349646346799886,4.84635824440677,4.84635824440677,4.523248162313369,4.523248162313369,2.6960847138226067,2.6960847138226067,3.1695350393841433,3.1695350393841433,3.2527042924178513,3.2527042924178513,1.6993817075336417,1.6993817075336417,3.6330789562745203,3.6330789562745203,3.444292105951458,3.444292105951458,7.063050129080853,7.063050129080853,14.719086971388371,14.719086971388371,8.762038108445946,8.762038108445946,2.512586791169873,2.512586791169873)
long_upr=c(14.537166083716757, 14.537166083716757,14.663585280347043,14.663585280347043,14.409200689573275,14.409200689573275,15.957981782984177,15.957981782984177,8.663745131718333,8.663745131718333,7.686958999769669,7.686958999769669,3.8814001969376317,3.8814001969376317,6.1002613871701366,6.1002613871701366,6.860614642602496,6.860614642602496,13.32360584397096,13.32360584397096,38.730712097925796,38.730712097925796,16.775858684055066,16.775858684055066,3.8586787831451264,3.8586787831451264)
xlim = c(299.05577697384314, 197.74635229363398)
ylim = c(0.02712630750108686, 1.120138776607142)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
mtext("Reptilia BDNN", outer = TRUE, line = 0.5, cex = 2, font = 2)

ylim = c(0.023482905264616476, 0.5471804413247724)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.32395909324983585, 0.9515360125854949)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(1.6993817075336417, 38.730712097925796)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()