

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/reptilia/pyrate_mcmc_logs/RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2), oma=c(0,0,2,0))
library(scales)

time=c(-199.94725639499998, -200.936163185,-201.92506997499999,-202.913976765,-203.902883555,-204.891790345,-205.880697135,-206.869603925,-207.858510715,-208.847417505,-209.836324295,-210.82523108499998,-211.814137875,-212.803044665,-213.791951455,-214.780858245,-215.769765035,-216.758671825,-217.747578615,-218.736485405,-219.72539219499998,-220.714298985,-221.703205775,-222.692112565,-223.681019355,-224.669926145,-225.658832935,-226.647739725,-227.636646515,-228.62555330499998,-229.614460095,-230.60336688499999,-231.592273675,-232.581180465,-233.570087255,-234.558994045,-235.547900835,-236.536807625,-237.52571441499998,-238.514621205,-239.503527995,-240.492434785,-241.481341575,-242.470248365,-243.459155155,-244.448061945,-245.436968735,-246.42587552499998,-247.414782315,-248.403689105,-249.392595895,-250.381502685,-251.370409475,-252.359316265,-253.348223055,-254.337129845,-255.32603663499998,-256.31494342499997,-257.303850215,-258.292757005,-259.281663795,-260.270570585,-261.259477375,-262.248384165,-263.237290955,-264.226197745,-265.21510453499997,-266.204011325,-267.192918115,-268.181824905,-269.17073169500003,-270.159638485,-271.148545275,-272.137452065,-273.126358855,-274.11526564499997,-275.104172435,-276.093079225,-277.081986015,-278.070892805,-279.059799595,-280.048706385,-281.037613175,-282.026519965,-283.01542675499996,-284.004333545,-284.993240335,-285.982147125,-286.971053915,-287.959960705,-288.948867495,-289.937774285,-290.926681075,-291.91558786499996,-292.904494655,-293.893401445,-294.882308235,-295.871215025,-296.860121815,-297.849028605)
rate=c(0.19299671805520335, 0.37509187429701996,0.5859729878449658,0.05565093993625317,0.05544695406087154,0.055444284761711385,0.05544227049490156,0.05544171344415249,0.055440541862327386,0.055438846239184034,0.05543214242849308,0.05542914344877911,0.05542574508125843,0.05542688517414715,0.05542755187928212,0.05543264493562114,0.055440778385036645,0.05545730932666392,0.055464296476379,0.05546800877766933,0.05547833527285137,0.055496567617453044,0.055561444241738825,0.055792876028155594,0.05696268840743854,0.05830662735943036,0.06205436803137686,0.14108995154081394,0.15066024740757508,0.1473294866424104,0.14663455127049715,0.1465828438463619,0.1466752734610586,0.14716816440306296,0.14856177269690768,0.14995535126035198,0.1534830845632431,0.2019731770870612,0.6128166837089788,0.19300670515502888,0.1929315551664856,0.19300275534318045,0.19304601434870966,0.1930801764279474,0.19309200840951823,0.19316642949666787,0.1977138180229015,0.2036540168399417,0.751999566578158,0.6506621498546836,0.5831569669884493,0.5231417685380217,0.6515853743076492,1.4790173503362105,0.21086680248295087,0.2075529350354514,0.2071243851119468,0.20712683906272156,0.2071872301752808,0.20724417520591387,0.20744664249857264,0.20740550795697454,0.20690529847330028,0.20657529880854833,0.20632631125275003,0.20608642085310436,0.20520929081118763,0.2023540584208059,0.1986595321982057,0.19489307322340685,0.19216191111086645,0.19018008441951054,0.1880685361804581,0.18614970722429774,0.18402193743258322,0.1794805873988677,0.17361118436196,0.16919427264380282,0.16656215378209288,0.16521677585546513,0.16466415495101266,0.16435976444630485,0.16422138867085578,0.16419116557318925,0.16427557347234611,0.16452662371880283,0.16447313835284644,0.16463154194422241,0.16517771632043915,0.1667798360559056,0.17283111978286356,0.19907736518187497,0.48045709566854583,0.4875770900760511,0.48200171573240863,0.48004688577189414,0.4797358151793478,0.4808660869752359,0.4825327335527829,0.48555144711641385)
minHPD=c(2.1550036428609548e-05, 4.6127235050485126e-05,0.27967274975793294,0.04043316955004391,0.04204397542851937,0.042049193518902815,0.04211756103309106,0.04212879988067523,0.042124260558001184,0.042173622081033126,0.04218759351104606,0.04225202250296896,0.04225202250296896,0.04225202250296896,0.04218759351104606,0.04217327240988383,0.0421259658142857,0.04204229386093091,0.04195268770367578,0.04183607601565223,0.041685272766237166,0.04168593889109494,0.040823776242734346,0.03705991869599724,0.040768598693717885,0.04269198801357278,0.040858102198962305,0.04465117728033277,0.059225534567511576,0.08100025321434987,0.08183445581055188,0.08177050813439943,0.0818302788000832,0.0827085196406606,0.08271138364680124,0.08089339520726793,0.0709280586480878,0.06717019551521793,0.1624796622140993,0.13918048080005269,0.1402344277633845,0.1416125933731806,0.14162491446880693,0.141586258183106,0.14162993696201157,0.1416109695096968,0.14181066848967658,0.14458306807207846,0.3862151671219274,0.29233603535125113,0.2539696549217279,0.14505296133788226,0.10658630431763681,0.6266020932283917,0.12742451519673834,0.14259434097910467,0.143525680923275,0.1434869090246177,0.14347489998642712,0.1434814584980828,0.1443068729279402,0.14347489998642712,0.14345420812639967,0.14285563405363536,0.14109454858974751,0.1401105023545763,0.1369633365454896,0.12065458298050911,0.09535964136117706,0.08466243381737851,0.08084754107711076,0.0796821739123459,0.07570376822807882,0.07440629039242617,0.0737288106485518,0.0679302422247674,0.06373477575959159,0.06039302730285136,0.06060300568614512,0.060415241698346486,0.06039302730285136,0.060598271611616454,0.060415241698346486,0.06060300568614512,0.0609022016033172,0.06059352849635253,0.0609022016033172,0.06038735676508545,0.05888568169076751,0.05726641094012391,0.04245826959183831,0.05033970396001009,0.1084950847517269,0.13885283181749836,0.13887744513466416,0.14096065466851287,0.14368097091941132,0.14368097091941132,0.14300515044773837,0.14300515044773837)
maxHPD=c(0.5731760900954601, 0.7500212865959065,1.0101507253302398,0.07156782551535197,0.06937391407356894,0.06934618769543208,0.06939047423858154,0.06938828124645434,0.06936118853872011,0.06938828124645434,0.0693676733422953,0.0694102348166819,0.0694102348166819,0.06940396733098841,0.0693472371893777,0.06935901836063586,0.06937511296982513,0.06941314285021959,0.06940396733098841,0.06936118853872011,0.06938828124645434,0.06972416129762762,0.07000429920748678,0.0749395812566673,0.13163850989287793,0.1448877637771622,0.1783845542235956,0.4249086450539867,0.2300755496725381,0.22297695772286805,0.22119495159201052,0.22097630074685592,0.22096765493684647,0.2222569148752719,0.2241374939685805,0.22683929008343726,0.23389455408388368,1.0784541644843721,1.2232716439551266,0.23973720526925016,0.23782735167260521,0.23872164420341574,0.23869021041799332,0.23872164420341574,0.23891177739630307,0.23938062888629133,0.45956093089814876,0.5687805224482236,1.350626567870688,0.9871619447223416,0.9355496525039075,0.8950028798072763,1.6626270916565893,2.3035165894342136,0.7108579723894298,0.2927559916026217,0.2886133712994378,0.28801400411116945,0.2879349986686725,0.2881499216545881,0.2902005143821516,0.2896650701338487,0.2890504625551179,0.28883161545256214,0.28787194680305317,0.28859054115985755,0.2901967608928257,0.2941635850053391,0.28069326464302347,0.2713630935485818,0.2667327984371987,0.26485486162507965,0.2601368565177858,0.2577126921407942,0.25631808800201056,0.24931136694668637,0.24258694145976772,0.23705561147106669,0.23642081717041,0.2357325993447727,0.23547793939864717,0.23547793939864717,0.23510933809107104,0.23510880411091045,0.23510933809107104,0.23460505283351904,0.23514880350296974,0.23510933809107104,0.23546140017011305,0.24017303694466285,0.3579983636664943,0.823563410876378,1.1130448158032178,1.080120127562036,1.049701083297337,1.0411823009702927,1.0411386894944796,1.040905087161954,1.0413366157583035,1.0489296617167687)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.533868248377635), xlim = c(-298.343482,-199.452803), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_10_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mtext("Reptilia", outer = TRUE, line = -1.5, cex = 2, font = 2)
mids=c(-199.95225087373734, -200.9511466212121,-201.95004236868687,-202.94893811616163,-203.94783386363633,-204.9467296111111,-205.94562535858586,-206.94452110606062,-207.94341685353533,-208.9423126010101,-209.94120834848485,-210.9401040959596,-211.93899984343432,-212.93789559090908,-213.93679133838384,-214.9356870858586,-215.9345828333333,-216.93347858080807,-217.93237432828283,-218.9312700757576,-219.9301658232323,-220.92906157070706,-221.92795731818183,-222.9268530656566,-223.9257488131313,-224.92464456060605,-225.92354030808082,-226.92243605555552,-227.92133180303028,-228.92022755050505,-229.9191232979798,-230.9180190454545,-231.91691479292928,-232.91581054040404,-233.9147062878788,-234.9136020353535,-235.91249778282827,-236.91139353030303,-237.9102892777778,-238.9091850252525,-239.90808077272726,-240.90697652020202,-241.90587226767678,-242.9047680151515,-243.90366376262625,-244.902559510101,-245.90145525757578,-246.90035100505048,-247.89924675252524,-248.8981425,-249.89703824747477,-250.89593399494947,-251.89482974242424,-252.893725489899,-253.89262123737376,-254.89151698484847,-255.89041273232323,-256.88930847979793,-257.8882042272727,-258.88709997474746,-259.8859957222222,-260.884891469697,-261.8837872171717,-262.88268296464645,-263.8815787121212,-264.8804744595959,-265.8793702070707,-266.87826595454544,-267.8771617020202,-268.87605744949497,-269.87495319696967,-270.87384894444443,-271.8727446919192,-272.8716404393939,-273.87053618686866,-274.8694319343434,-275.8683276818182,-276.86722342929295,-277.86611917676765,-278.8650149242424,-279.8639106717171,-280.8628064191919,-281.86170216666665,-282.8605979141414,-283.85949366161617,-284.8583894090909,-285.85728515656564,-286.8561809040404,-287.8550766515151,-288.85397239898987,-289.85286814646463,-290.8517638939394,-291.85065964141415,-292.84955538888886,-293.8484511363636,-294.8473468838384,-295.8462426313131,-296.84513837878785,-297.8440341262626)
counts=c(0.15608988764044943, 0.39947191011235955,0.9759662921348314,0.02340449438202247,0.00047191011235955056,0.00044943820224719103,0.00033707865168539324,0.000348314606741573,0.00044943820224719103,0.0005730337078651685,0.00038202247191011237,0.00038202247191011237,0.00020224719101123595,0.0004606741573033708,0.0006179775280898876,0.000955056179775281,0.0012696629213483147,0.0008539325842696629,0.000955056179775281,0.0020112359550561796,0.003955056179775281,0.01051685393258427,0.04833707865168539,0.08793258426966293,0.1018314606741573,0.21091011235955057,0.3943483146067416,0.19974157303370788,0.0348314606741573,0.0035617977528089886,0.0014044943820224719,0.003438202247191011,0.009292134831460673,0.016146067415730336,0.014808988764044944,0.07489887640449439,0.5315730337078651,0.5101573033707865,0.09453932584269663,0.00452808988764045,0.0014606741573033708,0.002,0.0011123595505617978,0.001044943820224719,0.03465168539325843,0.07902247191011236,0.4235056179775281,0.47552808988764045,0.21885393258426966,0.14626966292134833,0.016617977528089887,0.6632022471910113,0.7567078651685393,0.28052808988764044,0.01991011235955056,0.004561797752808989,0.002044943820224719,0.0016966292134831462,0.0028314606741573034,0.003348314606741573,0.005393258426966292,0.005314606741573033,0.004382022471910113,0.004280898876404494,0.007438202247191011,0.029247191011235955,0.04096629213483146,0.04602247191011236,0.03744943820224719,0.023943820224719102,0.023438202247191012,0.022797752808988762,0.020741573033707866,0.038213483146067415,0.05270786516853933,0.04029213483146067,0.023606741573033708,0.010808988764044944,0.004887640449438202,0.0030674157303370786,0.0022808988764044945,0.002044943820224719,0.0022134831460674156,0.0033820224719101123,0.0018651685393258426,0.0024157303370786515,0.005674157303370787,0.010651685393258427,0.04431460674157303,0.19903370786516855,0.3830561797752809,0.03250561797752809,0.01557303370786517,0.008292134831460674,0.006224719101123596,0.006382022471910113,0.00598876404494382,0.00749438202247191,0.007056179775280899)
plot(mids,counts,type = 'h', xlim = c(-298.343482,-199.452803), ylim=c(0,0.9759662921348314), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03401655752581527
bf6 = 0.20647604927269786
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-199.94725639499998, -200.936163185,-201.92506997499999,-202.913976765,-203.902883555,-204.891790345,-205.880697135,-206.869603925,-207.858510715,-208.847417505,-209.836324295,-210.82523108499998,-211.814137875,-212.803044665,-213.791951455,-214.780858245,-215.769765035,-216.758671825,-217.747578615,-218.736485405,-219.72539219499998,-220.714298985,-221.703205775,-222.692112565,-223.681019355,-224.669926145,-225.658832935,-226.647739725,-227.636646515,-228.62555330499998,-229.614460095,-230.60336688499999,-231.592273675,-232.581180465,-233.570087255,-234.558994045,-235.547900835,-236.536807625,-237.52571441499998,-238.514621205,-239.503527995,-240.492434785,-241.481341575,-242.470248365,-243.459155155,-244.448061945,-245.436968735,-246.42587552499998,-247.414782315,-248.403689105,-249.392595895,-250.381502685,-251.370409475,-252.359316265,-253.348223055,-254.337129845,-255.32603663499998,-256.31494342499997,-257.303850215,-258.292757005,-259.281663795,-260.270570585,-261.259477375,-262.248384165,-263.237290955,-264.226197745,-265.21510453499997,-266.204011325,-267.192918115,-268.181824905,-269.17073169500003,-270.159638485,-271.148545275,-272.137452065,-273.126358855,-274.11526564499997,-275.104172435,-276.093079225,-277.081986015,-278.070892805,-279.059799595,-280.048706385,-281.037613175,-282.026519965,-283.01542675499996,-284.004333545,-284.993240335,-285.982147125,-286.971053915,-287.959960705,-288.948867495,-289.937774285,-290.926681075,-291.91558786499996,-292.904494655,-293.893401445,-294.882308235,-295.871215025,-296.860121815,-297.849028605)
rate=c(5.782865468020581, 0.323823664318973,0.32502004101418436,0.2055198218690631,0.15795023780290837,0.14789311302822716,0.14686755583695627,0.1471007589951684,0.16994735988089177,0.21637921102228913,0.1752430442270386,0.07199868460457784,0.06662293506288505,0.06571146068071806,0.06462123792693034,0.06209259611961232,0.06013892986805364,0.0571399786550872,0.05632691318607856,0.05617183599460122,0.05615642245930636,0.056147238073086955,0.056138827035883326,0.056155231795999086,0.056207428753069916,0.05657632499214309,0.05900706162399892,0.06541398617033341,0.09110836260708352,0.08363037463468027,0.0802616543089763,0.07942952733120962,0.07927199197621945,0.07922040925666808,0.07919555429901619,0.07943695770372486,0.08161185339215662,0.09679253795023128,0.3258988168110537,0.26787897187321724,0.26003291969968145,0.26013996187320304,0.26564092086752095,0.2983766106277471,0.2912347313023368,0.2806064572311734,0.18234189319884947,0.16742817852776543,0.3128695481844993,0.4203475905781391,0.41847916224377696,0.41852765799888597,0.42539789076762613,0.45259061480893625,0.4262025781847649,0.3923839453944068,0.2988353444295919,0.20232570233857028,0.1898053354991316,0.17968483811305097,0.17615243980852865,0.1733556344220778,0.16147531434867798,0.15627303814680035,0.15492156596373102,0.15430279100280697,0.15298901456431002,0.15133861040626356,0.15059779421979957,0.1502599131480192,0.15007602177587426,0.1499279115260381,0.14982065775618433,0.14978284108107234,0.14971175894249467,0.14957439834295974,0.14924153305117882,0.1489646930238836,0.14880587316673788,0.14873530758463188,0.14870707065242117,0.14869016594852905,0.14868481922209703,0.1486907969328189,0.1486968437019689,0.14868341721962305,0.14859524302178595,0.14823740101485472,0.14801080226859842,0.1479079512003467,0.1478479080837552,0.14780916272262062,0.14780240951736237,0.14785804992214052,0.14794369620469314,0.14804966799946556,0.14814406499221788,0.14818191309081657,0.1482088813923778,0.14823719665105634)
minHPD=c(2.779300693517635, 0.13113622504350853,0.13165997024220602,0.018243995393683342,8.278294617657893e-05,0.015883941167112878,0.017830888606285195,0.016986432477656563,0.02667126112570821,0.11121442751045499,0.04136878359454656,0.040541076655155474,0.03954097121843612,0.03943829931188647,0.03820113690571306,0.033853303359533835,0.031173010406299138,0.03147876493427084,0.03248897522282348,0.03254047207436747,0.03248897522282348,0.03248897522282348,0.032460178588781446,0.03257558071978657,0.03251932256090208,0.031396449387724304,0.027811585608455407,0.031696791361322973,0.04715661050991715,0.048552004316918314,0.05135039776798061,0.05135039776798061,0.05139130621905851,0.05139130621905851,0.050944727259696454,0.049485046443430755,0.042345535633687884,0.051082090433384325,0.12865712735431792,0.05560264834485217,0.08922473682394189,0.08929994426680576,0.09056807705769096,0.1786887862456771,0.13191369171869932,0.08225519211684076,0.04211953766598549,0.03611515366528392,0.07858803852558284,0.22846303332598394,0.22837490816412415,0.22945792519374544,0.22603265695279082,0.24025577408850185,0.14530110853710687,0.13910874210103671,0.12645679492398398,0.11757373340323136,0.11927882322018776,0.11514422842532364,0.11473820751456751,0.11112438170423296,0.09821731029998015,0.09823449714178649,0.09441742589457418,0.09411650408743275,0.08811836181025093,0.09378671525164299,0.09624631549948824,0.09627977347255201,0.09740817541446946,0.09776533175462368,0.09637859002738061,0.096595961325672,0.09682819776291186,0.09714471473762279,0.09670662960611492,0.09654915047821286,0.09641675036970235,0.09648522176035977,0.09655536802534524,0.09660671314873726,0.09669945108562292,0.09672745631556856,0.09672745631556856,0.0967196918621378,0.096598474411277,0.09641675036970235,0.09546048766476643,0.09549037926520991,0.09512256189660957,0.09461994111651967,0.09437736085230373,0.09401925069972873,0.0925777412009791,0.09236499690843579,0.09237632069923964,0.0915308048120357,0.09042212180515669,0.09045318298087236)
maxHPD=c(10.896092317838393, 0.6408470036388324,0.6386337457118779,0.5469337896798236,0.27897250196538526,0.239941692640325,0.23933441949205567,0.23905688615264634,0.4323946515661043,0.5811004001194383,0.4868374291762316,0.20387784351523705,0.16688441304732746,0.16124085050964954,0.15554823886113064,0.14347873204061043,0.13406756868611722,0.08022328862749661,0.07903628075706082,0.079043711965219,0.07900590156743308,0.07903628075706082,0.079043711965219,0.07922155076156916,0.07929886328819785,0.07929886328819785,0.09233766034833124,0.12014582201416762,0.3265874231647895,0.15577327598834287,0.1421944285225973,0.13946168618089544,0.13924321088748148,0.13925021326981224,0.1394014901437807,0.14198552813652235,0.2322624615436253,0.31118606839428287,1.129404496604739,0.40684934866667,0.3641747959305003,0.3634704869296114,0.3673232927743927,0.6305837261787961,0.5083822513976537,0.4282020267456648,0.32229573092118213,0.3193762930126046,0.5511829798180338,0.5851104292999761,0.5791451620734668,0.5800114939770017,0.6001317420604068,1.2419402178411194,0.6225060884329084,0.5768955926079388,0.5434545243982286,0.45127772805140065,0.4375732722556279,0.4132238174214059,0.40396663423967516,0.3968045823704135,0.32008601647553026,0.2924194588416633,0.27982192719952614,0.27381687288086864,0.23489808064764223,0.2121050338278049,0.2078467443488495,0.20553637456281848,0.20553231426266355,0.20511122557833997,0.20322988808887477,0.2032059182570548,0.20318233929496474,0.20318233929496474,0.20186003973045366,0.20112169389038953,0.20068728617522785,0.20063546172724925,0.20062813392072762,0.20063546172724925,0.20064022815664204,0.20064022815664204,0.20063546172724925,0.20071157323349573,0.20063546172724925,0.2014472319570103,0.20134194735438363,0.20182521342457851,0.2017343625764493,0.20165793490059802,0.20186003973045366,0.20220153913836553,0.2018548161080748,0.20324293221204176,0.2049819654867786,0.20563352313040287,0.20588357333546212,0.20745830426063727)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 11.985701549622233), xlim = c(-298.343482,-199.452803), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-199.95225087373734, -200.9511466212121,-201.95004236868687,-202.94893811616163,-203.94783386363633,-204.9467296111111,-205.94562535858586,-206.94452110606062,-207.94341685353533,-208.9423126010101,-209.94120834848485,-210.9401040959596,-211.93899984343432,-212.93789559090908,-213.93679133838384,-214.9356870858586,-215.9345828333333,-216.93347858080807,-217.93237432828283,-218.9312700757576,-219.9301658232323,-220.92906157070706,-221.92795731818183,-222.9268530656566,-223.9257488131313,-224.92464456060605,-225.92354030808082,-226.92243605555552,-227.92133180303028,-228.92022755050505,-229.9191232979798,-230.9180190454545,-231.91691479292928,-232.91581054040404,-233.9147062878788,-234.9136020353535,-235.91249778282827,-236.91139353030303,-237.9102892777778,-238.9091850252525,-239.90808077272726,-240.90697652020202,-241.90587226767678,-242.9047680151515,-243.90366376262625,-244.902559510101,-245.90145525757578,-246.90035100505048,-247.89924675252524,-248.8981425,-249.89703824747477,-250.89593399494947,-251.89482974242424,-252.893725489899,-253.89262123737376,-254.89151698484847,-255.89041273232323,-256.88930847979793,-257.8882042272727,-258.88709997474746,-259.8859957222222,-260.884891469697,-261.8837872171717,-262.88268296464645,-263.8815787121212,-264.8804744595959,-265.8793702070707,-266.87826595454544,-267.8771617020202,-268.87605744949497,-269.87495319696967,-270.87384894444443,-271.8727446919192,-272.8716404393939,-273.87053618686866,-274.8694319343434,-275.8683276818182,-276.86722342929295,-277.86611917676765,-278.8650149242424,-279.8639106717171,-280.8628064191919,-281.86170216666665,-282.8605979141414,-283.85949366161617,-284.8583894090909,-285.85728515656564,-286.8561809040404,-287.8550766515151,-288.85397239898987,-289.85286814646463,-290.8517638939394,-291.85065964141415,-292.84955538888886,-293.8484511363636,-294.8473468838384,-295.8462426313131,-296.84513837878785,-297.8440341262626)
counts=c(0.9999213483146068, 0.01642696629213483,0.2497752808988764,0.27502247191011236,0.057662921348314605,0.008640449438202247,0.004325842696629213,0.16906741573033707,0.2357865168539326,0.35014606741573034,0.2951797752808989,0.12337078651685393,0.02695505617977528,0.03803370786516854,0.06692134831460674,0.04287640449438202,0.06491011235955056,0.013752808988764045,0.0021348314606741575,0.0006404494382022472,0.0005730337078651685,0.0007415730337078652,0.0012696629213483147,0.0023707865168539326,0.012943820224719101,0.07626966292134832,0.22187640449438203,0.25579775280898875,0.08123595505617978,0.02007865168539326,0.007348314606741573,0.0020224719101123597,0.0013707865168539326,0.003348314606741573,0.019168539325842695,0.09057303370786517,0.40961797752808987,0.4622247191011236,0.3871460674157303,0.004707865168539326,0.0066292134831460675,0.10695505617977528,0.1679438202247191,0.09110112359550562,0.2964943820224719,0.1614943820224719,0.023078651685393258,0.6804831460674158,0.013595505617977528,0.008595505617977528,0.007786516853932585,0.1279438202247191,0.05012359550561798,0.10666292134831461,0.14440449438202246,0.246438202247191,0.07338202247191011,0.0652808988764045,0.03637078651685393,0.01904494382022472,0.09725842696629214,0.10956179775280898,0.03842696629213483,0.01498876404494382,0.012943820224719101,0.03306741573033708,0.016674157303370785,0.0077640449438202246,0.004348314606741573,0.003247191011235955,0.0024719101123595504,0.0015280898876404495,0.001752808988764045,0.0023932584269662923,0.0053370786516853935,0.005325842696629213,0.0036629213483146067,0.0018876404494382023,0.0013370786516853932,0.0011235955056179776,0.001,0.0010337078651685393,0.0010786516853932583,0.0011348314606741572,0.0021910112359550564,0.005674157303370787,0.004707865168539326,0.00249438202247191,0.0017752808988764045,0.001550561797752809,0.0016067415730337078,0.002303370786516854,0.0030337078651685393,0.0038651685393258427,0.0037191011235955056,0.003292134831460674,0.002752808988764045,0.003,0.002303370786516854)
plot(mids,counts,type = 'h', xlim = c(-298.343482,-199.452803), ylim=c(0,0.9999213483146068), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-199.94725639499998, -200.936163185,-201.92506997499999,-202.913976765,-203.902883555,-204.891790345,-205.880697135,-206.869603925,-207.858510715,-208.847417505,-209.836324295,-210.82523108499998,-211.814137875,-212.803044665,-213.791951455,-214.780858245,-215.769765035,-216.758671825,-217.747578615,-218.736485405,-219.72539219499998,-220.714298985,-221.703205775,-222.692112565,-223.681019355,-224.669926145,-225.658832935,-226.647739725,-227.636646515,-228.62555330499998,-229.614460095,-230.60336688499999,-231.592273675,-232.581180465,-233.570087255,-234.558994045,-235.547900835,-236.536807625,-237.52571441499998,-238.514621205,-239.503527995,-240.492434785,-241.481341575,-242.470248365,-243.459155155,-244.448061945,-245.436968735,-246.42587552499998,-247.414782315,-248.403689105,-249.392595895,-250.381502685,-251.370409475,-252.359316265,-253.348223055,-254.337129845,-255.32603663499998,-256.31494342499997,-257.303850215,-258.292757005,-259.281663795,-260.270570585,-261.259477375,-262.248384165,-263.237290955,-264.226197745,-265.21510453499997,-266.204011325,-267.192918115,-268.181824905,-269.17073169500003,-270.159638485,-271.148545275,-272.137452065,-273.126358855,-274.11526564499997,-275.104172435,-276.093079225,-277.081986015,-278.070892805,-279.059799595,-280.048706385,-281.037613175,-282.026519965,-283.01542675499996,-284.004333545,-284.993240335,-285.982147125,-286.971053915,-287.959960705,-288.948867495,-289.937774285,-290.926681075,-291.91558786499996,-292.904494655,-293.893401445,-294.882308235,-295.871215025,-296.860121815,-297.849028605)
net_rate=c(-5.86975650768019, 0.0011847826892515453,0.2692283605840788,-0.19101292696579983,-0.10080803861184287,-0.08585586704536607,-0.08440819785675914,-0.08466183847358613,-0.13047605721587308,-0.23497205620660674,-0.1461394141946396,-0.04645423584972345,-0.027004672910597792,-0.023649179769259253,-0.02000861945823395,-0.012824712035454771,-0.008363397796660534,-0.0021924069761173983,-0.000710878815952618,-0.0005388317350832646,-0.00046207541157675136,-0.00032502996969081143,0.00010919534564477758,0.0019236907180704614,0.008877773377405909,0.01635739088646864,0.02857393269488224,0.09251031040084966,0.0505187220582643,0.0599401548216929,0.06434619049960061,0.0653822523270108,0.06565321139893406,0.06640765226461524,0.06813458335258857,0.0685706625700328,0.06875646958456433,0.23589786995422724,0.09586875640688457,-0.07659490949695112,-0.0510859264575329,-0.05106702787397534,-0.0579802532875072,-0.14111271765443775,-0.11484076192035941,-0.08510243434925326,0.038384822892032926,0.08862464884090793,0.446534047001722,0.23716180305753953,0.1846011115320656,0.1252600926507048,0.3147091461006383,0.9115866560009658,-0.17276037291538227,-0.15965230986561574,-0.10124350342694778,-0.03954541772656046,-0.02713802579954263,-0.010618465715933034,-0.002496836358044365,0.0030639075258548343,0.03032864003022248,0.04373883241828771,0.04707387922451515,0.04858332655554613,0.05075882650238068,0.04964440240157705,0.04516210357060168,0.03956010952240705,0.0356902324692103,0.033085502893255424,0.03021448312209378,0.027561054748487673,0.024893182458094916,0.018871353244287827,0.012143888971676377,0.007677469369549123,0.005412786435143145,0.004407241303966465,0.0040400800621894105,0.003903926564327104,0.0038424514615860426,0.0038626692736632223,0.003915235030755386,0.004301389728085022,0.004526067327683313,0.005499971227190698,0.006946449842251235,0.010426359926846835,0.027858421285568924,0.1528484353661524,0.3708723211479791,0.3679740144294979,0.35755546888564776,0.35351125467575,0.3521245492622885,0.3524991847483269,0.35353554080224797,0.35635559045481974)
net_minHPD=c(-10.65868171555507, -0.44333867289587203,-0.1883100965936726,-0.5257130406504325,-0.22934105738846028,-0.18416072101911654,-0.18386540210081861,-0.1841776590703913,-0.37525755848386816,-0.5260564919329384,-0.4327526331475749,-0.15146369718315575,-0.11407939482475564,-0.10780091468032146,-0.10010039699638984,-0.08530617483793215,-0.0733883291860687,-0.02581123650249577,-0.024613979973405156,-0.02453137002383598,-0.02435426836308889,-0.023947219068800506,-0.024375429247215738,-0.02615275895960923,-0.027018535754516834,-0.02468341521233166,-0.052497671656673184,-0.06301125588278689,-0.29047821477684493,-0.00724122809935146,0.004012605881242873,0.004761386992271868,0.006273568605413657,0.005820007473991459,0.004762439030265166,0.0016636941645398196,-0.0794940003010082,-0.15941742997228367,-0.32201521686505674,-0.24297931516159052,-0.17649081765955543,-0.17649374769048912,-0.18254891955009483,-0.4499407910274709,-0.32724434143828257,-0.24772781913194344,-0.13686997935215525,-0.13605309713512354,0.008658276841647328,-0.15805435685153663,-0.19836411121137232,-0.24816632774306951,-0.2726655062578306,0.07784306065852697,-0.47936082895070703,-0.4047098205127704,-0.3632421483405918,-0.2588514636592918,-0.244316120578817,-0.21845569664506717,-0.20711251400107533,-0.19483878631006246,-0.13012877489291405,-0.09380052000620556,-0.08100351879409884,-0.07016068684143265,-0.054975221106899064,-0.054933025358426535,-0.06227079519666262,-0.07061260722060862,-0.07324854581615929,-0.07662577714010223,-0.08079841902179,-0.08498996106598747,-0.08623135160867966,-0.09162622483365618,-0.09793482840319859,-0.09786048986484444,-0.09900874697353844,-0.09890749438753285,-0.09806280544604076,-0.09801620852565791,-0.09793482840319859,-0.09782800583952206,-0.09793482840319859,-0.097893233262627,-0.09788048949356554,-0.09959504398112282,-0.10373835987647612,-0.1050946131125438,-0.12940824544240467,-0.11515252021761663,-0.040832934178651206,-0.03425900454569014,-0.029251240970517123,-0.02904926091117538,-0.02754347883198313,-0.02904926091117538,-0.02904926091117538,-0.034353137224197416)
net_maxHPD=c(-2.5131480497835206, 0.4612005988854393,0.7437717018893649,0.038921758373145425,0.050569029926837525,0.037463631901525976,0.03508683165520132,0.03536061900605986,0.031379126395259915,-0.051438136083746804,0.01504652439074377,0.014826225644207214,0.01590562888900593,0.016177781734028847,0.018330659012017178,0.02178518991891521,0.025707928010096148,0.02772890477678859,0.026545480996998876,0.026545148216781556,0.026888856856451274,0.027649422022322796,0.028568258627844977,0.03377818196752194,0.07041176621514211,0.09320497822237432,0.12742716715256536,0.37678122514469564,0.17469662682056927,0.14466485882415386,0.13058050633824603,0.12887168293841172,0.13035372239171455,0.13136823721845015,0.13566116471937795,0.14462464408716375,0.1594290132942795,1.0397947817007138,0.724655341140374,0.14647588693997957,0.10259527805851257,0.10218411319876082,0.10052708584961097,0.01137587704088161,0.04258475805536835,0.10247856317096427,0.23668508457328802,0.39713641956814955,1.007528194800373,0.6318262646961396,0.5572875403375623,0.47405898565367954,1.3348443008029578,1.8990659278618285,0.36924512133604726,0.09280933777877032,0.11491713391785721,0.12837928939530519,0.1283582430692528,0.13595776593819853,0.1425181510256774,0.1510194769760479,0.15996573730094815,0.1626671040543326,0.1626671040543326,0.16779119829495148,0.16568275337928218,0.15356467092204618,0.14631353420643445,0.13925554023347106,0.13646081284197537,0.1324227469798412,0.12835052729639154,0.12396153958306061,0.12263680089904058,0.11761245576550892,0.10936397654494495,0.10625169505058316,0.10379507284163557,0.10332304578998656,0.10394520335603522,0.10379507284163557,0.10354033578505772,0.1034815093633865,0.10302878875616425,0.10279816745276739,0.10318032211189106,0.1034815093633865,0.10359035344790776,0.11320747646429824,0.21645330018769018,0.6805656752579847,0.9662247410759068,0.9258929503028901,0.9011117489253997,0.8931881902864691,0.8932301957772592,0.8931323106288392,0.8964398500501284,0.9008096182139336)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-11.724549887110578, 2.0889725206480114), xlim = c(-298.343482,-199.452803), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-199.94725639499998, -200.936163185,-201.92506997499999,-202.913976765,-203.902883555,-204.891790345,-205.880697135,-206.869603925,-207.858510715,-208.847417505,-209.836324295,-210.82523108499998,-211.814137875,-212.803044665,-213.791951455,-214.780858245,-215.769765035,-216.758671825,-217.747578615,-218.736485405,-219.72539219499998,-220.714298985,-221.703205775,-222.692112565,-223.681019355,-224.669926145,-225.658832935,-226.647739725,-227.636646515,-228.62555330499998,-229.614460095,-230.60336688499999,-231.592273675,-232.581180465,-233.570087255,-234.558994045,-235.547900835,-236.536807625,-237.52571441499998,-238.514621205,-239.503527995,-240.492434785,-241.481341575,-242.470248365,-243.459155155,-244.448061945,-245.436968735,-246.42587552499998,-247.414782315,-248.403689105,-249.392595895,-250.381502685,-251.370409475,-252.359316265,-253.348223055,-254.337129845,-255.32603663499998,-256.31494342499997,-257.303850215,-258.292757005,-259.281663795,-260.270570585,-261.259477375,-262.248384165,-263.237290955,-264.226197745,-265.21510453499997,-266.204011325,-267.192918115,-268.181824905,-269.17073169500003,-270.159638485,-271.148545275,-272.137452065,-273.126358855,-274.11526564499997,-275.104172435,-276.093079225,-277.081986015,-278.070892805,-279.059799595,-280.048706385,-281.037613175,-282.026519965,-283.01542675499996,-284.004333545,-284.993240335,-285.982147125,-286.971053915,-287.959960705,-288.948867495,-289.937774285,-290.926681075,-291.91558786499996,-292.904494655,-293.893401445,-294.882308235,-295.871215025,-296.860121815,-297.849028605)
rate=c(0.16327060679897262, 2.8960186165749082,2.881219669838137,3.9417971276402293,6.39026482509958,7.065958060999621,7.139201782533173,7.126433000183763,5.37254117510203,3.4408942267957427,4.955953244924053,9.795649199061762,12.101809088767384,12.614042040801035,13.220700333307626,14.60483951837188,15.6159044611131,17.266394496104812,17.711390087496703,17.75836293141732,17.762832111668363,17.765466196730195,17.767506114867363,17.764175104547405,17.74571054699483,17.612117021475445,16.654071291443486,14.388435696291664,8.835320538392631,10.547728416016763,11.258657436278822,11.396843858097762,11.418234309935837,11.424144762576876,11.418064265956469,11.28209213338163,10.300764768798224,7.094719484945531,1.9595122677526915,3.7130263516610857,4.11663375859201,4.113783892035031,3.998624537675932,3.000378801189107,3.256902343909311,3.60344335585708,5.5205272030541375,5.654159380404358,2.9813181430333864,2.434912422923212,2.4533748377647453,2.452860643520826,2.376139568367221,1.9147384090606385,2.366970187534261,2.669115397123806,3.195573552510847,3.9818283110425234,4.186808670461729,4.494018899955323,4.638209930190393,4.757114676747212,5.5208276363433955,5.981882376283673,6.117056463222253,6.17831054081362,6.314849542135306,6.485907120519931,6.558749923620221,6.589192619287865,6.605354162839099,6.616498611197825,6.622714815994098,6.6247711360649575,6.625264243112829,6.635885321788543,6.668459772776282,6.6901644287628175,6.700947287014197,6.7056763329838835,6.70733516156179,6.708476265126871,6.7081069552662465,6.706751991694809,6.701037603387852,6.700197029565022,6.710398211042737,6.742139023690854,6.762948075419695,6.770705710874127,6.775431942357874,6.777199574071092,6.774735694865314,6.762650964200871,6.734294232854308,6.685221775957023,6.651339061194321,6.629334673778377,6.611753716514405,6.58738000110481)
minHPD=c(0.16327060679897262, 2.8960186165749082,2.881219669838137,3.9417971276402293,6.39026482509958,7.065958060999621,7.139201782533173,7.126433000183763,5.37254117510203,3.4408942267957427,4.955953244924053,9.795649199061762,12.101809088767384,12.614042040801035,13.220700333307626,14.60483951837188,15.6159044611131,17.266394496104812,17.711390087496703,17.75836293141732,17.762832111668363,17.765466196730195,17.767506114867363,17.764175104547405,17.74571054699483,17.612117021475445,16.654071291443486,14.388435696291664,8.835320538392631,10.547728416016763,11.258657436278822,11.396843858097762,11.418234309935837,11.424144762576876,11.418064265956469,11.28209213338163,10.300764768798224,7.094719484945531,1.9595122677526915,3.7130263516610857,4.11663375859201,4.113783892035031,3.998624537675932,3.000378801189107,3.256902343909311,3.60344335585708,5.5205272030541375,5.654159380404358,2.9813181430333864,2.434912422923212,2.4533748377647453,2.452860643520826,2.376139568367221,1.9147384090606385,2.366970187534261,2.669115397123806,3.195573552510847,3.9818283110425234,4.186808670461729,4.494018899955323,4.638209930190393,4.757114676747212,5.5208276363433955,5.981882376283673,6.117056463222253,6.17831054081362,6.314849542135306,6.485907120519931,6.558749923620221,6.589192619287865,6.605354162839099,6.616498611197825,6.622714815994098,6.6247711360649575,6.625264243112829,6.635885321788543,6.668459772776282,6.6901644287628175,6.700947287014197,6.7056763329838835,6.70733516156179,6.708476265126871,6.7081069552662465,6.706751991694809,6.701037603387852,6.700197029565022,6.710398211042737,6.742139023690854,6.762948075419695,6.770705710874127,6.775431942357874,6.777199574071092,6.774735694865314,6.762650964200871,6.734294232854308,6.685221775957023,6.651339061194321,6.629334673778377,6.611753716514405,6.58738000110481)
maxHPD=c(0.16327060679897262, 2.8960186165749082,2.881219669838137,3.9417971276402293,6.39026482509958,7.065958060999621,7.139201782533173,7.126433000183763,5.37254117510203,3.4408942267957427,4.955953244924053,9.795649199061762,12.101809088767384,12.614042040801035,13.220700333307626,14.60483951837188,15.6159044611131,17.266394496104812,17.711390087496703,17.75836293141732,17.762832111668363,17.765466196730195,17.767506114867363,17.764175104547405,17.74571054699483,17.612117021475445,16.654071291443486,14.388435696291664,8.835320538392631,10.547728416016763,11.258657436278822,11.396843858097762,11.418234309935837,11.424144762576876,11.418064265956469,11.28209213338163,10.300764768798224,7.094719484945531,1.9595122677526915,3.7130263516610857,4.11663375859201,4.113783892035031,3.998624537675932,3.000378801189107,3.256902343909311,3.60344335585708,5.5205272030541375,5.654159380404358,2.9813181430333864,2.434912422923212,2.4533748377647453,2.452860643520826,2.376139568367221,1.9147384090606385,2.366970187534261,2.669115397123806,3.195573552510847,3.9818283110425234,4.186808670461729,4.494018899955323,4.638209930190393,4.757114676747212,5.5208276363433955,5.981882376283673,6.117056463222253,6.17831054081362,6.314849542135306,6.485907120519931,6.558749923620221,6.589192619287865,6.605354162839099,6.616498611197825,6.622714815994098,6.6247711360649575,6.625264243112829,6.635885321788543,6.668459772776282,6.6901644287628175,6.700947287014197,6.7056763329838835,6.70733516156179,6.708476265126871,6.7081069552662465,6.706751991694809,6.701037603387852,6.700197029565022,6.710398211042737,6.742139023690854,6.762948075419695,6.770705710874127,6.775431942357874,6.777199574071092,6.774735694865314,6.762650964200871,6.734294232854308,6.685221775957023,6.651339061194321,6.629334673778377,6.611753716514405,6.58738000110481)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 19.5442567263541), xlim = c(-298.343482,-199.452803), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()