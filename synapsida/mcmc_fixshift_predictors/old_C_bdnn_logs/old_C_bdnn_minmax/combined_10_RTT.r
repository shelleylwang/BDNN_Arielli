pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/synapsida/mcmc_fixshift_predictors/C_bdnn_minmax/syn_combined_10_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5), oma=(c(0,0,4,0)))
time_vec=c(309.92166226303266, 290.10001,290.1,283.50001,283.5,273.00001,273.0,264.30001,264.3,259.50001,259.5,252.00001,252.0,247.00001,247.0,242.00001,242.0,237.00001,237.0,227.00001,227.0,217.00001,217.0,208.00001,208.0,201.13064003526796)
sp_mean=c(0.23428451614579748, 0.23428451614579748,0.13064589311535615,0.13064589311535615,0.13574903991259296,0.13574903991259296,0.1970117746643396,0.1970117746643396,0.29822892358283576,0.29822892358283576,0.1720214103694716,0.1720214103694716,0.25362075529745887,0.25362075529745887,0.25535335748620924,0.25535335748620924,0.1411358920931458,0.1411358920931458,0.09051979852881192,0.09051979852881192,0.05169307475291082,0.05169307475291082,0.04694159306967312,0.04694159306967312,0.11245774204929951,0.11245774204929951)
sp_lwr=c(0.1546286201918157, 0.1546286201918157,0.056110988231282855,0.056110988231282855,0.0703776157252692,0.0703776157252692,0.08863130298918807,0.08863130298918807,0.2147096064251744,0.2147096064251744,0.12343421439462984,0.12343421439462984,0.11306688185342363,0.11306688185342363,0.1301969294154456,0.1301969294154456,0.06247502847182656,0.06247502847182656,0.04786868097467183,0.04786868097467183,0.010162636766727007,0.010162636766727007,0.0010304007576079272,0.0010304007576079272,0.0026385626207829677,0.0026385626207829677)
sp_upr=c(0.3158285095517487, 0.3158285095517487,0.2128318128794697,0.2128318128794697,0.2046941817173662,0.2046941817173662,0.30095117294427864,0.30095117294427864,0.38237084221676426,0.38237084221676426,0.22066975016361393,0.22066975016361393,0.4023841983725867,0.4023841983725867,0.3990022466027131,0.3990022466027131,0.22304429331421602,0.22304429331421602,0.1380441796895354,0.1380441796895354,0.09115954183274594,0.09115954183274594,0.09565937079418496,0.09565937079418496,0.21476231678476873,0.21476231678476873)
ex_mean=c(0.14593812047368823, 0.14593812047368823,0.09817620995847837,0.09817620995847837,0.09147773494183835,0.09147773494183835,0.09233484564404362,0.09233484564404362,0.1400507077759993,0.1400507077759993,0.26512162731633976,0.26512162731633976,0.35331763941638883,0.35331763941638883,0.2253738285723577,0.2253738285723577,0.12630748448799434,0.12630748448799434,0.09129245333034294,0.09129245333034294,0.08300450625984866,0.08300450625984866,0.125309339594231,0.125309339594231,0.33268070204207567,0.33268070204207567)
ex_lwr=c(0.07272459823515036, 0.07272459823515036,0.026998862952762964,0.026998862952762964,0.024637237177787732,0.024637237177787732,0.022143639894788673,0.022143639894788673,0.054564271052097574,0.054564271052097574,0.2056838239565521,0.2056838239565521,0.15827285733563065,0.15827285733563065,0.11002577751810197,0.11002577751810197,0.03355461530105042,0.03355461530105042,0.044464735863903114,0.044464735863903114,0.03161177221641628,0.03161177221641628,0.05828936468112069,0.05828936468112069,0.19629214908052892,0.19629214908052892)
ex_upr=c(0.22103792306928632, 0.22103792306928632,0.17039535716678889,0.17039535716678889,0.1596117351517975,0.1596117351517975,0.1645728697761691,0.1645728697761691,0.22069996334016714,0.22069996334016714,0.3271731830621663,0.3271731830621663,0.5492507764963608,0.5492507764963608,0.350843904048347,0.350843904048347,0.22512478185055015,0.22512478185055015,0.14129366961187464,0.14129366961187464,0.13563497441838882,0.13563497441838882,0.1991193601815937,0.1991193601815937,0.4825570077018611,0.4825570077018611)
div_mean=c(0.08834639567210996, 0.08834639567210996,0.03246968315687871,0.03246968315687871,0.04427130497075095,0.04427130497075095,0.10467692902029654,0.10467692902029654,0.15817821580683353,0.15817821580683353,-0.09310021694687032,-0.09310021694687032,-0.0996968841189303,-0.0996968841189303,0.029979528913849394,0.029979528913849394,0.014828407605151509,0.014828407605151509,-0.0007726548015305072,-0.0007726548015305072,-0.03131143150693808,-0.03131143150693808,-0.0783677465245579,-0.0783677465245579,-0.22022295999278035,-0.22022295999278035)
div_lwr=c(-0.015341511003716501, -0.015341511003716501,-0.06754167453264952,-0.06754167453264952,-0.04081239447951082,-0.04081239447951082,-0.01987439056207762,-0.01987439056207762,0.041174189403134526,0.041174189403134526,-0.1668431674398107,-0.1668431674398107,-0.3342584424431928,-0.3342584424431928,-0.11859459151169116,-0.11859459151169116,-0.10564528712776255,-0.10564528712776255,-0.05814349487314953,-0.05814349487314953,-0.09280314323506,-0.09280314323506,-0.1658099655146997,-0.1658099655146997,-0.406094563465111,-0.406094563465111)
div_upr=c(0.19416546787006866, 0.19416546787006866,0.1319596055476547,0.1319596055476547,0.1323055715150811,0.1323055715150811,0.2268737742015497,0.2268737742015497,0.28400299885002933,0.28400299885002933,-0.018692202797094715,-0.018692202797094715,0.1424341566519478,0.1424341566519478,0.18245879258986125,0.18245879258986125,0.1268666624136594,0.1268666624136594,0.06022065623469719,0.06022065623469719,0.02659484043840144,0.02659484043840144,0.0065965386368653095,0.0065965386368653095,-0.049869392568246795,-0.049869392568246795)
long_mean=c(7.461931509077126, 7.461931509077126,12.694039814632472,12.694039814632472,13.685401415038491,13.685401415038491,13.97290023600486,13.97290023600486,8.29571572290929,8.29571572290929,3.8254046585588157,3.8254046585588157,3.117769745346423,3.117769745346423,4.817972466122307,4.817972466122307,9.725856831246993,9.725856831246993,11.912903524806444,11.912903524806444,13.741095678793736,13.741095678793736,8.771851084264647,8.771851084264647,3.1620379882891854,3.1620379882891854)
long_lwr=c(4.045857765760171, 4.045857765760171,4.536342625840222,4.536342625840222,4.790207354566191,4.790207354566191,4.632402550503253,4.632402550503253,3.8757232381177427,3.8757232381177427,2.9659357333216145,2.9659357333216145,1.5435503867588094,1.5435503867588094,2.4414716726498042,2.4414716726498042,3.310283824150255,3.310283824150255,6.127082198033263,6.127082198033263,6.092402031830162,6.092402031830162,4.312662732253688,4.312662732253688,1.8776687110051402,1.8776687110051402)
long_upr=c(11.764082931289423, 11.764082931289423,24.369089382114982,24.369089382114982,27.551230082430774,27.551230082430774,29.6386812752059,29.6386812752059,15.065258732825088,15.065258732825088,4.7327058237737365,4.7327058237737365,5.171620016707261,5.171620016707261,7.6965201720622645,7.6965201720622645,19.463565913778424,19.463565913778424,19.234611071861636,19.234611071861636,24.944550339218548,24.944550339218548,14.537052697095387,14.537052697095387,4.604882933759287,4.604882933759287)
xlim = c(309.92166226303266, 201.13064003526796)
ylim = c(0.0010304007576079272, 0.4023841983725867)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
mtext("Synapsida BDNN", outer = TRUE, line = 0.5, cex = 2, font = 2)

ylim = c(0.022143639894788673, 0.5492507764963608)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.406094563465111, 0.28400299885002933)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(1.5435503867588094, 29.6386812752059)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()