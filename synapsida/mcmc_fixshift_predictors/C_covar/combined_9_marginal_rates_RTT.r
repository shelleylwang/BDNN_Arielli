# 1 files combined:
# 	C:\Users\SimoesLabAdmin\Documents\BDNN_Arielli\synapsida\mcmc_fixshift_predictors\C_covar/combined_9_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/synapsida/mcmc_fixshift_predictors/C_covar/C_covar_syn_combined_10_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.113178,0.113178,0.113178,0.113178,0.113178,0.113178,0.113178,0.038436,0.038436,0.038436,0.038436,0.038436,0.038436,0.038436,0.038436,0.038436,0.024307,0.024307,0.024307,0.024307,0.024307,0.024307,0.024307,0.024307,0.024307,0.024307,0.070527,0.070527,0.070527,0.070527,0.070527,0.070527,0.070527,0.070527,0.070527,0.070527,0.064057,0.064057,0.064057,0.064057,0.064057,0.161713,0.161713,0.161713,0.161713,0.161713,0.199049,0.199049,0.199049,0.199049,0.199049,0.136514,0.136514,0.136514,0.136514,0.136514,0.136514,0.136514,0.24524,0.24524,0.24524,0.24524,0.24524,0.191645,0.191645,0.191645,0.191645,0.191645,0.191645,0.191645,0.191645,0.191645,0.048054,0.048054,0.048054,0.048054,0.048054,0.048054,0.048054,0.048054,0.048054,0.048054,0.086982,0.086982,0.086982,0.086982,0.086982,0.086982,0.086982,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183,0.159183)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.360279,0.360279,0.360279,0.360279,0.360279,0.360279,0.360279,0.16092,0.16092,0.16092,0.16092,0.16092,0.16092,0.16092,0.16092,0.16092,0.116221,0.116221,0.116221,0.116221,0.116221,0.116221,0.116221,0.116221,0.116221,0.116221,0.168869,0.168869,0.168869,0.168869,0.168869,0.168869,0.168869,0.168869,0.168869,0.168869,0.225924,0.225924,0.225924,0.225924,0.225924,0.404654,0.404654,0.404654,0.404654,0.404654,0.442647,0.442647,0.442647,0.442647,0.442647,0.228119,0.228119,0.228119,0.228119,0.228119,0.228119,0.228119,0.416928,0.416928,0.416928,0.416928,0.416928,0.342402,0.342402,0.342402,0.342402,0.342402,0.342402,0.342402,0.342402,0.342402,0.165302,0.165302,0.165302,0.165302,0.165302,0.165302,0.165302,0.165302,0.165302,0.165302,0.318832,0.318832,0.318832,0.318832,0.318832,0.318832,0.318832,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036,0.317036)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.248022,0.248022,0.248022,0.248022,0.248022,0.248022,0.248022,0.047222,0.047222,0.047222,0.047222,0.047222,0.047222,0.047222,0.047222,0.047222,0.027895,0.027895,0.027895,0.027895,0.027895,0.027895,0.027895,0.027895,0.027895,0.027895,0.065425,0.065425,0.065425,0.065425,0.065425,0.065425,0.065425,0.065425,0.065425,0.065425,0.068277,0.068277,0.068277,0.068277,0.068277,0.158848,0.158848,0.158848,0.158848,0.158848,0.235231,0.235231,0.235231,0.235231,0.235231,0.237861,0.237861,0.237861,0.237861,0.237861,0.237861,0.237861,0.173232,0.173232,0.173232,0.173232,0.173232,0.09905,0.09905,0.09905,0.09905,0.09905,0.09905,0.09905,0.09905,0.09905,0.027003,0.027003,0.027003,0.027003,0.027003,0.027003,0.027003,0.027003,0.027003,0.027003,0.082581,0.082581,0.082581,0.082581,0.082581,0.082581,0.082581,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136,0.099136)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.534327,0.534327,0.534327,0.534327,0.534327,0.534327,0.534327,0.175002,0.175002,0.175002,0.175002,0.175002,0.175002,0.175002,0.175002,0.175002,0.137931,0.137931,0.137931,0.137931,0.137931,0.137931,0.137931,0.137931,0.137931,0.137931,0.167607,0.167607,0.167607,0.167607,0.167607,0.167607,0.167607,0.167607,0.167607,0.167607,0.280547,0.280547,0.280547,0.280547,0.280547,0.364689,0.364689,0.364689,0.364689,0.364689,0.534514,0.534514,0.534514,0.534514,0.534514,0.343555,0.343555,0.343555,0.343555,0.343555,0.343555,0.343555,0.300749,0.300749,0.300749,0.300749,0.300749,0.223053,0.223053,0.223053,0.223053,0.223053,0.223053,0.223053,0.223053,0.223053,0.127544,0.127544,0.127544,0.127544,0.127544,0.127544,0.127544,0.127544,0.127544,0.127544,0.277908,0.277908,0.277908,0.277908,0.277908,0.277908,0.277908,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935,0.23935)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.34703,-0.34703,-0.34703,-0.34703,-0.34703,-0.34703,-0.34703,-0.099204,-0.099204,-0.099204,-0.099204,-0.099204,-0.099204,-0.099204,-0.099204,-0.099204,-0.081222,-0.081222,-0.081222,-0.081222,-0.081222,-0.081222,-0.081222,-0.081222,-0.081222,-0.081222,-0.057357,-0.057357,-0.057357,-0.057357,-0.057357,-0.057357,-0.057357,-0.057357,-0.057357,-0.057357,-0.148022,-0.148022,-0.148022,-0.148022,-0.148022,-0.112192,-0.112192,-0.112192,-0.112192,-0.112192,-0.260067,-0.260067,-0.260067,-0.260067,-0.260067,-0.178802,-0.178802,-0.178802,-0.178802,-0.178802,-0.178802,-0.178802,-0.000559,-0.000559,-0.000559,-0.000559,-0.000559,0.02159,0.02159,0.02159,0.02159,0.02159,0.02159,0.02159,0.02159,0.02159,-0.032632,-0.032632,-0.032632,-0.032632,-0.032632,-0.032632,-0.032632,-0.032632,-0.032632,-0.032632,-0.122589,-0.122589,-0.122589,-0.122589,-0.122589,-0.122589,-0.122589,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111,-0.021111)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.00254,-0.00254,-0.00254,-0.00254,-0.00254,-0.00254,-0.00254,0.06474,0.06474,0.06474,0.06474,0.06474,0.06474,0.06474,0.06474,0.06474,0.050188,0.050188,0.050188,0.050188,0.050188,0.050188,0.050188,0.050188,0.050188,0.050188,0.065399,0.065399,0.065399,0.065399,0.065399,0.065399,0.065399,0.065399,0.065399,0.065399,0.088005,0.088005,0.088005,0.088005,0.088005,0.156772,0.156772,0.156772,0.156772,0.156772,0.110531,0.110531,0.110531,0.110531,0.110531,-0.044996,-0.044996,-0.044996,-0.044996,-0.044996,-0.044996,-0.044996,0.20286,0.20286,0.20286,0.20286,0.20286,0.202335,0.202335,0.202335,0.202335,0.202335,0.202335,0.202335,0.202335,0.202335,0.102755,0.102755,0.102755,0.102755,0.102755,0.102755,0.102755,0.102755,0.102755,0.102755,0.168401,0.168401,0.168401,0.168401,0.168401,0.168401,0.168401,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293,0.172293)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.233150395555556,0.233150395555556,0.233150395555556,0.233150395555556,0.233150395555556,0.233150395555556,0.233150395555556,0.094478531111111,0.094478531111111,0.094478531111111,0.094478531111111,0.094478531111111,0.094478531111111,0.094478531111111,0.094478531111111,0.094478531111111,0.068968741111111,0.068968741111111,0.068968741111111,0.068968741111111,0.068968741111111,0.068968741111111,0.068968741111111,0.068968741111111,0.068968741111111,0.068968741111111,0.115282291111111,0.115282291111111,0.115282291111111,0.115282291111111,0.115282291111111,0.115282291111111,0.115282291111111,0.115282291111111,0.115282291111111,0.115282291111111,0.139947404444444,0.139947404444444,0.139947404444444,0.139947404444444,0.139947404444444,0.287658931111111,0.287658931111111,0.287658931111111,0.287658931111111,0.287658931111111,0.317379204444444,0.317379204444444,0.317379204444444,0.317379204444444,0.317379204444444,0.185067225555556,0.185067225555556,0.185067225555556,0.185067225555556,0.185067225555556,0.185067225555556,0.185067225555556,0.334090525555556,0.334090525555556,0.334090525555556,0.334090525555556,0.334090525555556,0.266047607777778,0.266047607777778,0.266047607777778,0.266047607777778,0.266047607777778,0.266047607777778,0.266047607777778,0.266047607777778,0.266047607777778,0.104002332222222,0.104002332222222,0.104002332222222,0.104002332222222,0.104002332222222,0.104002332222222,0.104002332222222,0.104002332222222,0.104002332222222,0.104002332222222,0.193002581111111,0.193002581111111,0.193002581111111,0.193002581111111,0.193002581111111,0.193002581111111,0.193002581111111,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444,0.237244654444444)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.401994956666667,0.401994956666667,0.401994956666667,0.401994956666667,0.401994956666667,0.401994956666667,0.401994956666667,0.105568934444444,0.105568934444444,0.105568934444444,0.105568934444444,0.105568934444444,0.105568934444444,0.105568934444444,0.105568934444444,0.105568934444444,0.082796764444444,0.082796764444444,0.082796764444444,0.082796764444444,0.082796764444444,0.082796764444444,0.082796764444444,0.082796764444444,0.082796764444444,0.082796764444444,0.111063301111111,0.111063301111111,0.111063301111111,0.111063301111111,0.111063301111111,0.111063301111111,0.111063301111111,0.111063301111111,0.111063301111111,0.111063301111111,0.159434087777778,0.159434087777778,0.159434087777778,0.159434087777778,0.159434087777778,0.263117816666667,0.263117816666667,0.263117816666667,0.263117816666667,0.263117816666667,0.387305187777778,0.387305187777778,0.387305187777778,0.387305187777778,0.387305187777778,0.294228284444444,0.294228284444444,0.294228284444444,0.294228284444444,0.294228284444444,0.294228284444444,0.294228284444444,0.23647585,0.23647585,0.23647585,0.23647585,0.23647585,0.160979622222222,0.160979622222222,0.160979622222222,0.160979622222222,0.160979622222222,0.160979622222222,0.160979622222222,0.160979622222222,0.160979622222222,0.070249728888889,0.070249728888889,0.070249728888889,0.070249728888889,0.070249728888889,0.070249728888889,0.070249728888889,0.070249728888889,0.070249728888889,0.070249728888889,0.171020701111111,0.171020701111111,0.171020701111111,0.171020701111111,0.171020701111111,0.171020701111111,0.171020701111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111,0.163954371111111)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.168844548888889,-0.168844548888889,-0.168844548888889,-0.168844548888889,-0.168844548888889,-0.168844548888889,-0.168844548888889,-0.011090403333333,-0.011090403333333,-0.011090403333333,-0.011090403333333,-0.011090403333333,-0.011090403333333,-0.011090403333333,-0.011090403333333,-0.011090403333333,-0.013828024444444,-0.013828024444444,-0.013828024444444,-0.013828024444444,-0.013828024444444,-0.013828024444444,-0.013828024444444,-0.013828024444444,-0.013828024444444,-0.013828024444444,0.004219014444444,0.004219014444444,0.004219014444444,0.004219014444444,0.004219014444444,0.004219014444444,0.004219014444444,0.004219014444444,0.004219014444444,0.004219014444444,-0.019486654444444,-0.019486654444444,-0.019486654444444,-0.019486654444444,-0.019486654444444,0.024541126666667,0.024541126666667,0.024541126666667,0.024541126666667,0.024541126666667,-0.06992596,-0.06992596,-0.06992596,-0.06992596,-0.06992596,-0.109161035555556,-0.109161035555556,-0.109161035555556,-0.109161035555556,-0.109161035555556,-0.109161035555556,-0.109161035555556,0.097614665555556,0.097614665555556,0.097614665555556,0.097614665555556,0.097614665555556,0.105067984444444,0.105067984444444,0.105067984444444,0.105067984444444,0.105067984444444,0.105067984444444,0.105067984444444,0.105067984444444,0.105067984444444,0.033752613333333,0.033752613333333,0.033752613333333,0.033752613333333,0.033752613333333,0.033752613333333,0.033752613333333,0.033752613333333,0.033752613333333,0.033752613333333,0.021981882222222,0.021981882222222,0.021981882222222,0.021981882222222,0.021981882222222,0.021981882222222,0.021981882222222,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556,0.073290275555556)
trans=0.5
age=(0:(134-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.48691170000000006), xlim = c(-140.7,-20.3), ylab = 'Speciation rate', xlab = 'Ma',main='Synapsida Marginal RTT' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.5879654000000001), xlim = c(-140.7,-20.3), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.38173300000000004, 0.22314600000000004), xlim = c(-140.7,-20.3), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,rev(1/M_mean),type = 'n', xlim = c(-140.7,-20.3), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()