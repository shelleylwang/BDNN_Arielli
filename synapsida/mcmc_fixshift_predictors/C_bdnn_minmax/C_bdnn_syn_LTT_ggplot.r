# Required libraries
library(ggplot2)
library(gridExtra)
library(deeptime)   # For coordinate system


# Data preparation
ts=c(107.00438700363337, 81.64960438255982,61.883095830287004,42.905377670463004,84.93682256880632,96.68043374290825,70.43974099791109,128.3470750097001,83.5665995416949,48.573696919987995,70.59388130983677,87.23569647674974,101.58681176515294,86.49920076880855,89.26844522304691,89.22073592714364,83.83570645261615,85.73789161845131,98.00203511875688,41.88796949543884,71.76946310129001,106.71570659964,69.92571734208158,89.06081367038522,88.34262015765731,91.63374429500328,71.32142324583607,88.88898153823932,89.38575284475384,118.96655928690318,91.43614701971133,135.00623741316014,127.29195633962603,85.2063228115868,85.62480597849975,61.09872233731487,111.7831947051967,84.93381338197092,82.42468585157613,88.79028245993844,91.4028259133546,86.87254274773053,127.98513785509839,85.03555077047523,72.43061735184835,74.08978789419882,91.23718357465083,97.99930386185403,97.46103502242248,84.44768957922867,126.47932035525946,31.7467349277992,70.96076541431572,67.48600785608728,60.07638809515662,45.12107369237437,89.68808746722742,33.323466781942024,52.02752859739553,52.38498993509927,84.49923119586884,85.21833011663463,89.20885586872076,81.06272215326837,121.25488059935113,111.39208152313915,64.93263193456595,80.66585744997168,109.14053065336283,106.95210983417596,106.08833206570073,91.89396500811122,81.77516327485861,81.29662856669518,29.056582979821997,50.12916900680008,82.0608101912799,46.09104003513372,67.38468604247825,95.35068156369515,90.91307285772064,87.0096822795031,81.97181789350994,84.76440859073992,70.45982307897866,85.32052223285814,132.10611147580528,88.88252522652472,85.66292196907743,108.59125677293082,74.75434022239136,72.33266518913544,89.65757068540762,69.46468957346192,85.62714488456538,124.28166947638307,111.13971950905011,119.12991212942367,121.82656513855711,89.05667979886444,81.72376190965454,72.39453299447771,85.16647239639329,85.21661500747787,62.40085182705364,78.36099708730097,88.70690587204301,80.50067693903266,124.32326375380838,94.55996963112922,50.308737363904044,83.89791289074324,87.10096147688307,92.10567812276803,72.40085709666774,90.52841509865667,112.30555983248702,71.42957245374949,84.30871142320471,85.56860423693597,57.62445123270259,85.16253286526516,78.43249575666397,92.1007938077423,81.5358843663263,107.87297487872088,123.69868974399716,85.34659709350102,67.11632451810576,85.16892993188814,91.95081556465072,70.19120946668296,77.62714332523696,100.05236368855209,43.843952499994444,87.25703724932498,57.51669038980433,129.39232465314058,126.7398864793831,64.20762568307426,88.18281012453471,88.38179093573262,82.50669368067425,95.06897194028822,84.11480260792898,81.5553303702152,84.6967201256125,101.40337601186681,85.1156152473583,97.6062958697319,87.79453948924989,127.27912913089034,95.91026964126267,30.63417574188602,89.33930913036812,112.14069060726229,31.75919043014922,76.4533224744386,89.9475256949855,94.20689103555594,58.241137043267145,81.28617523155812,82.6309977593862,106.97048737078188,65.56659387982089,69.44539160560674,30.75300758340648,88.21848551286126,88.76438099767775,77.22190127099188,41.016781477016416,78.04031539143769,84.35020982749809,91.76146688402092,106.93034617945754,58.4127445543506,57.190011513172365,78.99375908682319,104.76310786448738,89.56111777115302,85.39989586770963,88.17230404211156,30.65080160368448,29.89556123515817,30.34537698801098,131.08898151798354,32.26188988343203,72.09666187829865,86.6095596691741,29.015688292958814,84.92656088758764,88.82897227735864,85.35264398759986,84.20457698773319,81.91285411270125,87.34721846192735,121.55601042503804,30.190241558995105,131.02626478244204,130.28382435747065,83.62395839786,82.26689565036277,80.28592244314937,85.68052752887253,81.95274746299404,92.24998046468293,84.89793185333171,83.06331669966332,88.1270548381982,69.99293973418594,89.96530317616863,82.05428925514728,83.32041622573584,50.271536537839324,61.59825096895521,81.69445508147868,65.76767413924598,80.60069921483571,81.81286800943344,89.91987441869354,87.20251501545573,99.63560242338248,75.54763715027946,88.2840800677341,42.4606196182402,84.52770163879599,84.76970916571295,84.8104770387782,130.01158840331559,89.62365171638574,80.1379161924466,85.00166705987844,106.59663307651195,70.55588908898989,86.99685002278913,33.054536732241466,80.54819456281736,81.31453635707062,89.48249471304126,75.99869751278348,88.59010649820553,83.29607294535496,82.22148112172358,87.05234931810352,85.67174856971745,33.44874785920955,82.45840893651041,37.06984420164668,82.23015537874865,81.86691500430004,71.91288861609573,70.01058458288426,121.46079851862798,84.3769184174713,85.1115953861154,86.58940057015077,80.96947141641574,88.28893777314192,87.29167760611784,78.91699867486305,87.43127284867609,126.68617990676563,57.73185317982423,83.14238079740886,71.2910203071923,112.66751761472905,67.1575653723597,101.76015227838086,31.295347289003214,84.13249801130013,134.12711748381648,65.29162406808965,98.22348449209439,112.31823730413673,30.30223862146246,59.08079647020523,75.3274347348304,69.52275061765131,32.515239793153256,98.78411013510149,89.83573111634574,89.49826971836353,83.83906690736563,128.47374817486863,45.530065819798,84.82142444014934,29.654579301258906,92.41587398255535,61.307619653329475,30.525121264558493,91.19333381015343,32.40215056341737,91.97999863880707,89.82528804384492,84.99259551588351,84.71563996986633,87.25625816322405,29.753323938588206,81.67167568624097,114.1991130137335,82.51683523900266,76.90685060586229,82.34001686465405,82.1088165113168,84.07508378664207,87.43966230885898,63.55350709788999,117.7254150372115,96.45646386436513,82.74392203836709,96.55398721666907,126.46084653631708,87.4937069272992,87.02270909172323,80.15505110340115,70.36643881657574,88.55440949806109,82.02409723728042,70.07473948002755,85.12262818854653,127.22919585872064,32.39403712530139,76.45252884489828,129.09870887474304,81.55099986715408,70.98163677181968,112.91615954706162,91.03955109595663,87.64675585319837,86.51590704966723,84.46000128013644,92.200920180002,76.10833559802887,99.13423789739888,82.6754135312948,80.67556109787887,71.79628940749342,86.84360436428182,66.74597230337004,87.78562426452517,60.905668455716174,91.70519981118679,84.5615369753664,83.428754548695,67.0013269201769,44.09090680195336,37.828213705296726,87.83099386617629,90.84977546061621,88.57108259709551,98.20635126716964,95.34819270606343,59.75710838367093,64.34318350040556,76.68920243240481,82.28233990375449,84.7649054356826,44.34870856620629,56.394152815920194,82.11682473884154,90.18829670057445,86.01256714215715,88.88400572688586,89.77853566455184,89.34660632565918,87.97100277644196,66.95059879924221,87.39440761246237,85.85833683029811,85.26688379270881,83.19065850348338,76.78612718979099,84.766619891521,90.29320919391326,64.53353386213179,67.31368852068357,59.223797970221895,57.12690666304069,41.27930135333726,42.35976825114724,88.77959560070668,84.36571221468017,74.11704720191335,93.8782740739786,71.3150381581684,96.69007914571272,87.4456978017867,70.64562582393137,42.575682487016515,76.45594589957666,95.21399493496594,123.93256940182667,75.12138294271048,58.976249458793994,42.55874818437982,84.83966476974189,70.93896471308571,69.05272109707884,91.77714622676919,86.94127260712897,52.058378142423805,59.13812191638796,89.21979567147415,32.954106140846015,56.611800475616405,85.09184577656418,83.72701786760965,110.22200138612652,127.41623224824723,71.38487992804365,56.98037272799697,60.993201120568,52.3899007755864,87.92374245483839,82.56081597034412,85.49599236019289,71.92258246630519,52.85759028761431,82.9904090673563,86.55100647129412,76.61398827968088,80.94044243461596,83.67500606047845,80.64523080019778,84.20796201257791,85.22013868551873,88.27183431024791,86.86002119080212,89.50572237394861,115.29085539305993,69.2159818943655,71.54427155991732,72.01292263889597,69.43939830870343,112.95944770557452,81.00110846696074,74.45053895891066,83.68165705577839,30.232931392315475,69.40770814921277,71.88079735295946,97.76850453689487,82.0389300146446,58.96257445018278,89.1973802601029,84.21449250180558,128.4227442509139,70.17268727421414,100.91548047812755,117.62799763401816,129.55873850342783,88.50997765528506,89.32228180395337,88.67639923195813,89.47048168500761,89.43888566335181,76.64227217996867,84.89986973227481,100.54784429086989,84.79206364382938,70.08514286918744,112.12566756135068,86.61693004137821,80.2608742277803,90.80099984518716,88.23254931375904,106.80220464646274,87.08899504612273,130.14741366384072,43.553248788130986,103.66234783616484,84.63702572967479,71.7074540243336,85.05010188154311,51.72965607955644,87.36583693616595,29.54527157341748,81.1849109050545,40.53462332898144,76.89563847289413,91.79266736908187,84.15311732918143,57.123431020944665,92.3371486005289,92.76039954321715,67.3970461254014,69.52431546526073,104.22373397513306,40.5924441120457,71.9870648866543,34.34470906334515,87.24023067056301,89.44741806677852,87.61325658220647,87.67453471673018,59.953065049167215,83.18378135142612,70.8940429185324,92.49405611092345,91.8847029687441,31.094258835720396,86.03299460727341,70.9693386885521,76.69432463175146,86.87476823990266,94.67776192144356,115.65320518556874,114.14182159578439,121.81787986812074,91.52173406141179,80.72113433339258,89.03505582310913,88.28573292484361,71.80722017977978,89.28295374173045,69.32397226972522,87.53620695142168,92.43792612235693,93.6535915550506,32.43260825175836,60.718026296203284,72.14270917589084,130.797519259514,68.8328001085012,69.56554381528683)
te=c(83.81329560125114, 81.2906640068223,53.152809901854454,41.75518343126034,77.04876590531006,78.98713016852409,70.09592457443972,116.16319228185868,78.73692108810097,46.96360002114468,50.256783152123916,86.4681953425927,100.55693069107436,85.79107205967844,85.24110989060989,84.74567951977244,83.34972234967054,78.02489221082456,90.61826368458539,40.81444770810786,43.68996490359893,91.2723073784931,69.55882286206513,82.1920754092601,87.47435785567617,90.53166126624741,67.41472697266637,88.03263111746797,84.60280301982245,117.92601593843267,90.35216339154879,132.21397107484526,126.22496463629597,78.71343165881845,78.36194128823652,53.59227556572851,110.92596537901532,77.11273199566662,82.09816343926045,84.66173888128756,90.2865436486183,86.10088756908411,118.8867584290492,78.23361380494228,67.01809122280247,73.95502773815265,90.1847982851254,88.91617879904221,92.9629162244136,83.94607872704141,125.68220454879499,30.92054599086657,70.61637749828331,55.58002433323704,42.20704195525505,43.633623876909745,84.67432606473405,27.611467589539885,33.564871553017255,33.55044253643929,78.13510771888576,79.400746051745,88.32029085829842,80.77576151256126,120.4185659785553,110.7340266380182,64.58654527850311,80.41953410075669,97.58435029933666,92.94732940601563,95.34709472858586,91.03311397281081,81.49342225988067,81.0089033276481,28.285975797108854,37.27895890998789,81.70238360000667,44.586380452638366,42.9891739779442,81.47577049924999,89.90548431940354,83.30794496679964,81.70089998522207,79.08677351057233,70.08804115191278,77.50930320989121,103.1513750289892,77.17519226058069,77.63656870450782,90.95086589067655,74.63113618721319,60.685487672496365,84.96206058675097,69.09438972419693,79.55871552772807,123.41382885874287,110.32061040721563,108.85694518764652,113.59552651019456,85.1558166702741,81.44870787426525,52.46285016329071,77.6282135016167,77.08786774559718,52.656611543561596,78.1218802429916,76.90011827950312,80.27486328134758,123.52529291686574,93.49252881225347,49.61485689148768,82.37448224526939,86.32620373959712,85.41925484853164,54.67147373300814,85.47418081284236,63.29758354370603,71.2261704796831,59.914017543828265,74.04722061125123,56.003681833575925,77.42506955226169,78.18613922759143,77.07270642106023,81.24790869906332,93.3319270117779,89.52436618219092,73.68662060389559,57.39837668856322,78.69301719471329,89.86202707256747,69.81292913062367,73.67541465636286,98.85488945942731,42.63833545329393,83.34203620453562,55.86430190018778,93.3174546023956,125.70204664437384,63.95750152509472,87.32779024639164,83.91915549700552,82.19941776535293,78.69421882855366,79.01061289992113,81.25969839492662,80.13040138798209,78.64913013513483,77.19317105903399,89.49837587306526,86.95363218546872,126.22476808471205,87.54117006315624,29.940158759452885,80.69757171178568,111.21038351456126,27.857723895465504,73.09118537209302,78.67139054365049,89.10190511524571,56.684530944510485,81.00963686889853,82.28801024222491,106.0977660969122,32.978867147990535,69.24698587022077,29.94399887436527,84.96796765089611,81.13015174041934,71.97816988977657,26.798235560928457,77.81917139159324,79.9812862073245,85.09538134475939,105.7469791519017,45.77426382343137,56.438206361504015,76.99133766304071,94.07061545154947,78.08887791558796,84.9013898712319,85.21671178178647,29.849674928876986,29.093285387748754,29.56681882225358,110.92754547496084,28.496559172779698,71.87778088153202,85.88935661777354,28.264404956832855,80.07379521426905,85.57505618937988,78.99969784160938,78.05354761458462,81.62108130659229,86.57164608185649,120.68504687878753,29.36807461099568,128.61944168886322,129.2100344220047,79.57193332507029,81.94048152695028,79.97742732909255,81.02772250867231,81.6218810802009,85.99928270284116,77.35463853556149,82.6829252507139,87.39776498757765,69.64393946227182,81.39988425442505,81.7115675590951,83.06296619204657,37.188006881887574,52.084089244458276,81.41199388815431,33.395817554850616,77.05540434404827,81.54858040813787,81.15629373928599,86.53185939240436,94.84569402097802,67.0137340140446,85.54135583802042,41.34750890082112,79.4953770227447,79.37889575006389,78.5445003767153,128.9462524814609,84.82708535671507,79.82313852945032,78.3772084971944,95.05897055518395,68.26593850022778,86.30475692002133,27.224384788575428,80.3110807649974,80.99749970024112,88.55487240139334,72.07286542451584,86.2111750773342,79.30774370964122,81.85711269768552,84.08731725063613,76.70258735473726,27.027032417404644,82.15916007170078,36.23530214169047,81.89708785230948,81.53951498718874,55.453046156735084,69.67538889589885,120.38287067008521,80.5398032968033,77.9230707336526,85.89223587297636,80.66156490699896,81.19642307385638,86.47660151783909,74.71148712309025,72.1834393136146,125.5421004036267,57.11030879164213,82.87568355941734,68.12801955072834,112.06782090583229,56.027845111579026,100.61126458303983,30.47460409585662,82.3078213596929,133.083246891121,50.19197816792409,89.09136407120079,111.33912633939268,29.53608300783342,36.190068361559575,67.19944726502517,69.18288636540404,28.566178646118285,92.9345247733086,82.79364372368582,84.78998645057167,79.66948956920632,127.38766599616663,43.99590729382549,80.2957380534006,29.007316914321265,91.4082404541717,30.952020818764655,29.753295768552984,90.13086113465705,26.8854741431127,86.36865804562272,82.16789253215035,72.17283184344271,82.28570514673497,86.57308546371625,28.98929017954644,81.39417358296203,99.38048081000902,82.18638919332437,71.95241931847022,82.05081750430561,81.80399134292604,78.03052975173058,86.78708175507506,63.33243608276759,116.85048516403515,89.63049219364659,82.39165705314504,91.37974706297848,125.4336848052756,86.7789409507439,86.35563242007133,79.88801452847254,68.39326889984332,87.75441670486337,81.64853791222124,69.7025593862043,79.26015156746186,113.59392675854178,28.26630928456983,71.93778097127746,93.27421034780386,81.26901696032179,67.78326627581417,111.99207402040024,89.96669932029245,76.99178364922943,85.91481707457861,79.97797964792943,86.66778949594998,75.91649350526117,93.33810463215146,82.37196740532674,80.37364234092601,65.91068898568874,86.19386859849554,58.39007189689884,86.95315509846776,53.57811972223025,89.35348272030801,77.03510249914999,78.1437918203869,33.18529530797009,42.98169325980289,36.59645965730731,83.58168451005011,84.78187457895088,85.6394358535206,97.35690086784298,89.5895875872954,33.931921640707124,64.04781478246426,72.19192083338704,82.00031822705807,79.0689305268503,43.157267252591694,55.33105602495583,81.76602376893076,86.3009102289692,85.47213661281792,79.1204412253136,82.79220485890953,84.80269705361171,87.13434628265871,52.5125634062045,86.70405481714242,81.1081395230058,73.8661411048345,80.02521864436272,76.5184154134935,77.6831566294181,89.44377248838319,64.19927407661197,59.83762607281193,35.23235977391971,55.432034504027826,26.84297501953355,41.20182600884454,85.09782363794042,82.44401392103246,73.98705621266903,92.83033337773753,68.18672993381037,95.6115609852665,86.67720537508195,68.08982725752509,41.481610801275565,73.14830587696531,89.83049831592572,123.08120879919778,74.9990823342037,55.39493620794674,41.47584822146912,79.00301404497827,67.61538769980777,68.64392650469449,89.54124636097067,86.2010296884743,33.92546044711609,57.92718774811942,83.72660318833543,28.841008272091912,55.88573567287414,77.38792392652142,79.87866148729432,109.43816204663383,126.3908666659074,63.22513306358959,55.41171014842388,52.593404905010054,33.283303340181554,87.21988340682674,82.23142443903821,79.10810447833865,63.59861503427815,27.35084978956432,82.60115503323372,85.89583185578729,76.4780687117746,80.64865113447928,72.00804408720097,80.32853968712985,83.75114554977279,78.8418437840087,80.55327772680808,86.21829399603328,84.78177215153501,101.56978328629208,68.86582785535396,68.05437146436071,67.3244186501739,69.08634008293427,112.01267668949654,80.74678299523329,74.31493833079256,80.73355060122891,29.469984554683933,69.03166371164124,65.24677239202657,91.76386031934801,81.72431864700718,35.81783606103401,85.48887883870933,79.14363474875277,108.62067212369028,60.14305015874621,99.85107273507484,116.57732158665095,128.625832368593,86.45398654668385,84.71385382360916,85.52438607915643,85.34945907834529,84.56682574387493,76.49516223085813,79.68925617831309,85.49126524842498,78.94760464371826,67.85261561926244,111.54167029999222,85.86463661168457,80.01493406158959,89.73117551908355,85.1976140240225,95.05388448358315,86.32307166541851,129.08169630150337,42.1826571395571,102.4552995107168,72.23117629814776,68.32350175625285,69.51433706771185,50.330180340148225,86.59032664274046,28.78597012407916,80.8859934219158,26.23108141058234,72.215560322048,90.76048311280125,80.78896852852809,56.41460475371948,85.32022224379159,84.56087540114889,59.09768288733208,69.18115456781742,102.99592388017645,26.201832587106523,67.35056545907176,33.25713475251947,86.47260193582152,85.17828117280192,86.79769035432616,79.34866789607663,38.12346964330715,77.0966915385171,67.45011649804998,85.32519029998112,85.16660273460815,30.335578533050366,85.47058089790997,67.92664156952854,76.55454067397416,86.20683701654463,93.55008349792776,100.3121661770242,98.19315607610083,112.81303601446685,90.48722103830042,80.4256464081601,85.51923843142703,85.2057045737286,67.6241611582462,81.75747932752587,69.00159710492339,86.74246217237969,91.46852793896599,92.55149611765685,27.57093779241992,53.8744805713619,62.27863572526362,128.3699114203158,68.46154523456929,69.2084354848276)
div_traj=c(0, 1,2,1,0,1,2,3,4,5,6,7,8,9,8,9,8,7,6,5,6,7,6,7,8,9,8,9,10,11,12,13,14,15,14,13,12,11,10,9,8,9,10,11,12,11,10,9,10,11,12,13,14,13,12,11,12,13,12,11,12,13,12,11,10,11,12,13,14,13,12,13,14,13,14,15,16,17,18,17,16,15,16,15,16,15,14,15,14,13,12,11,12,11,12,11,10,11,12,13,14,15,16,17,18,19,18,19,18,19,20,21,20,19,18,19,20,19,20,21,20,19,20,19,20,19,20,19,20,19,20,21,22,21,22,23,24,25,24,25,24,25,26,27,28,29,28,29,30,29,30,31,30,29,28,29,30,31,30,31,32,31,30,29,28,27,26,25,24,23,22,23,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,35,36,37,38,39,38,39,38,39,38,37,38,39,40,39,38,39,40,41,40,39,38,39,38,37,38,37,38,37,36,35,36,37,38,37,36,37,36,37,38,37,38,39,38,39,38,39,38,37,38,37,38,39,40,41,40,41,42,41,42,43,44,45,46,47,48,49,50,49,48,49,50,51,50,51,52,53,54,55,56,57,58,59,60,61,60,61,62,63,64,63,64,65,66,67,68,69,70,71,72,71,72,73,74,75,76,75,76,77,78,77,78,79,78,79,80,81,80,81,82,83,82,83,84,85,86,87,86,87,86,87,88,89,90,91,92,91,90,91,92,93,94,95,94,93,92,91,90,89,88,89,90,89,90,89,88,89,88,89,90,89,88,87,86,85,84,83,82,81,80,79,78,77,76,75,74,75,76,75,74,73,72,71,70,71,70,71,72,73,74,73,74,75,74,75,74,73,72,73,72,71,70,69,68,67,68,69,68,69,68,69,68,69,68,69,70,69,70,71,70,69,68,69,68,69,70,69,70,71,72,71,70,71,72,73,74,75,74,73,74,75,76,75,76,77,78,77,78,79,78,79,78,77,76,77,78,79,80,79,80,79,80,79,78,79,78,77,78,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,90,91,90,89,90,91,92,91,90,91,90,91,92,93,92,93,94,93,92,93,92,93,94,95,96,97,96,97,96,95,94,95,94,95,96,95,96,97,98,99,98,99,98,97,96,97,96,95,94,95,96,95,96,97,96,95,94,93,92,93,94,93,94,95,94,95,96,95,96,97,96,97,96,97,96,97,96,97,96,95,94,95,94,93,92,93,94,95,94,93,92,93,94,93,92,93,92,91,90,89,88,87,88,89,88,89,88,87,86,85,86,85,84,83,84,83,82,81,82,81,82,83,82,81,80,79,78,79,78,79,80,79,78,79,80,79,80,79,80,79,78,77,76,75,74,75,74,75,76,77,76,75,74,73,72,71,70,69,68,67,66,65,64,63,62,61,60,59,58,57,56,55,54,53,52,51,50,49,50,49,48,49,48,47,46,45,44,43,42,41,42,41,40,41,40,39,38,37,36,35,34,35,34,33,32,31,30,29,28,29,28,27,26,25,26,25,24,23,22,21,20,19,18,17,16,15,16,15,16,17,16,17,18,19,20,19,18,17,16,17,18,19,20,21,20,21,22,23,22,23,22,21,22,21,22,23,22,21,20,19,18,17,16,15,16,17,18,19,18,17,16,15,14,15,16,15,16,15,16,15,14,13,14,15,16,15,16,17,18,19,20,21,22,23,24,25,24,25,26,27,28,29,30,29,30,31,32,33,34,35,36,35,34,35,36,37,38,39,38,37,36,35,36,35,36,37,36,37,38,39,40,41,40,41,40,39,38,37,36,37,36,35,34,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,22,21,20,21,22,21,20,21,20,21,22,21,20,21,22,23,22,23,24,25,24,25,24,25,26,27,26,25,24,23,24,23,22,21,22,21,22,23,24,25,26,27,28,27,26,27,28,27,26,27,28,29,28,29,30,31,32,31,32,31,32,33,34,33,34,35,36,35,36,35,36,35,34,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,21,20,19,18,17,18,19,18,19,20,21,20,21,22,21,20,21,20,21,20,21,20,21,22,21,22,23,22,23,22,21,22,21,20,19,20,19,20,21,22,23,22,21,22,21,20,19,18,19,18,19,18,19,20,19,20,19,18,19,18,17,16,15,14,15,14,13,12,11,12,11,12,11,10,9,10,9,10,11,12,13,14,15,16,17,18,19,18,17,18,19,20,21,20,21,20,21,22,23,22,21,22,21,22,21,22,21,22,21,20,19,18,19,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1)
time_events=c(135.00623741316014, 134.12711748381648,133.083246891121,132.21397107484526,132.10611147580528,131.08898151798354,131.02626478244204,130.797519259514,130.28382435747065,130.14741366384072,130.01158840331559,129.55873850342783,129.39232465314058,129.2100344220047,129.09870887474304,129.08169630150337,128.9462524814609,128.625832368593,128.61944168886322,128.47374817486863,128.4227442509139,128.3699114203158,128.3470750097001,127.98513785509839,127.41623224824723,127.38766599616663,127.29195633962603,127.27912913089034,127.22919585872064,126.7398864793831,126.68617990676563,126.47932035525946,126.46084653631708,126.3908666659074,126.22496463629597,126.22476808471205,125.70204664437384,125.68220454879499,125.5421004036267,125.4336848052756,124.32326375380838,124.28166947638307,123.93256940182667,123.69868974399716,123.52529291686574,123.41382885874287,123.08120879919778,121.82656513855711,121.81787986812074,121.55601042503804,121.46079851862798,121.25488059935113,120.68504687878753,120.4185659785553,120.38287067008521,119.12991212942367,118.96655928690318,118.8867584290492,117.92601593843267,117.7254150372115,117.62799763401816,116.85048516403515,116.57732158665095,116.16319228185868,115.65320518556874,115.29085539305993,114.1991130137335,114.14182159578439,113.59552651019456,113.59392675854178,112.95944770557452,112.91615954706162,112.81303601446685,112.66751761472905,112.31823730413673,112.30555983248702,112.14069060726229,112.12566756135068,112.06782090583229,112.01267668949654,111.99207402040024,111.7831947051967,111.54167029999222,111.39208152313915,111.33912633939268,111.21038351456126,111.13971950905011,110.92754547496084,110.92596537901532,110.7340266380182,110.32061040721563,110.22200138612652,109.43816204663383,109.14053065336283,108.85694518764652,108.62067212369028,108.59125677293082,107.87297487872088,107.00438700363337,106.97048737078188,106.95210983417596,106.93034617945754,106.80220464646274,106.71570659964,106.59663307651195,106.0977660969122,106.08833206570073,105.7469791519017,104.76310786448738,104.22373397513306,103.66234783616484,103.1513750289892,102.99592388017645,102.4552995107168,101.76015227838086,101.58681176515294,101.56978328629208,101.40337601186681,100.91548047812755,100.61126458303983,100.55693069107436,100.54784429086989,100.3121661770242,100.05236368855209,99.85107273507484,99.63560242338248,99.38048081000902,99.13423789739888,98.85488945942731,98.78411013510149,98.22348449209439,98.20635126716964,98.19315607610083,98.00203511875688,97.99930386185403,97.76850453689487,97.6062958697319,97.58435029933666,97.46103502242248,97.35690086784298,96.69007914571272,96.68043374290825,96.55398721666907,96.45646386436513,95.91026964126267,95.6115609852665,95.35068156369515,95.34819270606343,95.34709472858586,95.21399493496594,95.06897194028822,95.05897055518395,95.05388448358315,94.84569402097802,94.67776192144356,94.55996963112922,94.20689103555594,94.07061545154947,93.8782740739786,93.6535915550506,93.55008349792776,93.49252881225347,93.33810463215146,93.3319270117779,93.3174546023956,93.27421034780386,92.9629162244136,92.94732940601563,92.9345247733086,92.83033337773753,92.76039954321715,92.55149611765685,92.49405611092345,92.43792612235693,92.41587398255535,92.3371486005289,92.24998046468293,92.200920180002,92.10567812276803,92.1007938077423,91.97999863880707,91.95081556465072,91.89396500811122,91.8847029687441,91.79266736908187,91.77714622676919,91.76386031934801,91.76146688402092,91.70519981118679,91.63374429500328,91.52173406141179,91.46852793896599,91.43614701971133,91.4082404541717,91.4028259133546,91.37974706297848,91.2723073784931,91.23718357465083,91.19333381015343,91.03955109595663,91.03311397281081,90.95086589067655,90.91307285772064,90.84977546061621,90.80099984518716,90.76048311280125,90.61826368458539,90.53166126624741,90.52841509865667,90.48722103830042,90.35216339154879,90.29320919391326,90.2865436486183,90.18829670057445,90.1847982851254,90.13086113465705,89.96669932029245,89.96530317616863,89.9475256949855,89.91987441869354,89.90548431940354,89.86202707256747,89.83573111634574,89.83049831592572,89.82528804384492,89.77853566455184,89.73117551908355,89.68808746722742,89.65757068540762,89.63049219364659,89.62365171638574,89.5895875872954,89.56111777115302,89.54124636097067,89.52436618219092,89.50572237394861,89.49837587306526,89.49826971836353,89.48249471304126,89.47048168500761,89.44741806677852,89.44377248838319,89.43888566335181,89.38575284475384,89.35348272030801,89.34660632565918,89.33930913036812,89.32228180395337,89.28295374173045,89.26844522304691,89.22073592714364,89.21979567147415,89.20885586872076,89.1973802601029,89.10190511524571,89.09136407120079,89.06081367038522,89.05667979886444,89.03505582310913,88.91617879904221,88.88898153823932,88.88400572688586,88.88252522652472,88.82897227735864,88.79028245993844,88.77959560070668,88.76438099767775,88.70690587204301,88.67639923195813,88.59010649820553,88.57108259709551,88.55487240139334,88.55440949806109,88.50997765528506,88.38179093573262,88.34262015765731,88.32029085829842,88.28893777314192,88.28573292484361,88.2840800677341,88.27183431024791,88.23254931375904,88.21848551286126,88.18281012453471,88.17230404211156,88.1270548381982,88.03263111746797,87.97100277644196,87.92374245483839,87.83099386617629,87.79453948924989,87.78562426452517,87.75441670486337,87.67453471673018,87.64675585319837,87.61325658220647,87.54117006315624,87.53620695142168,87.4937069272992,87.47435785567617,87.4456978017867,87.43966230885898,87.43127284867609,87.39776498757765,87.39440761246237,87.36583693616595,87.34721846192735,87.32779024639164,87.29167760611784,87.25703724932498,87.25625816322405,87.24023067056301,87.23569647674974,87.21988340682674,87.20251501545573,87.13434628265871,87.10096147688307,87.08899504612273,87.05234931810352,87.02270909172323,87.0096822795031,86.99685002278913,86.95363218546872,86.95315509846776,86.94127260712897,86.87476823990266,86.87254274773053,86.86002119080212,86.84360436428182,86.79769035432616,86.78708175507506,86.7789409507439,86.74246217237969,86.70405481714242,86.67720537508195,86.66778949594998,86.61693004137821,86.6095596691741,86.59032664274046,86.58940057015077,86.57308546371625,86.57164608185649,86.55100647129412,86.53185939240436,86.51590704966723,86.49920076880855,86.47660151783909,86.47260193582152,86.4681953425927,86.45398654668385,86.36865804562272,86.35563242007133,86.32620373959712,86.32307166541851,86.30475692002133,86.3009102289692,86.21829399603328,86.2111750773342,86.20683701654463,86.2010296884743,86.19386859849554,86.10088756908411,86.03299460727341,86.01256714215715,85.99928270284116,85.91481707457861,85.89583185578729,85.89223587297636,85.88935661777354,85.86463661168457,85.85833683029811,85.79107205967844,85.73789161845131,85.68052752887253,85.67174856971745,85.66292196907743,85.6394358535206,85.62714488456538,85.62480597849975,85.57505618937988,85.56860423693597,85.54135583802042,85.52438607915643,85.51923843142703,85.49599236019289,85.49126524842498,85.48887883870933,85.47418081284236,85.47213661281792,85.47058089790997,85.41925484853164,85.39989586770963,85.35264398759986,85.34945907834529,85.34659709350102,85.32519029998112,85.32052223285814,85.32022224379159,85.26688379270881,85.24110989060989,85.22013868551873,85.21833011663463,85.21671178178647,85.21661500747787,85.2063228115868,85.2057045737286,85.1976140240225,85.17828117280192,85.16892993188814,85.16660273460815,85.16647239639329,85.16253286526516,85.1558166702741,85.12262818854653,85.1156152473583,85.1115953861154,85.09782363794042,85.09538134475939,85.09184577656418,85.05010188154311,85.03555077047523,85.00166705987844,84.99259551588351,84.96796765089611,84.96206058675097,84.93682256880632,84.93381338197092,84.92656088758764,84.9013898712319,84.89986973227481,84.89793185333171,84.83966476974189,84.82708535671507,84.82142444014934,84.8104770387782,84.80269705361171,84.79206364382938,84.78998645057167,84.78187457895088,84.78177215153501,84.76970916571295,84.766619891521,84.7649054356826,84.76440859073992,84.74567951977244,84.71563996986633,84.71385382360916,84.6967201256125,84.67432606473405,84.66173888128756,84.63702572967479,84.60280301982245,84.56682574387493,84.5615369753664,84.56087540114889,84.52770163879599,84.49923119586884,84.46000128013644,84.44768957922867,84.3769184174713,84.36571221468017,84.35020982749809,84.30871142320471,84.21449250180558,84.20796201257791,84.20457698773319,84.15311732918143,84.13249801130013,84.11480260792898,84.08731725063613,84.07508378664207,83.94607872704141,83.91915549700552,83.89791289074324,83.83906690736563,83.83570645261615,83.81329560125114,83.75114554977279,83.72701786760965,83.72660318833543,83.68165705577839,83.67500606047845,83.62395839786,83.58168451005011,83.5665995416949,83.428754548695,83.34972234967054,83.34203620453562,83.32041622573584,83.30794496679964,83.29607294535496,83.19065850348338,83.18378135142612,83.14238079740886,83.06331669966332,83.06296619204657,82.9904090673563,82.87568355941734,82.79364372368582,82.79220485890953,82.74392203836709,82.6829252507139,82.6754135312948,82.6309977593862,82.60115503323372,82.56081597034412,82.51683523900266,82.50669368067425,82.45840893651041,82.44401392103246,82.42468585157613,82.39165705314504,82.37448224526939,82.37196740532674,82.34001686465405,82.3078213596929,82.28801024222491,82.28570514673497,82.28233990375449,82.26689565036277,82.23142443903821,82.23015537874865,82.22148112172358,82.19941776535293,82.1920754092601,82.18638919332437,82.16789253215035,82.15916007170078,82.11682473884154,82.1088165113168,82.09816343926045,82.0608101912799,82.05428925514728,82.05081750430561,82.0389300146446,82.02409723728042,82.00031822705807,81.97181789350994,81.95274746299404,81.94048152695028,81.91285411270125,81.89708785230948,81.86691500430004,81.85711269768552,81.81286800943344,81.80399134292604,81.77516327485861,81.76602376893076,81.75747932752587,81.72431864700718,81.72376190965454,81.7115675590951,81.70238360000667,81.70089998522207,81.69445508147868,81.67167568624097,81.64960438255982,81.64853791222124,81.6218810802009,81.62108130659229,81.5553303702152,81.55099986715408,81.54858040813787,81.53951498718874,81.5358843663263,81.49342225988067,81.47577049924999,81.44870787426525,81.41199388815431,81.39988425442505,81.39417358296203,81.31453635707062,81.29662856669518,81.2906640068223,81.28617523155812,81.26901696032179,81.25969839492662,81.24790869906332,81.19642307385638,81.1849109050545,81.15629373928599,81.13015174041934,81.1081395230058,81.06272215326837,81.02772250867231,81.00963686889853,81.0089033276481,81.00110846696074,80.99749970024112,80.96947141641574,80.94044243461596,80.8859934219158,80.78896852852809,80.77576151256126,80.74678299523329,80.73355060122891,80.72113433339258,80.69757171178568,80.67556109787887,80.66585744997168,80.66156490699896,80.64865113447928,80.64523080019778,80.60069921483571,80.55327772680808,80.54819456281736,80.5398032968033,80.50067693903266,80.4256464081601,80.41953410075669,80.37364234092601,80.32853968712985,80.3110807649974,80.2957380534006,80.28592244314937,80.27486328134758,80.2608742277803,80.15505110340115,80.1379161924466,80.13040138798209,80.07379521426905,80.02521864436272,80.01493406158959,79.9812862073245,79.97797964792943,79.97742732909255,79.88801452847254,79.87866148729432,79.82313852945032,79.68925617831309,79.66948956920632,79.57193332507029,79.55871552772807,79.4953770227447,79.400746051745,79.37889575006389,79.34866789607663,79.30774370964122,79.26015156746186,79.14363474875277,79.1204412253136,79.10810447833865,79.08677351057233,79.0689305268503,79.01061289992113,79.00301404497827,78.99969784160938,78.99375908682319,78.98713016852409,78.94760464371826,78.91699867486305,78.8418437840087,78.73692108810097,78.71343165881845,78.69421882855366,78.69301719471329,78.67139054365049,78.64913013513483,78.5445003767153,78.43249575666397,78.3772084971944,78.36194128823652,78.36099708730097,78.23361380494228,78.18613922759143,78.1437918203869,78.13510771888576,78.1218802429916,78.08887791558796,78.05354761458462,78.04031539143769,78.03052975173058,78.02489221082456,77.9230707336526,77.81917139159324,77.6831566294181,77.63656870450782,77.6282135016167,77.62714332523696,77.50930320989121,77.42506955226169,77.38792392652142,77.35463853556149,77.22190127099188,77.19317105903399,77.17519226058069,77.11273199566662,77.0966915385171,77.08786774559718,77.07270642106023,77.05540434404827,77.04876590531006,77.03510249914999,76.99178364922943,76.99133766304071,76.90685060586229,76.90011827950312,76.89563847289413,76.78612718979099,76.70258735473726,76.69432463175146,76.68920243240481,76.64227217996867,76.61398827968088,76.55454067397416,76.5184154134935,76.49516223085813,76.4780687117746,76.45594589957666,76.4533224744386,76.45252884489828,76.10833559802887,75.99869751278348,75.91649350526117,75.54763715027946,75.3274347348304,75.12138294271048,74.9990823342037,74.75434022239136,74.71148712309025,74.63113618721319,74.45053895891066,74.31493833079256,74.11704720191335,74.08978789419882,74.04722061125123,73.98705621266903,73.95502773815265,73.8661411048345,73.68662060389559,73.67541465636286,73.14830587696531,73.09118537209302,72.43061735184835,72.40085709666774,72.39453299447771,72.33266518913544,72.23117629814776,72.215560322048,72.19192083338704,72.1834393136146,72.17283184344271,72.14270917589084,72.09666187829865,72.07286542451584,72.01292263889597,72.00804408720097,71.9870648866543,71.97816988977657,71.95241931847022,71.93778097127746,71.92258246630519,71.91288861609573,71.88079735295946,71.87778088153202,71.80722017977978,71.79628940749342,71.76946310129001,71.7074540243336,71.54427155991732,71.42957245374949,71.38487992804365,71.32142324583607,71.3150381581684,71.2910203071923,71.2261704796831,70.98163677181968,70.9693386885521,70.96076541431572,70.93896471308571,70.8940429185324,70.64562582393137,70.61637749828331,70.59388130983677,70.55588908898989,70.45982307897866,70.43974099791109,70.36643881657574,70.19120946668296,70.17268727421414,70.09592457443972,70.08804115191278,70.08514286918744,70.07473948002755,70.01058458288426,69.99293973418594,69.92571734208158,69.81292913062367,69.7025593862043,69.67538889589885,69.64393946227182,69.56554381528683,69.55882286206513,69.52431546526073,69.52275061765131,69.51433706771185,69.46468957346192,69.44539160560674,69.43939830870343,69.40770814921277,69.32397226972522,69.24698587022077,69.2159818943655,69.2084354848276,69.18288636540404,69.18115456781742,69.09438972419693,69.08634008293427,69.05272109707884,69.03166371164124,69.00159710492339,68.86582785535396,68.8328001085012,68.64392650469449,68.46154523456929,68.39326889984332,68.32350175625285,68.26593850022778,68.18672993381037,68.12801955072834,68.08982725752509,68.05437146436071,67.92664156952854,67.85261561926244,67.78326627581417,67.6241611582462,67.61538769980777,67.48600785608728,67.45011649804998,67.41472697266637,67.3970461254014,67.38468604247825,67.35056545907176,67.3244186501739,67.31368852068357,67.19944726502517,67.1575653723597,67.11632451810576,67.01809122280247,67.0137340140446,67.0013269201769,66.95059879924221,66.74597230337004,65.91068898568874,65.76767413924598,65.56659387982089,65.29162406808965,65.24677239202657,64.93263193456595,64.58654527850311,64.53353386213179,64.34318350040556,64.20762568307426,64.19927407661197,64.04781478246426,63.95750152509472,63.59861503427815,63.55350709788999,63.33243608276759,63.29758354370603,63.22513306358959,62.40085182705364,62.27863572526362,61.883095830287004,61.59825096895521,61.307619653329475,61.09872233731487,60.993201120568,60.905668455716174,60.718026296203284,60.685487672496365,60.14305015874621,60.07638809515662,59.953065049167215,59.914017543828265,59.83762607281193,59.75710838367093,59.223797970221895,59.13812191638796,59.09768288733208,59.08079647020523,58.976249458793994,58.96257445018278,58.4127445543506,58.39007189689884,58.241137043267145,57.92718774811942,57.73185317982423,57.62445123270259,57.51669038980433,57.39837668856322,57.190011513172365,57.12690666304069,57.123431020944665,57.11030879164213,56.98037272799697,56.684530944510485,56.611800475616405,56.438206361504015,56.41460475371948,56.394152815920194,56.027845111579026,56.003681833575925,55.88573567287414,55.86430190018778,55.58002433323704,55.453046156735084,55.432034504027826,55.41171014842388,55.39493620794674,55.33105602495583,54.67147373300814,53.8744805713619,53.59227556572851,53.57811972223025,53.152809901854454,52.85759028761431,52.656611543561596,52.593404905010054,52.5125634062045,52.46285016329071,52.3899007755864,52.38498993509927,52.084089244458276,52.058378142423805,52.02752859739553,51.72965607955644,50.330180340148225,50.308737363904044,50.271536537839324,50.256783152123916,50.19197816792409,50.12916900680008,49.61485689148768,48.573696919987995,46.96360002114468,46.09104003513372,45.77426382343137,45.530065819798,45.12107369237437,44.586380452638366,44.34870856620629,44.09090680195336,43.99590729382549,43.843952499994444,43.68996490359893,43.633623876909745,43.553248788130986,43.157267252591694,42.9891739779442,42.98169325980289,42.905377670463004,42.63833545329393,42.575682487016515,42.55874818437982,42.4606196182402,42.35976825114724,42.20704195525505,42.1826571395571,41.88796949543884,41.75518343126034,41.481610801275565,41.47584822146912,41.34750890082112,41.27930135333726,41.20182600884454,41.016781477016416,40.81444770810786,40.5924441120457,40.53462332898144,38.12346964330715,37.828213705296726,37.27895890998789,37.188006881887574,37.06984420164668,36.59645965730731,36.23530214169047,36.190068361559575,35.81783606103401,35.23235977391971,34.34470906334515,33.931921640707124,33.92546044711609,33.564871553017255,33.55044253643929,33.44874785920955,33.395817554850616,33.323466781942024,33.283303340181554,33.25713475251947,33.18529530797009,33.054536732241466,32.978867147990535,32.954106140846015,32.515239793153256,32.43260825175836,32.40215056341737,32.39403712530139,32.26188988343203,31.75919043014922,31.7467349277992,31.295347289003214,31.094258835720396,30.952020818764655,30.92054599086657,30.75300758340648,30.65080160368448,30.63417574188602,30.525121264558493,30.47460409585662,30.34537698801098,30.335578533050366,30.30223862146246,30.232931392315475,30.190241558995105,29.94399887436527,29.940158759452885,29.89556123515817,29.849674928876986,29.753323938588206,29.753295768552984,29.654579301258906,29.56681882225358,29.54527157341748,29.53608300783342,29.469984554683933,29.36807461099568,29.093285387748754,29.056582979821997,29.015688292958814,29.007316914321265,28.98929017954644,28.841008272091912,28.78597012407916,28.566178646118285,28.496559172779698,28.285975797108854,28.26630928456983,28.264404956832855,27.857723895465504,27.611467589539885,27.57093779241992,27.35084978956432,27.224384788575428,27.027032417404644,26.8854741431127,26.84297501953355,26.798235560928457,26.23108141058234,26.201832587106523)
                
# Add 175 to all time values
ts <- ts + 175
te <- te + 175
time_events <- time_events + 175

# Create data frame for lineages plot
lineages_df <- data.frame(
  start = -te,
  end = -ts,
  y = 1:length(ts)
)

# Create data frame for diversity trajectory
diversity_df <- data.frame(
  time = -time_events,
  diversity = div_traj
)

# Plot 1: Lineages through time 
# p1 <- ggplot(lineages_df, aes(x = start, y = y)) +
#  coord_geo(xlim = c(-300, -190), expand=FALSE, clip = "on",
#            dat = list("international epochs", "international periods"), abbrv = list(TRUE, FALSE), 
#            pos = list("bottom", "bottom"), alpha = 1, height = unit(2.5, "line"),
#            rot = 0, size = list(5,4), neg = T) +
#  geom_segment(aes(x = start, xend = end, y = y, yend = y)) +
#  scale_x_continuous(limits = c(-max(ts)-1, -190),
#                     breaks = seq(-300, -190, by = 10)) +
#  labs(title = "synapsida combined_10_mcmc",
#       x = "Time (Ma)",
#       y = "Lineages") +
#  theme_classic() +
#  theme(plot.margin = unit(c(1, 1, 2, 1), "cm"),
#        plot.title = element_text(size = 24, face = "bold", hjust = 0.5),
#        axis.title = element_text(size = 18, face = "bold"),
#        axis.text = element_text(size = 14, face = "bold"))

# Function to format axis labels without negative signs
format_labels <- function(x) {
 return(sprintf("%.0f", abs(x)))
}

# Plot 2: Diversity trajectory
p2 <- ggplot(diversity_df, aes(x = time, y = diversity)) +
 coord_geo(xlim = c(-300, -200), expand=FALSE, clip = "on",
           dat = list("international epochs", "international periods"), abbrv = list(TRUE, FALSE), 
           pos = list("bottom", "bottom"), alpha = 1, height = unit(2, "line"),
           rot = 0, size = list(6,5), neg = T) +
 geom_step() +
 geom_vline(xintercept = c(-65, -200, -251, -367, -445), 
            linetype = "dashed", color = "gray") +
 scale_x_continuous(limits = c(-max(ts)-1, -200),
                    breaks = seq(-300, -200, by = 10),
                    labels = format_labels) +
 labs(title = "Synapsida Diversity trajectory",
      x = "Time (Ma)",
      y = "Number of lineages") +
 theme_classic() +
 theme(plot.margin = unit(c(2, 1, 1, 1), "cm"),
      plot.title = element_text(size = 30, face = "bold", hjust = 0.5, margin = margin(b = 30)),
       axis.title.x = element_text(size = 22, face = "bold", margin = margin(t = 30)),
       axis.title.y = element_text(size = 22, face = "bold", margin = margin(r = 26)),
       axis.text = element_text(size = 18, face = "bold"))

# Display plots in RStudio
grid.arrange(p2, ncol = 1)

# Save to PDF
pdf("C:\\Users\\SimoesLabAdmin\\Documents\\BDNN_Arielli\\synapsida\\mcmc_fixshift_predictors\\C_bdnn_minmax\\synapsida_ltt.pdf", width = 10, height = 10)
print(p2)
dev.off()