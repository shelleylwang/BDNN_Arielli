

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/synapsida/pyrate_mcmc_logs/Log_RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-202.15980177, -203.22606131000003,-204.29232085,-205.35858039,-206.42483993000002,-207.49109947,-208.55735901000003,-209.62361855,-210.68987809000004,-211.75613763,-212.82239717,-213.88865671000002,-214.95491625,-216.02117579000003,-217.08743533,-218.15369487000004,-219.21995441,-220.28621395,-221.35247349000002,-222.41873303,-223.48499257000003,-224.55125211,-225.61751165000004,-226.68377119000002,-227.75003073,-228.81629027000002,-229.88254981,-230.94880935000003,-232.01506889,-233.08132842999999,-234.14758797000002,-235.21384751,-236.28010705000003,-237.34636659,-238.41262613000004,-239.47888567,-240.54514521,-241.61140475000002,-242.67766429,-243.74392383000003,-244.81018337,-245.87644291000004,-246.94270245,-248.00896199,-249.07522153000002,-250.14148107,-251.20774061000003,-252.27400015,-253.34025969000004,-254.40651923000001,-255.47277877,-256.53903831,-257.60529785,-258.67155739000003,-259.73781693,-260.80407647,-261.87033601,-262.93659555,-264.00285509,-265.06911463,-266.13537417000003,-267.20163371,-268.26789325,-269.33415279,-270.40041233,-271.46667186999997,-272.53293141,-273.59919095000004,-274.66545049,-275.73171003,-276.79796957,-277.86422911,-278.93048865,-279.99674819,-281.06300773000004,-282.12926727,-283.19552681,-284.26178635,-285.32804589,-286.39430543,-287.46056497,-288.52682451000004,-289.59308405,-290.65934359,-291.72560313,-292.79186267,-293.85812221,-294.92438175,-295.99064129000004,-297.05690083,-298.12316037,-299.18941991,-300.25567945,-301.32193899,-302.38819853,-303.45445807000004,-304.52071761,-305.58697715,-306.65323669,-307.71949623)
rate=c(0.20822441559560245, 0.20794884723918333,0.21043817768754605,0.2119747725652627,0.21299936262242727,0.2132298442677995,0.20442402204162635,0.1271323669724832,0.10497321886138578,0.09605888183554884,0.09413482212510854,0.09344832041402634,0.09311239105946303,0.09302328766800749,0.09298587387152468,0.09300968811410232,0.09302091416486222,0.09309623597598732,0.09321566789360533,0.09334461299643511,0.09355492612320343,0.09375499136241822,0.09400846715341654,0.0943002046814388,0.09460226002812139,0.09471594311757343,0.0948100490682803,0.09496293536436173,0.09535243463288892,0.09631167124353968,0.0992047317627894,0.10881881069855559,0.12453156594280505,0.13161983957816162,0.13268605068383615,0.13388912825777777,0.13659523176435137,0.1468171365872526,0.18852880102629893,0.19618527320519352,0.20998210597746705,0.21763467026342348,0.29392579919740625,0.2862008953141919,0.21598636775076557,0.21369366027272796,0.21335833004618815,0.21282089179144026,0.19846268358623187,0.19494311800529496,0.19050180703004876,0.19058056836706663,0.19457858240206233,0.23150289450390493,0.30217054022738793,0.2626101989525242,0.25688343289623516,0.25845645576655485,0.3149331918053042,0.3924244355169111,0.3350396139109851,0.3115232011752863,0.1766070417902445,0.1561822735334894,0.15188026143705413,0.14967084176722895,0.14912624425674134,0.1485566465231813,0.14691278837037303,0.1462113223099859,0.14605557042325273,0.14597425262800007,0.14594275257895847,0.14592987940698865,0.14593708971935088,0.14598006441539413,0.14602707091400574,0.14604406846810386,0.1460375374325512,0.14603766034684185,0.14603561102616047,0.14603229700556214,0.14602791217694827,0.14602086893610833,0.1460076147251479,0.145990377487413,0.1459926814198269,0.14600949654956147,0.14604642031484316,0.14613665895679842,0.14644328666476603,0.14764786942403696,0.14924337643711233,0.15515554132896847,0.19177208037537014,0.6277015176299083,0.797083500529129,0.8249169564882464,0.8434821959839738,0.8444424658967868)
minHPD=c(0.07647106724071959, 0.07734142804423534,0.07942828986939562,0.07851966021047276,0.07809769160366754,0.07894676263026473,0.07274799504413572,0.048223503200615796,0.04049257426296967,0.03843835424369932,0.043297531482651336,0.04400217904443545,0.04394932070375,0.04467954446595121,0.04487904908841995,0.04514545711772151,0.04494700014326096,0.044807159323282435,0.04494700014326096,0.04494190654018587,0.044944757980208944,0.04553666781656226,0.04553666781656226,0.04486019594600744,0.045634049476286395,0.04538435927079513,0.045076464703735636,0.044798501892353564,0.04594020400781118,0.04487293195448113,0.042139381151221324,0.045628403251335756,0.06935921200752043,0.07631028731311111,0.07829939718829243,0.07891572188275385,0.078942017690489,0.08001408549409972,0.07903238209511816,0.0823954103680885,0.0886488083432593,0.08699415708545302,0.09774861254618802,0.12864142029923623,0.12042158152270561,0.12116530996282314,0.12041613034584629,0.12114978081850361,0.11190807292306057,0.11330774249538776,0.1064672759010882,0.1059390766809854,0.10047368366849263,0.13706416609727998,0.17131573266029895,0.1109549041443273,0.11147691475425714,0.1110357778242096,0.09657461988431283,0.21118074076295568,0.12066398077181711,0.11604891311368051,0.10367159804679568,0.10367805446336585,0.10133961684066378,0.09870882468999663,0.09768882263759544,0.09149789724363169,0.09922198011791841,0.10193754414935778,0.10253927801407205,0.10134148356465882,0.10159578284086826,0.1017293953451874,0.10175165734803149,0.10209840634284183,0.10229972444710254,0.10238461838553488,0.10239904810739098,0.10238461838553488,0.10236084702839353,0.10233085713482162,0.10229866004749863,0.1022167887256646,0.10209840634284183,0.10193754414935778,0.10170573320929505,0.10261333054740479,0.10251443230185399,0.10175165734803149,0.10123408346474325,0.09561025229526475,0.08956179300333189,0.09146747530344959,0.09915866576649017,0.10570295592324201,0.12823489960591872,0.3292412171621953,0.3381219399298795,0.34718292261865946)
maxHPD=c(0.3794781254648623, 0.37704756310050314,0.3767657104407643,0.37674561170789117,0.3793966358580818,0.3845966992472076,0.3869129592897176,0.3441177436921464,0.2709755091894728,0.15635063349181852,0.1465852879757538,0.14377450393943952,0.14209620427361466,0.14232118813697142,0.14209620427361466,0.14212850997184873,0.14176637057618988,0.14137569107019435,0.14137569107019435,0.14133521727840082,0.14137569107019435,0.14210911253116265,0.14236950095355863,0.14209620427361466,0.14323802698710938,0.14323802698710938,0.14328852926286736,0.1434165556914538,0.14555342175142355,0.14772138764423112,0.16029901143417066,0.223432804219348,0.25195883947324965,0.2519937957995243,0.25368055134618944,0.25436862518819064,0.2551746381829326,0.2628928710076454,0.32349298652810043,0.3334433375455118,0.36645500452837854,0.41195658290679216,1.4077230700370897,1.3760613895301992,0.36629965190462094,0.3502952081871137,0.34814382825986484,0.3480195653983722,0.2795960438429259,0.2733813355619992,0.2713082039909146,0.2715207340711895,0.2805759415710198,0.36808159149227565,0.7965847973011608,0.4038464274235254,0.3963891927414213,0.39685915167833535,0.5933835217753222,1.023169980958854,0.6219933884227894,0.5442434933405396,0.3992069423224342,0.3447554021979023,0.33240123346001216,0.3227185796188987,0.3162701699427049,0.29006693828835073,0.20895086879119984,0.20096895593210123,0.1999934446290643,0.19821389464761777,0.19821389464761777,0.19821389464761777,0.19806201537328122,0.1982074338169283,0.1982074338169283,0.19821389464761777,0.19821389464761777,0.19822523958335844,0.19822523958335844,0.19821389464761777,0.19821389464761777,0.19821389464761777,0.1982074338169283,0.1982325006347331,0.19821389464761777,0.19938007625384815,0.1996292224585705,0.19993310529523256,0.20254665115140952,0.22041487521381647,0.4459590151606513,0.6802496417411483,0.9527086662209635,1.1650730874449897,1.460066805337282,1.7068072146686428,1.69840726738352,1.7136491836899814)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-1.460992705689577, 0.2753146035728405), xlim = c(-308.252626,-201.626672), ylab = 'Log10 Speciation rate', xlab = 'Time',main='Speciation (combined_10_mcmc)' )
polygon(c(time, rev(time)), c(log10(maxHPD[remove_na]), rev(log10(minHPD[remove_na]))), col = alpha('#4c4cec',0.3), border = NA)
lines(time,log10(rate[remove_na]), col = '#4c4cec', lwd=2)
mids=c(-202.16518691919194, -203.24221675757576,-204.3192465959596,-205.39627643434343,-206.47330627272729,-207.5503361111111,-208.62736594949496,-209.7043957878788,-210.78142562626263,-211.85845546464648,-212.9354853030303,-214.01251514141416,-215.08954497979798,-216.16657481818183,-217.24360465656565,-218.3206344949495,-219.39766433333335,-220.47469417171718,-221.55172401010103,-222.62875384848485,-223.7057836868687,-224.78281352525252,-225.85984336363637,-226.9368732020202,-228.01390304040405,-229.0909328787879,-230.16796271717172,-231.24499255555557,-232.3220223939394,-233.39905223232324,-234.4760820707071,-235.55311190909092,-236.63014174747474,-237.7071715858586,-238.78420142424244,-239.86123126262626,-240.9382611010101,-242.01529093939394,-243.0923207777778,-244.16935061616164,-245.24638045454546,-246.32341029292928,-247.40044013131313,-248.47746996969698,-249.5544998080808,-250.63152964646466,-251.70855948484848,-252.78558932323233,-253.86261916161618,-254.939649,-256.0166788383838,-257.0937086767677,-258.1707385151515,-259.2477683535354,-260.3247981919192,-261.401828030303,-262.4788578686869,-263.5558877070707,-264.6329175454546,-265.7099473838384,-266.7869772222222,-267.86400706060607,-268.9410368989899,-270.0180667373737,-271.09509657575757,-272.1721264141414,-273.24915625252527,-274.3261860909091,-275.40321592929297,-276.48024576767676,-277.5572756060606,-278.63430544444446,-279.71133528282826,-280.7883651212121,-281.86539495959596,-282.9424247979798,-284.01945463636366,-285.0964844747475,-286.1735143131313,-287.25054415151516,-288.327573989899,-289.4046038282828,-290.48163366666665,-291.5586635050505,-292.63569334343435,-293.7127231818182,-294.78975302020206,-295.86678285858585,-296.9438126969697,-298.02084253535355,-299.09787237373735,-300.1749022121212,-301.25193205050505,-302.3289618888889,-303.40599172727275,-304.4830215656566,-305.5600514040404,-306.63708124242424,-307.7141110808081)
counts=c(0.00497752808988764, 0.009269662921348315,0.00649438202247191,0.006078651685393259,0.009696629213483146,0.035764044943820225,0.21756179775280898,0.2286741573033708,0.10725842696629213,0.02295505617977528,0.010775280898876404,0.0054943820224719105,0.0029213483146067415,0.0024269662921348315,0.0019438202247191011,0.00149438202247191,0.0018764044943820224,0.0021797752808988763,0.002707865168539326,0.0034831460674157304,0.0033932584269662923,0.0036853932584269664,0.00401123595505618,0.0035393258426966293,0.002292134831460674,0.0024719101123595504,0.002752808988764045,0.006910112359550562,0.016876404494382023,0.05456179775280899,0.15403370786516854,0.1566067415730337,0.030235955056179774,0.007224719101123596,0.010449438202247191,0.02744943820224719,0.07806741573033708,0.11008988764044944,0.028707865168539327,0.059,0.05559550561797753,0.45310112359550564,0.4577752808988764,0.07373033707865169,0.0089438202247191,0.0039213483146067415,0.05056179775280899,0.07147191011235955,0.014202247191011236,0.023235955056179775,0.008269662921348314,0.1118876404494382,0.3395168539325843,0.15696629213483146,0.1231685393258427,0.00701123595505618,0.05256179775280899,0.43774157303370786,0.15886516853932584,0.12640449438202248,0.21130337078651684,0.2621348314606742,0.10273033707865169,0.05010112359550562,0.021067415730337078,0.011674157303370786,0.037168539325842694,0.029640449438202248,0.00698876404494382,0.003056179775280899,0.0017640449438202247,0.0010786516853932583,0.0008988764044943821,0.001292134831460674,0.0017640449438202247,0.0008988764044943821,0.000651685393258427,0.0007191011235955057,0.0006179775280898876,0.0008876404494382022,0.0007303370786516854,0.0009101123595505618,0.0008988764044943821,0.001056179775280899,0.0010674157303370787,0.0010112359550561798,0.0012808988764044945,0.003089887640449438,0.006853932584269663,0.027303370786516856,0.04086516853932584,0.09879775280898877,0.2728202247191011,0.25620224719101126,0.2578426966292135,0.04562921348314607,0.030101123595505618,0.005719101123595505,0.004438202247191011)
plot(mids,counts,type = 'h', xlim = c(-308.252626,-201.626672), ylim=c(0,0.4577752808988764), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03412682688815857
bf6 = 0.20702555632585987
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-202.15980177, -203.22606131000003,-204.29232085,-205.35858039,-206.42483993000002,-207.49109947,-208.55735901000003,-209.62361855,-210.68987809000004,-211.75613763,-212.82239717,-213.88865671000002,-214.95491625,-216.02117579000003,-217.08743533,-218.15369487000004,-219.21995441,-220.28621395,-221.35247349000002,-222.41873303,-223.48499257000003,-224.55125211,-225.61751165000004,-226.68377119000002,-227.75003073,-228.81629027000002,-229.88254981,-230.94880935000003,-232.01506889,-233.08132842999999,-234.14758797000002,-235.21384751,-236.28010705000003,-237.34636659,-238.41262613000004,-239.47888567,-240.54514521,-241.61140475000002,-242.67766429,-243.74392383000003,-244.81018337,-245.87644291000004,-246.94270245,-248.00896199,-249.07522153000002,-250.14148107,-251.20774061000003,-252.27400015,-253.34025969000004,-254.40651923000001,-255.47277877,-256.53903831,-257.60529785,-258.67155739000003,-259.73781693,-260.80407647,-261.87033601,-262.93659555,-264.00285509,-265.06911463,-266.13537417000003,-267.20163371,-268.26789325,-269.33415279,-270.40041233,-271.46667186999997,-272.53293141,-273.59919095000004,-274.66545049,-275.73171003,-276.79796957,-277.86422911,-278.93048865,-279.99674819,-281.06300773000004,-282.12926727,-283.19552681,-284.26178635,-285.32804589,-286.39430543,-287.46056497,-288.52682451000004,-289.59308405,-290.65934359,-291.72560313,-292.79186267,-293.85812221,-294.92438175,-295.99064129000004,-297.05690083,-298.12316037,-299.18941991,-300.25567945,-301.32193899,-302.38819853,-303.45445807000004,-304.52071761,-305.58697715,-306.65323669,-307.71949623)
rate=c(1.3733602651484413, 0.31317570208381135,0.29227898891111015,0.28732186282753935,0.28603879398455045,0.2833609213829868,0.2752992071993966,0.2029692962213125,0.11245842728023328,0.1044722710052884,0.1021783053084249,0.10147489461056183,0.10120960001120002,0.10109249393924422,0.10106220088059417,0.10105780801991723,0.10108724034009343,0.10111873246531067,0.10119163700158991,0.10125244031015429,0.10131800409659562,0.10140388441446624,0.10155233145060141,0.10173232272701145,0.10186414999726426,0.10189209552970138,0.10189582208132235,0.10188861410056269,0.10189357088456787,0.10189599921409061,0.10190302521678973,0.1019152149372601,0.10193685471746473,0.10202929677226158,0.1024554236736142,0.10303123426875871,0.10440965202644978,0.11433832237607694,0.30601153751082183,0.30551094596819356,0.30518413434702263,0.30530552573158837,0.3061846901407234,0.3074591765963193,0.3076579323118175,0.30824221670511,0.3151548048678289,0.3523144676480925,0.3486036155048795,0.3476691605912351,0.29013693798840157,0.2701842383913504,0.2685093459092474,0.2682556833598118,0.28051159525388203,0.2825494867800186,0.20387353506072142,0.17694985403137117,0.17529038141337017,0.1740643864548261,0.16300835129085658,0.147596311029287,0.13810963174324178,0.13286075155589705,0.13000050139454222,0.12915910019047822,0.1288264308877717,0.12857299133306727,0.12826431686554635,0.12808521365790093,0.12798558286800688,0.12789903329785318,0.1278857567897811,0.1278857567897811,0.12792405174815996,0.1280504435945074,0.12823367717960368,0.1285928018417735,0.12925709285348114,0.1296574774516585,0.12980507777024797,0.12983328464699506,0.12984782011212295,0.12984578851604672,0.12985317045553016,0.12988103602643702,0.12992290893469288,0.13001246225147917,0.13015778317670318,0.13040697218840305,0.13092622818309035,0.13208741678193203,0.13428954294820872,0.13953686422945843,0.1449072446119038,0.17066686442516113,0.25319352122491545,0.2766663925441649,0.29960750060303915,0.3180233514740322)
minHPD=c(0.08348190308680896, 0.07418134442449709,0.08435717385455181,0.08290348427312284,0.08435717385455181,0.08424498806653555,0.08237222582971511,0.07160426208082275,0.06333759320716403,0.056753445216706354,0.05753424662583165,0.06338366431841279,0.06510385346659354,0.06514784094174905,0.06517028043907008,0.065175943660362,0.06510110720956809,0.06538734521238072,0.06516603168919358,0.06538734521238072,0.06734119586520412,0.06775386137193883,0.06747258422425419,0.06781145954411807,0.06780421195462585,0.06774509795910805,0.06771447795240376,0.0677549651107355,0.06777089937588204,0.06781091375094567,0.06775386137193883,0.06772528748593573,0.06777492084156415,0.06702361689027718,0.06328410753289487,0.05676499057102368,0.06153874131501344,0.06518718786189116,0.17379380010964263,0.19574548850587145,0.19701107294928213,0.19633526022869535,0.1969930754458109,0.20034528448319178,0.19994484249802258,0.19583465435043124,0.18831931972889063,0.2488748274698861,0.2488748274698861,0.24904000559393136,0.1600491631692837,0.1670787791418098,0.16710931710211208,0.1674306327621449,0.13713695990095692,0.115661355435052,0.11059407406163722,0.1087129745214534,0.10850846591200938,0.1087129745214534,0.10316358013955843,0.08588077973946023,0.07691593796860781,0.07615756395106608,0.07414330989974992,0.07616995630519385,0.07614856198168524,0.0758013124756407,0.07615756395106608,0.07617054988573527,0.07569118984518579,0.07608995649233559,0.07616735136221806,0.07615524190779326,0.0758013124756407,0.07616735136221806,0.07690732871680642,0.07760927701112003,0.07845921525849751,0.07848700884614765,0.07862790844665803,0.07862790844665803,0.07862790844665803,0.0785199913341012,0.07850586130324616,0.07851807586902577,0.07838087112116413,0.07848539144050923,0.07804637217511204,0.07802226192161298,0.07851807586902577,0.07559940189269528,0.06945772960414688,0.07005667648191868,0.07259447150226625,0.0764984351621113,0.0865772103615584,0.08742231109698581,0.0869675041693303,0.08648396848453296)
maxHPD=c(4.014939362623382, 1.070621804044901,0.5464175659045217,0.5217370195477166,0.5191130138868459,0.5153197133408786,0.5065958171778698,0.46362751461062507,0.358819468747229,0.2549968161455283,0.1551126673899751,0.14485700916304978,0.14268765506746675,0.14119182683496756,0.1404809046942099,0.13994420635843569,0.1392968251667154,0.1392650078526743,0.13858825123743454,0.1384000858090142,0.13994245573842035,0.13998011703147709,0.13930356929760904,0.13945055535812065,0.1394519972274317,0.1394519972274317,0.13950610782218492,0.1396037337183584,0.13976965178861775,0.13998011703147709,0.14012178468546616,0.14048430484461963,0.14128837833132848,0.1424623770908766,0.14754957052471376,0.1811341575827861,0.27414443206782624,0.3382642957585694,0.45644163327688647,0.4413023386481748,0.43897750096351223,0.4366988013089301,0.4334238478396631,0.439200899862422,0.4412217933899372,0.44540157791131724,0.5658324989878132,0.7390666142116735,0.7099423537253728,0.7100154099123934,0.4174570970229181,0.35684850630614023,0.35575451733370156,0.3561206155928265,0.5044751319548264,0.7529206445306491,0.31740034574229237,0.30456788443274885,0.3039868570575799,0.30456575833817506,0.3016828592931036,0.286633294416808,0.24479285521218996,0.22509991369541085,0.20807090347523902,0.20565158842933873,0.2040606280068994,0.20241607736179532,0.20104513293055326,0.20020652717252171,0.19892690654453934,0.1987598272151543,0.19854459898202087,0.19837737776544173,0.19781316566315735,0.19766095146370447,0.19785901838116352,0.19785901838116352,0.19785520796007153,0.19768141415207505,0.19781316566315735,0.19780991277760296,0.19780991277760296,0.1977324938126152,0.19775206640860246,0.19781316566315735,0.19785520796007153,0.19833477490640944,0.19863737121207187,0.20009073922734258,0.2037802587921346,0.210274288658649,0.2508862138271963,0.38277024473137355,0.46510380574171506,0.6913422535900586,0.8612469701781429,0.8820722513756412,0.9397511175150899,1.0102617419079187)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-1.2917652600578224, 0.6450716757002162), xlim = c(-308.252626,-201.626672), ylab = 'Log10 Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(log10(maxHPD[remove_na]), rev(log10(minHPD[remove_na]))), col = alpha('#e34a33',0.3), border = NA)
lines(time,log10(rate[remove_na]), col = '#e34a33', lwd=2)
mids=c(-202.16518691919194, -203.24221675757576,-204.3192465959596,-205.39627643434343,-206.47330627272729,-207.5503361111111,-208.62736594949496,-209.7043957878788,-210.78142562626263,-211.85845546464648,-212.9354853030303,-214.01251514141416,-215.08954497979798,-216.16657481818183,-217.24360465656565,-218.3206344949495,-219.39766433333335,-220.47469417171718,-221.55172401010103,-222.62875384848485,-223.7057836868687,-224.78281352525252,-225.85984336363637,-226.9368732020202,-228.01390304040405,-229.0909328787879,-230.16796271717172,-231.24499255555557,-232.3220223939394,-233.39905223232324,-234.4760820707071,-235.55311190909092,-236.63014174747474,-237.7071715858586,-238.78420142424244,-239.86123126262626,-240.9382611010101,-242.01529093939394,-243.0923207777778,-244.16935061616164,-245.24638045454546,-246.32341029292928,-247.40044013131313,-248.47746996969698,-249.5544998080808,-250.63152964646466,-251.70855948484848,-252.78558932323233,-253.86261916161618,-254.939649,-256.0166788383838,-257.0937086767677,-258.1707385151515,-259.2477683535354,-260.3247981919192,-261.401828030303,-262.4788578686869,-263.5558877070707,-264.6329175454546,-265.7099473838384,-266.7869772222222,-267.86400706060607,-268.9410368989899,-270.0180667373737,-271.09509657575757,-272.1721264141414,-273.24915625252527,-274.3261860909091,-275.40321592929297,-276.48024576767676,-277.5572756060606,-278.63430544444446,-279.71133528282826,-280.7883651212121,-281.86539495959596,-282.9424247979798,-284.01945463636366,-285.0964844747475,-286.1735143131313,-287.25054415151516,-288.327573989899,-289.4046038282828,-290.48163366666665,-291.5586635050505,-292.63569334343435,-293.7127231818182,-294.78975302020206,-295.86678285858585,-296.9438126969697,-298.02084253535355,-299.09787237373735,-300.1749022121212,-301.25193205050505,-302.3289618888889,-303.40599172727275,-304.4830215656566,-305.5600514040404,-306.63708124242424,-307.7141110808081)
counts=c(0.5563595505617978, 0.08159550561797753,0.019898876404494382,0.007797752808988764,0.01250561797752809,0.03295505617977528,0.19857303370786517,0.2884157303370786,0.1458988764044944,0.05551685393258427,0.01849438202247191,0.008460674157303371,0.004247191011235955,0.002640449438202247,0.0022134831460674156,0.002292134831460674,0.001966292134831461,0.0026741573033707863,0.0025280898876404493,0.0026292134831460675,0.003146067415730337,0.003786516853932584,0.0047640449438202245,0.003292134831460674,0.0011910112359550561,0.0014269662921348315,0.001303370786516854,0.0010898876404494382,0.0011123595505617978,0.001247191011235955,0.001898876404494382,0.0029775280898876404,0.008404494382022471,0.02035955056179775,0.0291123595505618,0.08769662921348315,0.4670337078651685,0.3637303370786517,0.01746067415730337,0.004179775280898876,0.0043370786516853934,0.014606741573033709,0.007719101123595505,0.005213483146067416,0.02038202247191011,0.1639887640449438,0.13637078651685394,0.027853932584269662,0.041314606741573036,0.4226292134831461,0.026337078651685393,0.004573033707865168,0.0037415730337078653,0.15947191011235956,0.33646067415730335,0.1832696629213483,0.017089887640449438,0.004595505617977528,0.02004494382022472,0.11041573033707865,0.12447191011235956,0.082,0.05056179775280899,0.02048314606741573,0.0073258426966292135,0.004730337078651685,0.006584269662921348,0.0043370786516853934,0.002842696629213483,0.0025393258426966293,0.0016741573033707865,0.0011123595505617978,0.001,0.002112359550561798,0.003258426966292135,0.004943820224719101,0.009797752808988765,0.0064831460674157305,0.003853932584269663,0.0011797752808988763,0.001247191011235955,0.001101123595505618,0.0008089887640449438,0.0012359550561797752,0.0013370786516853932,0.0020674157303370785,0.002730337078651685,0.004808988764044944,0.008707865168539325,0.01749438202247191,0.03204494382022472,0.07310112359550562,0.06498876404494382,0.18792134831460675,0.14759550561797752,0.024112359550561797,0.02407865168539326,0.022932584269662923,0.009584269662921347)
plot(mids,counts,type = 'h', xlim = c(-308.252626,-201.626672), ylim=c(0,0.5563595505617978), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-202.15980177, -203.22606131000003,-204.29232085,-205.35858039,-206.42483993000002,-207.49109947,-208.55735901000003,-209.62361855,-210.68987809000004,-211.75613763,-212.82239717,-213.88865671000002,-214.95491625,-216.02117579000003,-217.08743533,-218.15369487000004,-219.21995441,-220.28621395,-221.35247349000002,-222.41873303,-223.48499257000003,-224.55125211,-225.61751165000004,-226.68377119000002,-227.75003073,-228.81629027000002,-229.88254981,-230.94880935000003,-232.01506889,-233.08132842999999,-234.14758797000002,-235.21384751,-236.28010705000003,-237.34636659,-238.41262613000004,-239.47888567,-240.54514521,-241.61140475000002,-242.67766429,-243.74392383000003,-244.81018337,-245.87644291000004,-246.94270245,-248.00896199,-249.07522153000002,-250.14148107,-251.20774061000003,-252.27400015,-253.34025969000004,-254.40651923000001,-255.47277877,-256.53903831,-257.60529785,-258.67155739000003,-259.73781693,-260.80407647,-261.87033601,-262.93659555,-264.00285509,-265.06911463,-266.13537417000003,-267.20163371,-268.26789325,-269.33415279,-270.40041233,-271.46667186999997,-272.53293141,-273.59919095000004,-274.66545049,-275.73171003,-276.79796957,-277.86422911,-278.93048865,-279.99674819,-281.06300773000004,-282.12926727,-283.19552681,-284.26178635,-285.32804589,-286.39430543,-287.46056497,-288.52682451000004,-289.59308405,-290.65934359,-291.72560313,-292.79186267,-293.85812221,-294.92438175,-295.99064129000004,-297.05690083,-298.12316037,-299.18941991,-300.25567945,-301.32193899,-302.38819853,-303.45445807000004,-304.52071761,-305.58697715,-306.65323669,-307.71949623)
net_rate=c(-1.388320620345621, -0.1742325474649994,-0.08843349995708852,-0.07679931993993869,-0.07343249358256904,-0.06914686168298917,-0.0659280922075148,-0.05836008185006215,-0.032053009909648614,-0.01812978205241605,-0.011396632606823913,-0.009685636549325432,-0.009102651283220511,-0.008821608700497955,-0.008748066098325697,-0.008733347748443095,-0.008793542231872658,-0.008789256638968922,-0.008838353849271976,-0.008869196413128144,-0.008775958718305787,-0.00875448675342776,-0.008784996903909346,-0.00886143364344881,-0.008908284815613652,-0.0088378318933798,-0.008730818535796728,-0.008588869904438419,-0.008253641125040179,-0.007101159834508494,-0.0028545194877376365,0.01355494330347943,0.03946891764806921,0.047226975886493064,0.04542670889444,0.0425635728624341,0.035316026074443535,-0.0015597463982900545,-0.11987331552475675,-0.11155516745710099,-0.09549871380078487,-0.08028399700574744,0.22103980707470416,0.21330483286926719,-0.08691735415310588,-0.09358376610322541,-0.11671705796437161,-0.21002248858723976,-0.21691473375646766,-0.21969656778897764,-0.09847048641298373,-0.07477094842744163,-0.06948263153696732,-0.01980675309597872,0.055366719171528724,-0.04397788441512196,0.058381442048065696,0.07421125992724963,0.13620265271339638,0.30621545772360215,0.16571528475307157,0.13885746867538623,0.07686837676436953,0.044919775265077524,0.03766111097921861,0.03231003952274606,0.0306841946388174,0.028458110254110033,0.021673222407087057,0.01881267338401157,0.01849715870383174,0.018420261196375288,0.018354816595208216,0.018327475751721344,0.018300445135057675,0.018220241503117383,0.01806130436208438,0.01748441570464351,0.016363802584874753,0.01571835107531839,0.015495988448083605,0.015453283181310116,0.015426264805320588,0.015417977774485872,0.015375237224612514,0.01529527839751468,0.01521239519380127,0.01511052649227484,0.014927481199998888,0.014913611085847977,0.015381759995423934,0.021715767544605698,0.029970898340701,0.0650539859932292,0.21179296532688663,0.3225757849478962,0.4785549238946002,0.5194497325023503,0.5426075528698715,0.5193656456431456)
net_minHPD=c(-3.8515200918017922, -0.8915957405631061,-0.37754265241300505,-0.34241177357425845,-0.33847479142216946,-0.34058913956859593,-0.3434286846623875,-0.35902132831520034,-0.2898309463950841,-0.21134608900227542,-0.07529054454501069,-0.06382043394031109,-0.060839050235376974,-0.05974988389672961,-0.05929510837672573,-0.05856500764152125,-0.058562452705076415,-0.05863843991287647,-0.05749455128174008,-0.05831462340371406,-0.057661021400324246,-0.05792035249209103,-0.05723948231863241,-0.05749455128174008,-0.05748940644080119,-0.05748940644080119,-0.05843076483450296,-0.05831462340371406,-0.059713064954705616,-0.06042656805617598,-0.06656368217601258,-0.059347844837339604,-0.04464333757765246,-0.03954296938157306,-0.044083382740765356,-0.05788615335343526,-0.1471733597418827,-0.20872594845769876,-0.28189229427929197,-0.26880311584864347,-0.2682656680944005,-0.2816841935903804,-0.26580040845354624,-0.2552608727433272,-0.2862514574348247,-0.2856564969555109,-0.35971195667340927,-0.5268634759155268,-0.5349853790977399,-0.5420514481956638,-0.25178545602252467,-0.1784335154326482,-0.17340955805855734,-0.15793821722179643,-0.18310177188250165,-0.6149530949082597,-0.09140575180321225,-0.07762829435423999,-0.08935153207616578,0.004804208249318875,-0.1587132695642204,-0.13191716505209072,-0.11450910062262525,-0.08526397788787156,-0.04865446419792527,-0.04450939415346189,-0.04890060959606943,-0.05190099297552414,-0.05722403784232119,-0.05293690269979004,-0.05229559463677541,-0.052299077773861474,-0.052014522893030296,-0.052299077773861474,-0.050080890547342605,-0.05063505767156137,-0.04962336579412677,-0.050706041734161114,-0.052299077773861474,-0.05299382354120208,-0.05299382354120208,-0.0531116814197303,-0.053193577201820136,-0.05321530907291766,-0.053017355772551844,-0.05301872258629961,-0.05417134432001908,-0.055017849281908726,-0.057089174103106044,-0.05806074230498079,-0.06571925497649919,-0.13633892372809295,-0.18586031331442215,-0.27203264666275706,-0.2568254675088121,-0.293375886039136,-0.25594040479028424,-0.267322418464492,-0.3159803777765853,-0.3912613044208799)
net_maxHPD=c(0.12735331968851366, 0.17995870182735368,0.13959294617423693,0.13630584621326444,0.13960013944031596,0.1436911301916031,0.1567906258736779,0.19230296757274648,0.14950634471404298,0.08198388439071723,0.06797794615207409,0.04999979097839645,0.04632897649731335,0.04487183241881487,0.04392408763140909,0.04379778579568761,0.043205874447672835,0.042645599792211344,0.043212873252891484,0.04205445517945677,0.042634998459604584,0.04232310029819021,0.0431328749829817,0.04317715040963577,0.04353046001683546,0.043833512136732034,0.04324689817468533,0.04376502712328237,0.04393831695535305,0.048322795079494746,0.066125074125271,0.13373184258646137,0.16273904589943022,0.16862890143684273,0.17387479179569404,0.1877139025525939,0.17939174326488316,0.1795762634095275,0.08074866944797354,0.07917364076980032,0.12418781799661821,0.17335806858361735,1.1128650200778454,1.08021231241412,0.12962983697485558,0.11661859865094851,0.11238559008110613,-0.0007512483096840938,-0.017573090924428436,-0.015184926810279442,0.0519136384877229,0.038491750711224265,0.048485220842671095,0.1559170852396919,0.6546380203298958,0.2035235416146741,0.20046607440371464,0.2088287787274613,0.4259746500923596,0.8378260055823703,0.4587843458639941,0.42166418736368777,0.2908555371743273,0.21081311990433874,0.1844974846920412,0.16002227583094641,0.14715774182357683,0.1370880121229673,0.09879989161063484,0.08849543502155244,0.08561992893699567,0.08420917574548845,0.08384040153009123,0.0832249231058292,0.08507201715122947,0.0837275035434861,0.08384040153009123,0.08190342398542937,0.07910869141564746,0.0779683878719318,0.0779683878719318,0.0779683878719318,0.07796673757862624,0.07796673757862624,0.07831469564220814,0.07864003986115987,0.07796350630116407,0.07796673757862624,0.07754104614480363,0.08076041754496352,0.0845072755978088,0.10484235120803392,0.37194144317225386,0.5980945158453106,0.8822949703360218,1.0680184261426549,1.2808370577954908,1.3809107274919212,1.5378135385845826,1.571203990302602)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-4.236672100981972, 1.7283243893328624), xlim = c(-308.252626,-201.626672), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-202.15980177, -203.22606131000003,-204.29232085,-205.35858039,-206.42483993000002,-207.49109947,-208.55735901000003,-209.62361855,-210.68987809000004,-211.75613763,-212.82239717,-213.88865671000002,-214.95491625,-216.02117579000003,-217.08743533,-218.15369487000004,-219.21995441,-220.28621395,-221.35247349000002,-222.41873303,-223.48499257000003,-224.55125211,-225.61751165000004,-226.68377119000002,-227.75003073,-228.81629027000002,-229.88254981,-230.94880935000003,-232.01506889,-233.08132842999999,-234.14758797000002,-235.21384751,-236.28010705000003,-237.34636659,-238.41262613000004,-239.47888567,-240.54514521,-241.61140475000002,-242.67766429,-243.74392383000003,-244.81018337,-245.87644291000004,-246.94270245,-248.00896199,-249.07522153000002,-250.14148107,-251.20774061000003,-252.27400015,-253.34025969000004,-254.40651923000001,-255.47277877,-256.53903831,-257.60529785,-258.67155739000003,-259.73781693,-260.80407647,-261.87033601,-262.93659555,-264.00285509,-265.06911463,-266.13537417000003,-267.20163371,-268.26789325,-269.33415279,-270.40041233,-271.46667186999997,-272.53293141,-273.59919095000004,-274.66545049,-275.73171003,-276.79796957,-277.86422911,-278.93048865,-279.99674819,-281.06300773000004,-282.12926727,-283.19552681,-284.26178635,-285.32804589,-286.39430543,-287.46056497,-288.52682451000004,-289.59308405,-290.65934359,-291.72560313,-292.79186267,-293.85812221,-294.92438175,-295.99064129000004,-297.05690083,-298.12316037,-299.18941991,-300.25567945,-301.32193899,-302.38819853,-303.45445807000004,-304.52071761,-305.58697715,-306.65323669,-307.71949623)
rate=c(0.6255682492005458, 2.6110261106604047,3.33924509003601,3.4560654728035827,3.4805446028447795,3.5190269549398936,3.623539874594157,4.439770432267821,6.626676934406815,8.590172461986276,9.434590024185937,9.699836771001856,9.800071028478975,9.839778851198268,9.852272484138776,9.854310867371495,9.847842469402218,9.842184808281477,9.82894316912319,9.816149415878847,9.80156482864005,9.78418572872367,9.75934988818696,9.726527609904494,9.696328185782628,9.691940594475772,9.693094387008758,9.693179248051019,9.689365202644376,9.686079398459434,9.682422872723405,9.672059442406562,9.652006108688237,9.593139457632239,9.35941775976341,9.036056117189114,8.315335276978095,6.054469244995401,3.2300366733476626,3.262574282141183,3.2735757582950966,3.2698421509274302,3.2482665283552965,3.2172234784962876,3.2123553123882074,3.19540381152546,2.979312595560564,2.3350430009254968,2.4073169976287456,2.4137273179504484,3.4699353221177316,3.780257552324516,3.7950236514765963,3.7970459880215266,3.446816521556812,3.1521791787688027,4.839630195678469,5.207041645604588,5.227336187937825,5.2373128154548745,5.447534161792405,6.104339708156443,6.785317208543086,7.231602409511329,7.499141304408251,7.58077660498038,7.611601464176502,7.638833785510277,7.67151499007855,7.68840235830872,7.700588064101052,7.70983091205625,7.711210231077514,7.710937638607872,7.70857927426725,7.69787734804067,7.681735449946832,7.646419480786933,7.581870062973003,7.544690064945205,7.532373908643517,7.530539528411565,7.529278410993708,7.530177191703235,7.5294401006914775,7.527059003390743,7.523126485777389,7.514623261218824,7.497871199372675,7.4677699938943976,7.396037235382655,7.228605979591562,6.8610062805831316,6.007912168396867,5.3136805983996265,3.659284506114882,2.82702558421529,2.738091587380462,2.5818220046420755,2.424258545191982)
minHPD=c(0.6255682492005458, 2.6110261106604047,3.33924509003601,3.4560654728035827,3.4805446028447795,3.5190269549398936,3.623539874594157,4.439770432267821,6.626676934406815,8.590172461986276,9.434590024185937,9.699836771001856,9.800071028478975,9.839778851198268,9.852272484138776,9.854310867371495,9.847842469402218,9.842184808281477,9.82894316912319,9.816149415878847,9.80156482864005,9.78418572872367,9.75934988818696,9.726527609904494,9.696328185782628,9.691940594475772,9.693094387008758,9.693179248051019,9.689365202644376,9.686079398459434,9.682422872723405,9.672059442406562,9.652006108688237,9.593139457632239,9.35941775976341,9.036056117189114,8.315335276978095,6.054469244995401,3.2300366733476626,3.262574282141183,3.2735757582950966,3.2698421509274302,3.2482665283552965,3.2172234784962876,3.2123553123882074,3.19540381152546,2.979312595560564,2.3350430009254968,2.4073169976287456,2.4137273179504484,3.4699353221177316,3.780257552324516,3.7950236514765963,3.7970459880215266,3.446816521556812,3.1521791787688027,4.839630195678469,5.207041645604588,5.227336187937825,5.2373128154548745,5.447534161792405,6.104339708156443,6.785317208543086,7.231602409511329,7.499141304408251,7.58077660498038,7.611601464176502,7.638833785510277,7.67151499007855,7.68840235830872,7.700588064101052,7.70983091205625,7.711210231077514,7.710937638607872,7.70857927426725,7.69787734804067,7.681735449946832,7.646419480786933,7.581870062973003,7.544690064945205,7.532373908643517,7.530539528411565,7.529278410993708,7.530177191703235,7.5294401006914775,7.527059003390743,7.523126485777389,7.514623261218824,7.497871199372675,7.4677699938943976,7.396037235382655,7.228605979591562,6.8610062805831316,6.007912168396867,5.3136805983996265,3.659284506114882,2.82702558421529,2.738091587380462,2.5818220046420755,2.424258545191982)
maxHPD=c(0.6255682492005458, 2.6110261106604047,3.33924509003601,3.4560654728035827,3.4805446028447795,3.5190269549398936,3.623539874594157,4.439770432267821,6.626676934406815,8.590172461986276,9.434590024185937,9.699836771001856,9.800071028478975,9.839778851198268,9.852272484138776,9.854310867371495,9.847842469402218,9.842184808281477,9.82894316912319,9.816149415878847,9.80156482864005,9.78418572872367,9.75934988818696,9.726527609904494,9.696328185782628,9.691940594475772,9.693094387008758,9.693179248051019,9.689365202644376,9.686079398459434,9.682422872723405,9.672059442406562,9.652006108688237,9.593139457632239,9.35941775976341,9.036056117189114,8.315335276978095,6.054469244995401,3.2300366733476626,3.262574282141183,3.2735757582950966,3.2698421509274302,3.2482665283552965,3.2172234784962876,3.2123553123882074,3.19540381152546,2.979312595560564,2.3350430009254968,2.4073169976287456,2.4137273179504484,3.4699353221177316,3.780257552324516,3.7950236514765963,3.7970459880215266,3.446816521556812,3.1521791787688027,4.839630195678469,5.207041645604588,5.227336187937825,5.2373128154548745,5.447534161792405,6.104339708156443,6.785317208543086,7.231602409511329,7.499141304408251,7.58077660498038,7.611601464176502,7.638833785510277,7.67151499007855,7.68840235830872,7.700588064101052,7.70983091205625,7.711210231077514,7.710937638607872,7.70857927426725,7.69787734804067,7.681735449946832,7.646419480786933,7.581870062973003,7.544690064945205,7.532373908643517,7.530539528411565,7.529278410993708,7.530177191703235,7.5294401006914775,7.527059003390743,7.523126485777389,7.514623261218824,7.497871199372675,7.4677699938943976,7.396037235382655,7.228605979591562,6.8610062805831316,6.007912168396867,5.3136805983996265,3.659284506114882,2.82702558421529,2.738091587380462,2.5818220046420755,2.424258545191982)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-0.24948279262354037, 1.0350189437115378), xlim = c(-308.252626,-201.626672), ylab = 'Log10 Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(log10(maxHPD[remove_na]), rev(log10(minHPD[remove_na]))), col = alpha('#756bb1',0.3), border = NA)
lines(time,log10(rate[remove_na]), col = '#756bb1', lwd=4)

n <- dev.off()