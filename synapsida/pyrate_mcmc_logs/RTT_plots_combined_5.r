

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/synapsida/pyrate_mcmc_logs/RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-202.160211345, -203.227290035,-204.29436872500003,-205.36144741500004,-206.428526105,-207.49560479500002,-208.56268348500004,-209.629762175,-210.696840865,-211.76391955500003,-212.830998245,-213.898076935,-214.96515562500002,-216.03223431500004,-217.099313005,-218.16639169500002,-219.23347038500003,-220.300549075,-221.367627765,-222.43470645500003,-223.50178514499999,-224.568863835,-225.63594252500002,-226.70302121500004,-227.770099905,-228.837178595,-229.90425728500003,-230.971335975,-232.038414665,-233.10549335500002,-234.17257204499998,-235.239650735,-236.30672942500001,-237.37380811500003,-238.440886805,-239.507965495,-240.57504418500002,-241.64212287499998,-242.709201565,-243.77628025500002,-244.84335894500003,-245.910437635,-246.977516325,-248.04459501500003,-249.111673705,-250.178752395,-251.24583108500002,-252.31290977499998,-253.379988465,-254.447067155,-255.51414584499997,-256.581224535,-257.648303225,-258.71538191499997,-259.782460605,-260.849539295,-261.916617985,-262.983696675,-264.050775365,-265.117854055,-266.18493274499997,-267.252011435,-268.319090125,-269.386168815,-270.453247505,-271.520326195,-272.58740488499996,-273.654483575,-274.721562265,-275.788640955,-276.855719645,-277.922798335,-278.989877025,-280.05695571499996,-281.124034405,-282.191113095,-283.258191785,-284.32527047499997,-285.392349165,-286.459427855,-287.52650654499996,-288.593585235,-289.660663925,-290.727742615,-291.79482130499997,-292.861899995,-293.928978685,-294.99605737499996,-296.063136065,-297.130214755,-298.197293445,-299.264372135,-300.331450825,-301.39852951499995,-302.46560820499997,-303.532686895,-304.599765585,-305.666844275,-306.733922965,-307.801001655)
rate=c(0.17666774724076062, 0.17674123643850081,0.17708802986051844,0.17758438167035726,0.17796646210585965,0.17781953728848654,0.1730233983870822,0.11994973153023042,0.08721931346139533,0.07882400709259205,0.07722075149903063,0.07639439041831658,0.07591265947626785,0.07565429137930238,0.07554114470584206,0.07551041322147116,0.07550710226496457,0.07551265342728594,0.07554114470584206,0.07555769475010146,0.0755726472446831,0.07561004380569186,0.07565791646914105,0.0757959159121369,0.07592170319558601,0.07603606166952223,0.07608694581635608,0.07616427128224408,0.07648680129425148,0.07782448831447092,0.08454294307910065,0.10616277227815274,0.16693462410541776,0.1746386202205336,0.17482142452901886,0.1753050814248254,0.17689145117700383,0.1829121729064025,0.19580778423540593,0.19732220939860018,0.19885277604260526,0.19996244444609407,0.2460143368927316,0.80442609494505,0.1749151779702795,0.17408905410438605,0.17401763275023374,0.17355177595003707,0.16580820472725677,0.16487734444617397,0.16371441680721563,0.16365435108406623,0.16497386918542933,0.2353810646181726,0.3370010941513274,0.3214199612569383,0.3179215067268658,0.3194708858098847,0.3376997488484725,0.3689057482164197,0.34087486944659284,0.32863755753449575,0.14997550800706205,0.14355441265321636,0.14301683239911317,0.14282521097811365,0.14268727545185222,0.1424880028288394,0.14188293299464297,0.1416173576591594,0.14155689532479326,0.14147749176623792,0.14143523231255722,0.14140622087929372,0.14139994360170471,0.14141426041709115,0.1414623246658041,0.14146880573798282,0.14145986735871485,0.14146521962092456,0.14145986735871485,0.14146521962092456,0.14147037590743033,0.14146880573798282,0.14145986735871485,0.1414372558020609,0.14142797665054035,0.14143523231255722,0.141497163334858,0.1416983957508506,0.14226901593614646,0.14384932414763163,0.1460938710567729,0.14920592887960027,0.18520142750755622,0.6667708425488909,0.7782425289461463,0.8009400932607909,0.808511589774177,0.8090952009923247)
minHPD=c(0.07071106736582841, 0.07134230155479579,0.0711281716035706,0.07274799504413572,0.0711281716035706,0.0701348196037728,0.0651638030407857,0.04221876245761192,0.03850718053682105,0.03845828469233687,0.04034742927779497,0.041473521383220094,0.04155057125180791,0.04231132955123513,0.042096704985668656,0.042847208408855295,0.04286321068222133,0.042096704985668656,0.042121439988839764,0.042096704985668656,0.042096704985668656,0.042096704985668656,0.042759792479065264,0.042421781018393175,0.04210705478189383,0.04168740963343775,0.041473521383220094,0.04210705478189383,0.04051963170856236,0.04013910124783668,0.04013910124783668,0.044798501892353564,0.06955698391912228,0.08136738190804145,0.08134883987048507,0.08127658265172229,0.082740245904345,0.08523806648693061,0.08797662504268201,0.09727011647122816,0.09270494041231486,0.09730922591817547,0.09882103730128047,0.1163141419916205,0.11091546332793824,0.11002895895191825,0.11091546332793824,0.10610888658827716,0.10947560655866516,0.1096605561510531,0.10947560655866516,0.10947560655866516,0.10456588801449004,0.13257307185017442,0.17131573266029895,0.11715984084216945,0.11686749748591672,0.11500399568975932,0.09931919675401832,0.2351575843493533,0.12069835762306305,0.11232300580538923,0.09743361309221027,0.09089873882333836,0.09289591264887942,0.09651895582239485,0.09646506901750626,0.10012418572436442,0.1011547457400862,0.10225590774696405,0.10156436255551364,0.10156436255551364,0.10149469328518305,0.10158103400704101,0.10194667724677324,0.1019074292693628,0.10210847154765926,0.10224423822013182,0.10224423822013182,0.10210847154765926,0.10210847154765926,0.10210847154765926,0.10194667724677324,0.1018935297479294,0.1018935297479294,0.10156436255551364,0.10156436255551364,0.10142609868766207,0.10136840737297988,0.10194667724677324,0.09965614430168285,0.08011915826004865,0.09676469566083891,0.09287415337516026,0.09815803665852195,0.10849805656155666,0.12851859521914266,0.3291996153478964,0.3291996153478964,0.32573231559977894)
maxHPD=c(0.3328871752436235, 0.3315090240174473,0.330132621070182,0.33156290586995335,0.33154951730514165,0.333114139516117,0.3330229609318389,0.30970298125928897,0.20419198340697714,0.13745094285841222,0.12994969897234762,0.1270698822803897,0.1254381828185663,0.12539797334463934,0.12478873575498063,0.12542317581201995,0.12539797334463934,0.12457036872531188,0.12452373823978248,0.12452373823978248,0.12451247025770197,0.12460000816931158,0.1254668354746259,0.1254381828185663,0.1254381828185663,0.1254381828185663,0.12551554001159487,0.12653406841560452,0.12703886135550682,0.13413374442341847,0.181121142850949,0.22176102858498897,0.2520307012887347,0.249922642408155,0.24926713930917554,0.24891531524799965,0.2511684924511564,0.25997518106809114,0.32372682345784687,0.33814746666700946,0.33820891682749304,0.35139351659722545,1.4935011014746626,1.550248725876076,0.3455335597604803,0.3316125481783977,0.3313841956660804,0.32418222620095133,0.25193990796352267,0.24728237259047578,0.2475680944794111,0.24776138405082526,0.25224411594419865,0.39023949555229687,0.7786757590044493,0.4090179913351679,0.4061771542010391,0.40633171395718193,0.5586071338832563,1.0585409024253185,0.5556105860172623,0.5208006108906688,0.37483564630529825,0.2868235960425218,0.22404417648472552,0.2125358393409729,0.2059042735554393,0.20546051630794918,0.1970832022596882,0.1950032385106354,0.19382352638426154,0.19371339841787444,0.1935046218100743,0.1935046218100743,0.19371041211542583,0.1935046218100743,0.19359389926315768,0.19371339841787444,0.19371339841787444,0.1935046218100743,0.1935046218100743,0.19359753341597286,0.1935046218100743,0.19359753341597286,0.19371339841787444,0.19344524781949443,0.19359753341597286,0.1935046218100743,0.19382352638426154,0.1960038023348586,0.1996898232238245,0.24405020297114424,0.4981396270112606,0.6097951474012951,0.9219935116141976,1.1995176920065256,1.3790141617994824,1.4990875396850605,1.4990875396850605,1.4984333945525399)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.7052735984636838), xlim = c(-308.334541,-201.626672), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_5_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-202.16560063131314, -203.24345789393942,-204.32131515656567,-205.39917241919193,-206.4770296818182,-207.55488694444446,-208.63274420707071,-209.710601469697,-210.78845873232325,-211.8663159949495,-212.94417325757578,-214.02203052020204,-215.0998877828283,-216.17774504545457,-217.25560230808082,-218.33345957070708,-219.41131683333336,-220.4891740959596,-221.56703135858587,-222.64488862121215,-223.7227458838384,-224.80060314646465,-225.87846040909093,-226.9563176717172,-228.03417493434344,-229.11203219696972,-230.18988945959597,-231.26774672222223,-232.3456039848485,-233.42346124747476,-234.50131851010104,-235.5791757727273,-236.65703303535355,-237.7348902979798,-238.81274756060608,-239.89060482323234,-240.96846208585862,-242.04631934848487,-243.12417661111112,-244.20203387373738,-245.27989113636366,-246.3577483989899,-247.4356056616162,-248.51346292424245,-249.5913201868687,-250.66917744949495,-251.74703471212123,-252.8248919747475,-253.90274923737377,-254.98060650000002,-256.0584637626263,-257.1363210252525,-258.2141782878788,-259.2920355505051,-260.36989281313134,-261.4477500757576,-262.52560733838385,-263.6034646010101,-264.68132186363636,-265.7591791262626,-266.8370363888889,-267.9148936515152,-268.9927509141414,-270.0706081767677,-271.148465439394,-272.22632270202024,-273.3041799646465,-274.38203722727275,-275.459894489899,-276.53775175252525,-277.6156090151515,-278.69346627777776,-279.77132354040407,-280.8491808030303,-281.9270380656566,-283.0048953282828,-284.08275259090914,-285.1606098535354,-286.23846711616164,-287.3163243787879,-288.39418164141415,-289.4720389040404,-290.54989616666666,-291.6277534292929,-292.7056106919192,-293.7834679545455,-294.8613252171717,-295.939182479798,-297.0170397424243,-298.09489700505054,-299.1727542676768,-300.25061153030305,-301.3284687929293,-302.40632605555555,-303.4841833181818,-304.56204058080806,-305.63989784343437,-306.7177551060606,-307.7956123686869)
counts=c(0.0032546786004882017, 0.0035937076213723895,0.00413615405478709,0.00413615405478709,0.006441551396799566,0.022782750203417412,0.1840927583401139,0.295497694602658,0.08157038242473556,0.02115541090317331,0.012544073772714945,0.007119609438567941,0.0043395714673176026,0.0025766205587198264,0.0011526986710062382,0.0010848928668294006,0.000881475454298888,0.0014239218877135883,0.0010848928668294006,0.0010848928668294006,0.0011526986710062382,0.0021697857336588013,0.0023732031461893136,0.001762950908597776,0.0021697857336588013,0.001762950908597776,0.0027122321670735015,0.010848928668294006,0.030919446704637917,0.11445619745050176,0.26790073230268513,0.22369134797938703,0.021833468944941686,0.00440737727149444,0.0067805804176837535,0.020545158665581775,0.07648494711147275,0.0892324382967182,0.011662598318416057,0.01125576349335503,0.020002712232167073,0.7398291293734743,0.700366151342555,0.06841605641442908,0.005221046921616491,0.0031868727963113644,0.04156495796040141,0.05946569026308652,0.00854353132628153,0.011120151885001357,0.005492270138323841,0.212435584486032,0.4294141578519121,0.14225657716300516,0.14117168429617574,0.005424464334147003,0.04834553837808516,0.33590995389205314,0.17344724708435041,0.11276105234608083,0.35055600759425004,0.29922701383238404,0.032343368592351505,0.008882560347165717,0.006373745592622729,0.004271765663140765,0.01871440195280716,0.01240846216436127,0.0025088147545429887,0.001898562516951451,0.0018307567127746134,0.0016273393002441008,0.0014239218877135883,0.0011526986710062382,0.0012205044751830757,0.00047464062923786274,0.0006780580417683754,0.0006102522375915378,0.00047464062923786274,0.000881475454298888,0.0008136696501220504,0.0008136696501220504,0.0010848928668294006,0.0008136696501220504,0.0006102522375915378,0.0006780580417683754,0.0012205044751830757,0.0043395714673176026,0.01186601573094657,0.03220775698399783,0.05912666124220233,0.06468673718470301,0.2698671006238134,0.34947111472742065,0.19019528071602929,0.034919989151071334,0.017222674260916733,0.005017629509085977,0.004610794684024953)
plot(mids,counts,type = 'h', xlim = c(-308.334541,-201.626672), ylim=c(0,0.7398291293734743), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.034401756898766796
bf6 = 0.2083928551434427
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-202.160211345, -203.227290035,-204.29436872500003,-205.36144741500004,-206.428526105,-207.49560479500002,-208.56268348500004,-209.629762175,-210.696840865,-211.76391955500003,-212.830998245,-213.898076935,-214.96515562500002,-216.03223431500004,-217.099313005,-218.16639169500002,-219.23347038500003,-220.300549075,-221.367627765,-222.43470645500003,-223.50178514499999,-224.568863835,-225.63594252500002,-226.70302121500004,-227.770099905,-228.837178595,-229.90425728500003,-230.971335975,-232.038414665,-233.10549335500002,-234.17257204499998,-235.239650735,-236.30672942500001,-237.37380811500003,-238.440886805,-239.507965495,-240.57504418500002,-241.64212287499998,-242.709201565,-243.77628025500002,-244.84335894500003,-245.910437635,-246.977516325,-248.04459501500003,-249.111673705,-250.178752395,-251.24583108500002,-252.31290977499998,-253.379988465,-254.447067155,-255.51414584499997,-256.581224535,-257.648303225,-258.71538191499997,-259.782460605,-260.849539295,-261.916617985,-262.983696675,-264.050775365,-265.117854055,-266.18493274499997,-267.252011435,-268.319090125,-269.386168815,-270.453247505,-271.520326195,-272.58740488499996,-273.654483575,-274.721562265,-275.788640955,-276.855719645,-277.922798335,-278.989877025,-280.05695571499996,-281.124034405,-282.191113095,-283.258191785,-284.32527047499997,-285.392349165,-286.459427855,-287.52650654499996,-288.593585235,-289.660663925,-290.727742615,-291.79482130499997,-292.861899995,-293.928978685,-294.99605737499996,-296.063136065,-297.130214755,-298.197293445,-299.264372135,-300.331450825,-301.39852951499995,-302.46560820499997,-303.532686895,-304.599765585,-305.666844275,-306.733922965,-307.801001655)
rate=c(2.2632924907990795, 0.24004699285843262,0.23514953330438754,0.23330397417512572,0.2332482434538818,0.23280092877363645,0.23122323405878842,0.1978813111949989,0.10412321128803867,0.09477274025470225,0.09135018723023833,0.09038695405436323,0.09014803430023846,0.09007870217040098,0.090070517570771,0.09012883681143663,0.0903029876725152,0.09032381183470609,0.090340656726749,0.09037966757020136,0.09039586446760489,0.09044069162485706,0.09059387195248159,0.09074700571917338,0.09087867460271365,0.09088098829228461,0.09086369067934064,0.09083066117269148,0.09082864620361897,0.09080807667442575,0.09080430379452184,0.0908008562716383,0.0908008562716383,0.09083066117269148,0.09102774638139921,0.09135018723023833,0.09250041472962664,0.11358597772020715,0.3322210697111886,0.33135907841553947,0.3304999081135882,0.3306247698256629,0.3320900525001117,0.33545250554996014,0.33671036006197796,0.3387890620377561,0.3553100111620751,0.39575983573585444,0.3955440170245843,0.39577997325047687,0.24922024250273322,0.23398034160747572,0.2336584099090753,0.23363486907072395,0.24089998840346497,0.23988909565523756,0.21643210930077067,0.214902818066416,0.21460163767734652,0.2135051844814976,0.1851774987304916,0.13901437417179263,0.12974417820171846,0.12533839934626667,0.12041952269820846,0.1192086571899976,0.11878616912879272,0.11822713950490173,0.1177642161272332,0.11752698421640032,0.11743099491664785,0.11734876619478612,0.11733626902430713,0.11732653131597826,0.11734980264625752,0.11740838676677974,0.11745660138329149,0.11756885530745072,0.1176576810830326,0.11769770825193704,0.11771367099123016,0.11772674258929619,0.11773923636355048,0.11773923636355048,0.11774925279701227,0.1177762890416397,0.11778935811629727,0.11787558774211548,0.11806992091724106,0.11836340626377906,0.11888697703383572,0.12084087762260091,0.12179166871173258,0.12516105435077735,0.13009232604223023,0.14856865204839909,0.2581874455583298,0.2798932422588365,0.28901462328669647,0.30139809384916344)
minHPD=c(0.08754957503335413, 0.07043613450681918,0.0780200501119951,0.08004244890722755,0.07974278566890985,0.07857114467194111,0.0775356886696532,0.06537263627711279,0.05987556752387625,0.05504458578989706,0.04951368750937586,0.057636911350368566,0.05834998043103428,0.059793566477226216,0.05985371308480974,0.05985371308480974,0.05997738053568147,0.060076589370422435,0.06111260790642597,0.06122460806335175,0.06111260790642597,0.06122460806335175,0.06111260790642597,0.06122460806335175,0.061591687790455846,0.06153874131501344,0.06157849967183206,0.06157849967183206,0.06157849967183206,0.06157849967183206,0.06157849967183206,0.06157849967183206,0.06157849967183206,0.06122460806335175,0.060076589370422435,0.05805152200696303,0.05492736372730668,0.06090128737125755,0.20477115252074043,0.21992233271179693,0.21181495481627935,0.21892875002061463,0.21902801218247656,0.21896525967289582,0.2166874737248441,0.2067530729916153,0.22046468323855628,0.2551451788629395,0.25591581648412703,0.2586045507257508,0.15931622544362295,0.16344850146745538,0.1633664164502518,0.1633664164502518,0.16035887059579765,0.1223070559758078,0.10973205354565048,0.1092696407308377,0.1092696407308377,0.1061362746237102,0.09113375060817853,0.08498654669770989,0.08197458519610917,0.0787623169685589,0.07687585055634223,0.07670521308150076,0.07515374130646507,0.0751220149971461,0.07278174573952632,0.07507630663910313,0.07507630663910313,0.07521350906588474,0.0751220149971461,0.0751220149971461,0.07507630663910313,0.07363786078812065,0.07512863431685465,0.07519602108825928,0.07507630663910313,0.07515374130646507,0.07519602108825928,0.07519602108825928,0.07519602108825928,0.07521350906588474,0.07507630663910313,0.0751220149971461,0.07363786078812065,0.07515374130646507,0.07515374130646507,0.07389758937645931,0.07543654208753817,0.0726214617228784,0.06947856053758693,0.06917142051290454,0.06985794419850512,0.06746275080215029,0.07831769984569618,0.07886098766319195,0.07886098766319195,0.07828585059421106)
maxHPD=c(4.828158582961646, 0.5103217656739194,0.3961023980470675,0.38760618022297894,0.38760618022297894,0.3865589000475929,0.3875330648929887,0.36781683327660547,0.3030218588201454,0.25109197587978044,0.16275131275720084,0.13539583530266774,0.13115964179093936,0.13115964179093936,0.13024922568964822,0.12882381250127736,0.12740978176882375,0.12710878339625598,0.12785154519551276,0.1277184132117558,0.12739235212293215,0.12740347940153382,0.12696176890501562,0.1269483332491819,0.12725637612144242,0.1271173812840823,0.12704044644654924,0.12700146623356884,0.1269483332491819,0.12696176890501562,0.12696176890501562,0.12704044644654924,0.12725637612144242,0.12743136573867617,0.12933449297460936,0.13539583530266774,0.24446173594114745,0.40205003494503333,0.46354722085442573,0.4608820598371502,0.4510136573040708,0.457281484768758,0.45712774842507997,0.4633575812942039,0.46622839477984557,0.46642837756516387,0.57069635031427,0.6834407192661559,0.6673332271899487,0.6730381756760122,0.4321575187195939,0.347581453048406,0.345670212213239,0.34590358344323224,0.6662257443434323,0.730401748125354,0.2879760110489259,0.2829453650824332,0.2826983272663021,0.28040869641236027,0.2679725684370479,0.2469333460577349,0.23652727464481427,0.22695991647853173,0.2069950882900552,0.1986617854326753,0.1941494357403074,0.18870005121897676,0.18142852797037937,0.1815445315518116,0.18081182400190787,0.18057396616417268,0.18043805726714138,0.18043805726714138,0.18006257138295226,0.1781084519298659,0.17941933362294912,0.17899974529652365,0.17862816499334805,0.17862816499334805,0.17891408246632448,0.17891408246632448,0.1789493855095424,0.17899974529652365,0.1790238501286169,0.17941933362294912,0.1781084519298659,0.18012516291333142,0.1816072673542324,0.18320239955773782,0.18984412242267373,0.2109840887833091,0.2389081706632256,0.33532345977569333,0.4355014193653098,0.6274419138441739,0.8883009566800585,0.9119665605981263,0.9282410951292263,0.9577841053090598)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 5.3109744412578115), xlim = c(-308.334541,-201.626672), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-202.16560063131314, -203.24345789393942,-204.32131515656567,-205.39917241919193,-206.4770296818182,-207.55488694444446,-208.63274420707071,-209.710601469697,-210.78845873232325,-211.8663159949495,-212.94417325757578,-214.02203052020204,-215.0998877828283,-216.17774504545457,-217.25560230808082,-218.33345957070708,-219.41131683333336,-220.4891740959596,-221.56703135858587,-222.64488862121215,-223.7227458838384,-224.80060314646465,-225.87846040909093,-226.9563176717172,-228.03417493434344,-229.11203219696972,-230.18988945959597,-231.26774672222223,-232.3456039848485,-233.42346124747476,-234.50131851010104,-235.5791757727273,-236.65703303535355,-237.7348902979798,-238.81274756060608,-239.89060482323234,-240.96846208585862,-242.04631934848487,-243.12417661111112,-244.20203387373738,-245.27989113636366,-246.3577483989899,-247.4356056616162,-248.51346292424245,-249.5913201868687,-250.66917744949495,-251.74703471212123,-252.8248919747475,-253.90274923737377,-254.98060650000002,-256.0584637626263,-257.1363210252525,-258.2141782878788,-259.2920355505051,-260.36989281313134,-261.4477500757576,-262.52560733838385,-263.6034646010101,-264.68132186363636,-265.7591791262626,-266.8370363888889,-267.9148936515152,-268.9927509141414,-270.0706081767677,-271.148465439394,-272.22632270202024,-273.3041799646465,-274.38203722727275,-275.459894489899,-276.53775175252525,-277.6156090151515,-278.69346627777776,-279.77132354040407,-280.8491808030303,-281.9270380656566,-283.0048953282828,-284.08275259090914,-285.1606098535354,-286.23846711616164,-287.3163243787879,-288.39418164141415,-289.4720389040404,-290.54989616666666,-291.6277534292929,-292.7056106919192,-293.7834679545455,-294.8613252171717,-295.939182479798,-297.0170397424243,-298.09489700505054,-299.1727542676768,-300.25061153030305,-301.3284687929293,-302.40632605555555,-303.4841833181818,-304.56204058080806,-305.63989784343437,-306.7177551060606,-307.7956123686869)
counts=c(0.8537428803905615, 0.03980200705180363,0.012883102793599131,0.0031868727963113644,0.007458638459452129,0.014781665310550583,0.15574993219419583,0.2830892324382967,0.15656360184431786,0.08245185787903445,0.02508814754542989,0.009289395172226742,0.0029834553837808516,0.0033902902088418767,0.0040683482506102524,0.005492270138323841,0.0014917276918904258,0.0015595334960672633,0.0014917276918904258,0.0012883102793599132,0.0026444263628966637,0.0033224844046650394,0.0037293192297260646,0.0025766205587198264,0.0010170870626525631,0.0012205044751830757,0.0012883102793599132,0.0007458638459452129,0.0011526986710062382,0.0007458638459452129,0.0008136696501220504,0.0015595334960672633,0.005017629509085977,0.012137238947653919,0.020002712232167073,0.07390832655275291,0.6298481149986439,0.2537293192297261,0.014646053702196907,0.005627881746677515,0.003525901817195552,0.017426091673447247,0.015324111743965283,0.009425006780580418,0.03200433957146732,0.15954705722809873,0.115608896121508,0.019324654190398697,0.07492541361540547,0.6400867914293463,0.02264713859506374,0.0043395714673176026,0.0027122321670735015,0.1539191754814212,0.2935313262815297,0.053295362082994305,0.004882017900732303,0.006238133984269053,0.05302413886628696,0.2510848928668294,0.12164361269324654,0.06041497152156224,0.06427990235964198,0.03817466775155953,0.008679142934635205,0.008407919717927854,0.012340656360184431,0.005153241117439653,0.0033224844046650394,0.0021697857336588013,0.0009492812584757255,0.0007458638459452129,0.0006780580417683754,0.0014239218877135883,0.0013561160835367507,0.0025088147545429887,0.0014917276918904258,0.0010848928668294006,0.0014239218877135883,0.0010848928668294006,0.0013561160835367507,0.0010848928668294006,0.0006780580417683754,0.0012883102793599132,0.0008136696501220504,0.0020341741253051262,0.004475183075671277,0.006305939788445891,0.010035259018171955,0.03302142663411988,0.021697857336588012,0.053295362082994305,0.06814483319772173,0.1591402224030377,0.20280716029292106,0.030173582858692705,0.012137238947653919,0.014713859506373746,0.00935720097640358)
plot(mids,counts,type = 'h', xlim = c(-308.334541,-201.626672), ylim=c(0,0.8537428803905615), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-202.160211345, -203.227290035,-204.29436872500003,-205.36144741500004,-206.428526105,-207.49560479500002,-208.56268348500004,-209.629762175,-210.696840865,-211.76391955500003,-212.830998245,-213.898076935,-214.96515562500002,-216.03223431500004,-217.099313005,-218.16639169500002,-219.23347038500003,-220.300549075,-221.367627765,-222.43470645500003,-223.50178514499999,-224.568863835,-225.63594252500002,-226.70302121500004,-227.770099905,-228.837178595,-229.90425728500003,-230.971335975,-232.038414665,-233.10549335500002,-234.17257204499998,-235.239650735,-236.30672942500001,-237.37380811500003,-238.440886805,-239.507965495,-240.57504418500002,-241.64212287499998,-242.709201565,-243.77628025500002,-244.84335894500003,-245.910437635,-246.977516325,-248.04459501500003,-249.111673705,-250.178752395,-251.24583108500002,-252.31290977499998,-253.379988465,-254.447067155,-255.51414584499997,-256.581224535,-257.648303225,-258.71538191499997,-259.782460605,-260.849539295,-261.916617985,-262.983696675,-264.050775365,-265.117854055,-266.18493274499997,-267.252011435,-268.319090125,-269.386168815,-270.453247505,-271.520326195,-272.58740488499996,-273.654483575,-274.721562265,-275.788640955,-276.855719645,-277.922798335,-278.989877025,-280.05695571499996,-281.124034405,-282.191113095,-283.258191785,-284.32527047499997,-285.392349165,-286.459427855,-287.52650654499996,-288.593585235,-289.660663925,-290.727742615,-291.79482130499997,-292.861899995,-293.928978685,-294.99605737499996,-296.063136065,-297.130214755,-298.197293445,-299.264372135,-300.331450825,-301.39852951499995,-302.46560820499997,-303.532686895,-304.599765585,-305.666844275,-306.733922965,-307.801001655)
net_rate=c(-2.2057230920496105, -0.08486261666443473,-0.050145699890253054,-0.04445992825611516,-0.043724939330315925,-0.04264829246845292,-0.04407154133439753,-0.04560446354801517,-0.04082366409830926,-0.025248269288294736,-0.01422445293599945,-0.01167033608864186,-0.01116286837684655,-0.011150456166075799,-0.011214238048386914,-0.011369148453066575,-0.011715559800974374,-0.011739885092816737,-0.011728476022351383,-0.011727687426161416,-0.011761865442721965,-0.011828520111724024,-0.012045951928476501,-0.012116637655060393,-0.012380739186388927,-0.012209637659586606,-0.012008855840384313,-0.011831070582220386,-0.0112032096284884,-0.008993126460663881,9.07293626545888e-05,0.027483379885226304,0.0670062207260555,0.07397819523737494,0.07237742208907509,0.07008832147150666,0.06417337645534665,-0.012023919648849826,-0.13555495827089276,-0.13106911333088292,-0.12703073693662087,-0.12444084062754596,0.18627816513682,0.4101600708723606,-0.14474858595686116,-0.15172333988679274,-0.1762093081248351,-0.2438514170933602,-0.2531732354551636,-0.255407423751475,-0.10798638162663815,-0.07501524563040037,-0.07081324263949476,0.013911448061174735,0.07752844819434244,-0.004206912857715701,0.08262688588376212,0.08739223864009234,0.1356152849162946,0.2848033785596333,0.15127414952677098,0.15078337825020094,0.04283402148491176,0.01887686848842921,0.024408674416062263,0.025584533100350863,0.025391869416966292,0.025379677614695947,0.023053335158229944,0.02213195436467897,0.022198661972023446,0.022335252253311996,0.02230409709007265,0.022267258105475182,0.022199689290821403,0.022133551408461308,0.022098341259451294,0.021978939485194648,0.02189219425412915,0.021866111933081123,0.021803348382211707,0.021785870712813467,0.021762992874576007,0.02173822652744817,0.02170503276593473,0.021636965877679232,0.02158482129692434,0.021428381921983892,0.02111689788254728,0.021300516343029503,0.02318346573969583,0.02856238552101233,0.04607688696147666,0.06428713833045646,0.20955987297249348,0.4117259532114821,0.45347804892056554,0.4768244386206806,0.4851354783925648,0.4744212532668398)
net_minHPD=c(-4.692446032366938, -0.3195008360095083,-0.23174083237268295,-0.2158229773641737,-0.2174349244261486,-0.22576528450991148,-0.23671755058977684,-0.2712697937541117,-0.2506020164587895,-0.19707377988622715,-0.07903025667259973,-0.06312318624845142,-0.059635493938078654,-0.059705662665569204,-0.05853221134132819,-0.057492628973311116,-0.056092319207871014,-0.05632738633919976,-0.05600693737198161,-0.0560052578537907,-0.05622162425952344,-0.05600693737198161,-0.05635828093756757,-0.05635828093756757,-0.057492628973311116,-0.057492628973311116,-0.05748940644080119,-0.057242605119931,-0.059339890201528606,-0.060615810065427975,-0.059339890201528606,-0.057492628973311116,-0.036451959361922665,-0.027940322950285187,-0.03158952306978771,-0.033264665339667515,-0.09344350666666763,-0.23668219769575471,-0.30223656543800453,-0.3005944817637073,-0.28614287844080655,-0.299073149447985,-0.3005944817637073,-0.29831031713800493,-0.3341570256969637,-0.3326256222331439,-0.40763561229297796,-0.5111169694677763,-0.5060902167680738,-0.518648723555817,-0.2807649764042382,-0.16556924292482894,-0.16608735753045,-0.15154804801829155,-0.18930815356899855,-0.5700121600674806,-0.05236762400460103,-0.05005332828800994,-0.05585129736763042,0.020364976528379625,-0.10582365260959768,-0.10266332758327523,-0.12778174595476743,-0.12090468172813543,-0.1095415475885021,-0.07941764909548615,-0.06407332600099169,-0.045806208622102024,-0.03899450837646498,-0.034426302272108134,-0.03271218196591913,-0.03244342370794047,-0.03244342370794047,-0.03244342370794047,-0.03177459391888515,-0.03271979181456186,-0.03271979181456186,-0.03271979181456186,-0.03271979181456186,-0.03253604938605567,-0.03253604938605567,-0.0325998968564761,-0.03271979181456186,-0.03271979181456186,-0.03271979181456186,-0.032305954355514976,-0.03244342370794047,-0.03271979181456186,-0.03514473012444187,-0.04145283952129919,-0.052986521885177676,-0.24320090749438444,-0.14605051884098463,-0.22415316159592483,-0.2559357508954496,-0.2183866493048741,-0.2712994053501836,-0.27172836858576355,-0.30104851434981184,-0.33295526199426995)
net_maxHPD=c(0.11195925785538668, 0.20441441783909436,0.1294085231978886,0.12850310705080928,0.12850310705080928,0.12643076012107657,0.1297732773172142,0.17296475818374307,0.12277914840748984,0.06919857079396707,0.07544862396194187,0.045217704779796905,0.04073718567888812,0.038362627815675315,0.03788518963559341,0.03770666717173371,0.03770666717173371,0.03719260866422046,0.03719260866422046,0.03719260866422046,0.036953064831138915,0.03719260866422046,0.03691587329491662,0.03700269208082978,0.03652322287394612,0.03655771316220606,0.03652322287394612,0.03700269208082978,0.03719260866422046,0.048721866191247645,0.10210254872672755,0.13786264891154265,0.1653741659292214,0.16940958421681968,0.1702632002316356,0.17976344267111583,0.19157659049838505,0.17924768792053183,0.067712325715994,0.0555964530398359,0.07906944869916965,0.07967161795447691,1.1750551546117611,1.2214620441833883,0.08251575769622088,0.07722915314250511,0.05513421763249943,-0.03710109119714555,-0.04515558286579202,-0.052224610977229496,0.03784696463371359,0.03249685896449467,0.039713103763800245,0.16835504921865166,0.5225177987188638,0.20549863473373145,0.1886292192753859,0.18546328608573864,0.4119584766401698,0.8909405821775793,0.4281577002988842,0.3918661199087635,0.25609122068496726,0.13155031873618983,0.09446188822451017,0.09355127523029501,0.09298782476262335,0.08985169639290802,0.07892162214837536,0.0778226162570975,0.07816791061926105,0.07772547586858425,0.07755524216639573,0.07747085851173013,0.0778089265321273,0.07625013718718976,0.0759461353591819,0.07577393196680575,0.07577393196680575,0.07600164471153642,0.07626286765954816,0.07626286765954816,0.07625013718718976,0.07634349291725781,0.07657463046073396,0.07747085851173013,0.07751527173689612,0.07770305860662291,0.0778226162570975,0.0777580365883888,0.08672439584462992,0.13139307872254094,0.4283097857142072,0.5350514381336624,0.8536568818111397,1.1315049328350024,1.2001234725851377,1.2530784372781152,1.2875531381407226,1.3050089741246038)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-5.161690635603632, 1.4355098715370642), xlim = c(-308.334541,-201.626672), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-202.160211345, -203.227290035,-204.29436872500003,-205.36144741500004,-206.428526105,-207.49560479500002,-208.56268348500004,-209.629762175,-210.696840865,-211.76391955500003,-212.830998245,-213.898076935,-214.96515562500002,-216.03223431500004,-217.099313005,-218.16639169500002,-219.23347038500003,-220.300549075,-221.367627765,-222.43470645500003,-223.50178514499999,-224.568863835,-225.63594252500002,-226.70302121500004,-227.770099905,-228.837178595,-229.90425728500003,-230.971335975,-232.038414665,-233.10549335500002,-234.17257204499998,-235.239650735,-236.30672942500001,-237.37380811500003,-238.440886805,-239.507965495,-240.57504418500002,-241.64212287499998,-242.709201565,-243.77628025500002,-244.84335894500003,-245.910437635,-246.977516325,-248.04459501500003,-249.111673705,-250.178752395,-251.24583108500002,-252.31290977499998,-253.379988465,-254.447067155,-255.51414584499997,-256.581224535,-257.648303225,-258.71538191499997,-259.782460605,-260.849539295,-261.916617985,-262.983696675,-264.050775365,-265.117854055,-266.18493274499997,-267.252011435,-268.319090125,-269.386168815,-270.453247505,-271.520326195,-272.58740488499996,-273.654483575,-274.721562265,-275.788640955,-276.855719645,-277.922798335,-278.989877025,-280.05695571499996,-281.124034405,-282.191113095,-283.258191785,-284.32527047499997,-285.392349165,-286.459427855,-287.52650654499996,-288.593585235,-289.660663925,-290.727742615,-291.79482130499997,-292.861899995,-293.928978685,-294.99605737499996,-296.063136065,-297.130214755,-298.197293445,-299.264372135,-300.331450825,-301.39852951499995,-302.46560820499997,-303.532686895,-304.599765585,-305.666844275,-306.733922965,-307.801001655)
rate=c(0.4186439890296523, 3.742674247198407,4.294925680891526,4.392925931302249,4.394874740237855,4.409558531350285,4.444069523342379,5.068133625980734,7.21488927338103,9.065174055844404,10.324084035338053,10.757152076952492,10.883603780400263,10.922663540201505,10.93679391619681,10.924276256818288,10.884047132616576,10.878407533249181,10.87549150435087,10.870383110197642,10.864738951084487,10.85289969531763,10.818112992714402,10.789841315493431,10.740443045847131,10.749709295247674,10.764671808806233,10.773595657121591,10.775031961014825,10.776363053069941,10.776748828741505,10.776368681950062,10.766433893344777,10.732396001602796,10.560816226685825,10.261746612164867,9.531082617729076,5.294704459530633,2.981852986117258,2.9976647590543695,3.009358806128648,3.006686227746149,2.9907828925276654,2.948082123538518,2.9351680173494663,2.912615393883236,2.720401133296496,2.3008139602064057,2.3368359760932824,2.3365088366759608,3.594665645271345,4.078356035595964,4.090679343819482,4.092573876806128,3.4914071658980017,3.338401260408517,4.890390468255689,4.952761105750085,4.962922155755782,4.994521682110938,5.478622291817923,6.519404806236108,7.010138285201532,7.321235259958745,7.797967844545536,7.942898537222948,7.992672283226352,8.068707464053917,8.137642406641016,8.166078810288798,8.179788498240876,8.198662219013775,8.20096081605851,8.201543682158855,8.197323139818627,8.188111671008024,8.18095791093344,8.172182120965154,8.167661130069373,8.165783430620783,8.162335444584636,8.161003591275414,8.159525860653076,8.159266743105242,8.157356455563134,8.153707470085006,8.150799622003039,8.139230750205424,8.108101871627634,8.063457926688741,7.965163079075171,7.591728135017791,7.365360481743502,6.666805283871294,5.829169814810851,4.215735152578916,2.818279517903872,2.724962195749985,2.6647344645036304,2.585951997669097)
minHPD=c(0.4186439890296523, 3.742674247198407,4.294925680891526,4.392925931302249,4.394874740237855,4.409558531350285,4.444069523342379,5.068133625980734,7.21488927338103,9.065174055844404,10.324084035338053,10.757152076952492,10.883603780400263,10.922663540201505,10.93679391619681,10.924276256818288,10.884047132616576,10.878407533249181,10.87549150435087,10.870383110197642,10.864738951084487,10.85289969531763,10.818112992714402,10.789841315493431,10.740443045847131,10.749709295247674,10.764671808806233,10.773595657121591,10.775031961014825,10.776363053069941,10.776748828741505,10.776368681950062,10.766433893344777,10.732396001602796,10.560816226685825,10.261746612164867,9.531082617729076,5.294704459530633,2.981852986117258,2.9976647590543695,3.009358806128648,3.006686227746149,2.9907828925276654,2.948082123538518,2.9351680173494663,2.912615393883236,2.720401133296496,2.3008139602064057,2.3368359760932824,2.3365088366759608,3.594665645271345,4.078356035595964,4.090679343819482,4.092573876806128,3.4914071658980017,3.338401260408517,4.890390468255689,4.952761105750085,4.962922155755782,4.994521682110938,5.478622291817923,6.519404806236108,7.010138285201532,7.321235259958745,7.797967844545536,7.942898537222948,7.992672283226352,8.068707464053917,8.137642406641016,8.166078810288798,8.179788498240876,8.198662219013775,8.20096081605851,8.201543682158855,8.197323139818627,8.188111671008024,8.18095791093344,8.172182120965154,8.167661130069373,8.165783430620783,8.162335444584636,8.161003591275414,8.159525860653076,8.159266743105242,8.157356455563134,8.153707470085006,8.150799622003039,8.139230750205424,8.108101871627634,8.063457926688741,7.965163079075171,7.591728135017791,7.365360481743502,6.666805283871294,5.829169814810851,4.215735152578916,2.818279517903872,2.724962195749985,2.6647344645036304,2.585951997669097)
maxHPD=c(0.4186439890296523, 3.742674247198407,4.294925680891526,4.392925931302249,4.394874740237855,4.409558531350285,4.444069523342379,5.068133625980734,7.21488927338103,9.065174055844404,10.324084035338053,10.757152076952492,10.883603780400263,10.922663540201505,10.93679391619681,10.924276256818288,10.884047132616576,10.878407533249181,10.87549150435087,10.870383110197642,10.864738951084487,10.85289969531763,10.818112992714402,10.789841315493431,10.740443045847131,10.749709295247674,10.764671808806233,10.773595657121591,10.775031961014825,10.776363053069941,10.776748828741505,10.776368681950062,10.766433893344777,10.732396001602796,10.560816226685825,10.261746612164867,9.531082617729076,5.294704459530633,2.981852986117258,2.9976647590543695,3.009358806128648,3.006686227746149,2.9907828925276654,2.948082123538518,2.9351680173494663,2.912615393883236,2.720401133296496,2.3008139602064057,2.3368359760932824,2.3365088366759608,3.594665645271345,4.078356035595964,4.090679343819482,4.092573876806128,3.4914071658980017,3.338401260408517,4.890390468255689,4.952761105750085,4.962922155755782,4.994521682110938,5.478622291817923,6.519404806236108,7.010138285201532,7.321235259958745,7.797967844545536,7.942898537222948,7.992672283226352,8.068707464053917,8.137642406641016,8.166078810288798,8.179788498240876,8.198662219013775,8.20096081605851,8.201543682158855,8.197323139818627,8.188111671008024,8.18095791093344,8.172182120965154,8.167661130069373,8.165783430620783,8.162335444584636,8.161003591275414,8.159525860653076,8.159266743105242,8.157356455563134,8.153707470085006,8.150799622003039,8.139230750205424,8.108101871627634,8.063457926688741,7.965163079075171,7.591728135017791,7.365360481743502,6.666805283871294,5.829169814810851,4.215735152578916,2.818279517903872,2.724962195749985,2.6647344645036304,2.585951997669097)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 12.030473307816493), xlim = c(-308.334541,-201.626672), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()