# Required libraries
library(ggplot2)
library(gridExtra)
library(deeptime)   # For coordinate system

ts=c(292.0412354134316, 251.66708187466153,294.6321580525174,297.64298680166075,298.6514968443128,305.15659568767063,308.3940724153418,233.73250530662142,309.4028406377824,271.4371929642804,236.62024877143563,302.33039587567276,251.55610899551684,277.44305689920117,263.21156530452026,300.60778299028084,235.5064054737806,302.8317021487544,251.3203558216272,251.8355485234104,215.7922045784447,298.99600469831125,250.42456554746684,272.4818012104181,303.4424915607591,301.88702251207314,301.59882973895213,267.9505752460702,267.56505396638164,251.9762640342925,266.3783249080439,250.0280197425589,251.3386100421128,250.37049944649937,249.69897513197904,251.65899294180832,301.6675590303037,248.95594860673717,260.6113589672468,249.5315097522781,305.17045359800676,309.1837501607434,295.04628462563625,296.8251505747368,251.87755175126685,246.12247225927254,249.5509299024034,289.8291427553568,219.20987282025638,239.41757172809807,244.89882525825007,308.6872481336981,244.67191282806547,252.02700408783247,298.2235111576872,271.7656265774222,302.68274913099026,246.5202473940606,224.80153432311596,252.0454737746941,279.48734862778235,309.423969354049,267.19090296081976,234.78883621201365,299.0181348860773,247.84531741155521,245.8952288776615,244.71048809207963,249.23132229744155,297.9907376606816,301.70981159075944,250.11436588566164,251.98532767572672,251.61490680313258,251.93312913329362,289.74249025381187,288.08509228002566,233.35861679862694,265.108326344869,295.6082804758368,251.80524081481815,302.50707176972776,293.9453520012247,247.21499060270344,235.1530817941213,249.43876303267456,300.827910145496,309.72040194980843,306.03537965968155,249.93622163355766,246.39233446682547,249.8745494553534,308.4594095493769,245.24306360624274,272.78231310151796,300.7438141574512,218.41806688953807,287.2114920329554,279.596880284756,243.81303888262792,299.326194484174,303.8431688232677,246.06786130705956,206.3714721596984,245.04272389006618,235.50200178084023,251.45450178150313,248.5453320253374,274.9256735167923,266.87083729422795,309.7974161526309,243.9926569876066,267.8318608488185,251.64787368347956,250.99267810046177,274.5508018148294,249.34208972513176,267.5546064688367,266.0990631831931,295.76270969951344,226.83386867318737,249.0466532510028,257.22596742815085,302.6407814609378,244.87001046662323,251.49494241037536,294.5410228877403,309.7137773406668,309.16539757259073,252.08478888974034,261.18441948484815,251.36209465889502,308.5523007635591,308.85790599324713,251.7326701927437,250.6920672566321,246.52900412052946,246.70039001233718,238.45025830574502,302.78573452907335,250.95283694611172,275.71537107624806,244.60336304511281,236.746084696873,235.56659562702953,236.29767152715198,230.83581148730883,248.715255170957,302.5327784400162,252.082180012281,246.54491836043098,302.15467863393974,309.03153710519217,308.6148952404521,269.6786822929021,291.73101332967786,251.72589298741562,298.0270416667041,254.19947263493972,268.24038750597197,244.8130822219351,309.31187716166477,247.95478667624351,248.036342192946,247.23430022708123,303.0113072437218,294.8845531531141,235.32363624859826,245.87293792033617,262.3842365966359,295.7894722840257,250.92907625925005,250.24833496503328,293.1638531130574,232.40501233581278,260.6117864706008,251.17173719536171,279.7374605149945,294.1568187798964,251.67662197035915,246.5530239003809,219.49713383251495,246.87693350036517,242.39496755297253,240.44873366986144,246.87014495233652,303.1002321704513,274.3078304606344,309.79444831134055,250.49407004584322,296.5573809714042,293.02394551948896,251.78673027154238,301.28051174085107,309.08307955153424,277.73130326446363,285.329188853459,226.51751873373857,250.64280061004058,251.9435024040495,247.07379694904435,267.4283139463477,294.5504760588321,251.98919947836495,246.3646076924235,258.012331363285,264.88455111767547,251.33511980544728,264.79593935595904,249.99820395803326,250.11679104083188,228.92777064317576,287.2925388420881,251.61761507293343,294.59054166615357,253.22311999007854,251.62317688322338,250.09854540922936,296.4915686267261,297.58690790711125,300.38530379691906,250.65891057186036,251.820623821807,277.42828289157177,308.5301651880471,246.8466754656345,248.6474533334307,245.00032730186857,309.5408787949303,297.0849872370027,247.45189428526166,252.0139930887201,245.03444932443062,275.8056477861886,252.14836287125704,286.8375553906223,241.01633277427834,294.1852917103788,251.01474664824326,251.63464390247083,251.6278861294397,251.21259729728428,292.54232651521926,251.65947880690797,251.23775365997366,239.65353027330644,261.26841747052214,248.10470480063816,249.9757711928449,251.83767738170093,250.4113547738963,236.5784901259227,301.061388603209,258.3070225601861,299.42506039121787,265.95136834222853,258.74653387379635,251.97576784393087,264.07803293796565,255.51538910101237,217.40827672714298,244.37427435558823,246.7975324811852,250.03287509467523,249.64258271217653,249.1756398764256,251.45345879663816,251.71622243400486,251.89862727300306,252.14882690499894,249.0293595944898,251.69108820849672,251.80261769798534,246.7708219799998,250.69774037317276,245.8291107660423,302.14048651863504,273.59355788027955)
te=c(291.8553412041709, 251.55917138655494,259.6819983552287,288.03701354836574,283.57153469605277,304.9902226543107,308.2340893068349,232.2452978162451,307.3855641785414,269.50863716565357,204.19719396680864,302.1612649116844,246.49526997934808,276.39057488681897,261.15097591830244,300.43829894056114,202.8998814703424,258.24847212274295,246.9329806542321,249.54692793312284,213.89638644471287,284.20919325025,250.31836665249045,270.7676362169463,272.4639921896089,275.351965121743,301.4313237484916,258.60049099299994,265.3668004557692,251.1634953784649,264.208309316689,244.0433079813144,246.39669281924515,241.35515509650668,249.59131314427128,247.18417549805056,301.4992987528624,248.84710600757313,251.5649362124968,249.42302083654877,284.40015119054146,293.34054747983686,294.85298387635817,272.11490863992856,247.6880292939696,234.7842264416342,249.44254341051024,274.2079032953517,217.80025690977425,235.71217827168843,244.3925754563647,308.5350208937628,244.18151482607672,249.8403317579074,266.5108961058102,270.13755340448773,283.181373373802,243.71787989513362,206.47654484786344,251.18497592232492,270.9851961971146,307.5527649832695,264.92246428719426,206.53254668600772,287.13921126325016,247.72913237974583,201.6414990954393,244.18352159639994,249.12347595752763,273.6191133815099,300.4409301300464,250.0061170062922,251.16367548856732,246.85491335216122,251.1351833340375,272.14700073536784,276.3136119415275,232.09178683059363,255.63532678667175,287.2416673669479,249.03338437324015,283.21378479563816,287.8688905935573,242.53811607060751,233.88968100995518,249.32770551478106,300.6578243052394,307.40761393262846,259.8585659535613,241.22292863924312,243.41518004974213,249.76631757247833,308.3086584641063,244.735056033697,265.55559956653445,300.5740653130148,216.6821882290363,286.5824157238621,278.72387426728386,201.73223320146295,286.8024985916696,303.6762722122833,245.59531440545396,203.41388936963338,244.5503947417949,224.0748308570321,249.5735774690165,246.76748419962024,273.5271194063192,264.59795356718615,270.0909427771885,243.4844016420297,263.3118243199923,251.53329322135085,246.3248684592748,266.8132142193844,249.23439908755157,262.14483849378087,257.87475600091017,295.5853563103406,205.37754641281364,248.93818874382856,255.7155637091765,299.7667054609827,244.42747413847346,251.38695888458295,283.62314724491284,299.85450619456395,284.46523101173045,249.06779752508456,246.45061583368354,248.81731370746866,308.39670437837503,308.70673989929094,249.05408404307911,250.58799674654773,202.6602470781357,242.59257262799576,237.81243088650433,265.62121329994716,247.2824252557445,263.6430111407656,244.11856720348536,202.05550719212576,228.80629052816326,218.77993702337105,205.1286620683715,246.8330326712435,282.9154311965191,247.2187599525613,242.5575976058383,301.9854859312352,308.87479456739965,308.463948706154,267.5581765094327,291.32155514903536,251.59164402178678,281.8158660543939,252.43804197392106,265.99972687684135,244.31833372042385,297.95493577267155,247.8459031344397,247.91756451103944,243.5578486116136,270.3391554032742,294.7083890463264,207.2404111788672,242.3126724182856,260.53862165327695,278.388909324734,246.9483978961449,250.13821334307121,283.3769679328532,205.23876419568765,254.73865010520348,248.81200095864,278.78875821780014,283.58497063907464,251.55438961386085,236.1251088808414,201.50942960890572,237.56902180189667,230.26122628450884,233.86534580648097,246.52724877182894,281.05582595422425,259.8421794954213,307.54696953559034,250.38289513165316,296.37787951715194,292.7211799507185,251.12012709489997,301.11014164423193,308.9345384191508,276.7428622999921,284.6403312755537,224.9226386564568,246.88889621439566,247.67714930782367,245.2506779087967,263.9909822679244,294.3594178135035,251.23161200824728,245.9386287282104,256.316978890819,254.66994719405835,247.54850067707508,254.2755617545253,246.7966328595265,250.00912600883157,206.33784872823287,286.68751509248426,251.50197814609152,294.4159274910617,252.65092367101877,251.5128425051517,249.99397273699705,296.31334317461994,290.5343231403162,283.7793299248081,246.9297936915134,251.25407491895413,268.62739190343717,308.38171494334773,242.24112981266077,244.83133140613947,244.52933839535277,307.5517160418657,296.9117078675378,214.3229148696165,251.19147750092696,244.51484992619018,274.7676368375713,249.0069577721323,286.2255909139091,237.1921106731761,272.0382339265048,249.19359148446614,249.28645107797837,251.51539594894328,247.3228768969651,272.9363512521714,251.5521287842448,247.82797608195597,236.54455753590486,202.22338701335968,247.99805432418344,246.93819203588805,249.601907793346,250.299473547287,235.59815470978322,260.7497093417566,256.57357486221196,299.25310135568935,259.2917441327206,248.5946229637861,251.1751456368835,261.94097683242506,254.4451355320172,215.64139788548187,243.89976499514603,245.0044282830369,249.9237443875998,249.53623637628513,249.06806432008224,248.85001767649072,251.5991331899347,251.1373493393634,245.81131393947123,246.63240544718477,247.08454171776089,251.67340571058102,242.13325884191954,246.91549929183475,243.06320452451152,270.6697761454735,263.3235435045787)
div_traj=c(0, 1,2,3,4,5,6,7,8,9,10,11,12,11,10,11,10,11,12,13,12,13,12,13,12,13,12,11,10,9,8,7,6,5,6,7,8,7,8,7,8,9,10,11,12,13,14,15,16,17,16,17,18,17,18,19,20,21,20,19,20,19,20,21,22,21,22,21,20,19,20,19,18,19,20,19,20,21,22,23,24,25,24,25,26,27,26,27,28,29,28,27,28,29,30,29,30,31,30,29,30,31,32,33,32,31,32,33,34,33,34,35,34,35,36,35,36,35,34,35,36,37,36,35,36,35,36,35,36,35,34,33,32,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,20,21,22,21,20,19,20,21,22,21,20,19,20,21,20,21,20,21,22,21,20,21,20,19,20,21,20,19,18,17,18,19,18,17,16,15,14,13,14,13,12,13,14,15,16,15,16,17,18,19,18,17,18,19,18,19,18,17,16,17,16,17,18,17,16,17,16,15,14,13,14,15,14,13,14,15,14,13,14,15,14,13,12,11,10,11,10,11,10,11,10,11,10,9,8,7,8,7,6,5,4,5,6,5,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,29,30,31,32,33,34,35,36,37,38,37,36,35,34,35,34,33,32,31,30,29,30,31,32,31,32,33,34,35,34,35,34,35,34,33,32,33,32,31,30,29,28,29,30,31,32,33,34,35,36,35,36,37,38,37,38,37,36,37,36,37,38,39,40,41,40,39,40,39,40,41,40,41,40,39,40,41,40,39,38,39,38,37,38,37,38,37,38,37,36,35,36,35,36,35,34,33,32,33,32,33,32,33,32,31,30,29,28,29,30,29,30,31,32,31,32,31,30,31,30,29,28,27,26,27,26,25,26,25,26,25,24,25,24,23,22,21,20,19,20,21,20,21,20,21,20,21,20,21,20,21,22,23,22,23,22,21,20,21,22,21,22,23,22,23,24,25,24,23,22,23,24,25,24,25,26,27,26,27,26,27,28,29,28,27,26,25,24,25,24,23,22,21,20,21,20,21,20,19,18,17,16,15,14,13,14,13,12,11,10,9,10,11,12,13,14,13,12,11,12,13,14,13,14,13,12,11,12,13,14,15,16,17,16,15,14,15,16,17,16,15,16,15,16,15,16,17,16,17,16,17,18,17,18,17,18,17,18,17,16,15,14,13,12,13,12,11,10,9,8,7,6,5,4,3,2,1)
time_events=c(309.7974161526309, 309.79444831134055,309.72040194980843,309.7137773406668,309.5408787949303,309.423969354049,309.4028406377824,309.31187716166477,309.1837501607434,309.16539757259073,309.08307955153424,309.03153710519217,308.9345384191508,308.87479456739965,308.85790599324713,308.70673989929094,308.6872481336981,308.6148952404521,308.5523007635591,308.5350208937628,308.5301651880471,308.463948706154,308.4594095493769,308.39670437837503,308.3940724153418,308.38171494334773,308.3086584641063,308.2340893068349,307.5527649832695,307.5517160418657,307.54696953559034,307.40761393262846,307.3855641785414,306.03537965968155,305.17045359800676,305.15659568767063,304.9902226543107,303.8431688232677,303.6762722122833,303.4424915607591,303.1002321704513,303.0113072437218,302.8317021487544,302.78573452907335,302.68274913099026,302.6407814609378,302.5327784400162,302.50707176972776,302.33039587567276,302.1612649116844,302.15467863393974,302.14048651863504,301.9854859312352,301.88702251207314,301.70981159075944,301.6675590303037,301.59882973895213,301.4992987528624,301.4313237484916,301.28051174085107,301.11014164423193,301.061388603209,300.827910145496,300.7438141574512,300.6578243052394,300.60778299028084,300.5740653130148,300.4409301300464,300.43829894056114,300.38530379691906,299.85450619456395,299.7667054609827,299.42506039121787,299.326194484174,299.25310135568935,299.0181348860773,298.99600469831125,298.6514968443128,298.2235111576872,298.0270416667041,297.9907376606816,297.95493577267155,297.64298680166075,297.58690790711125,297.0849872370027,296.9117078675378,296.8251505747368,296.5573809714042,296.4915686267261,296.37787951715194,296.31334317461994,295.7894722840257,295.76270969951344,295.6082804758368,295.5853563103406,295.04628462563625,294.8845531531141,294.85298387635817,294.7083890463264,294.6321580525174,294.59054166615357,294.5504760588321,294.5410228877403,294.4159274910617,294.3594178135035,294.1852917103788,294.1568187798964,293.9453520012247,293.34054747983686,293.1638531130574,293.02394551948896,292.7211799507185,292.54232651521926,292.0412354134316,291.8553412041709,291.73101332967786,291.32155514903536,290.5343231403162,289.8291427553568,289.74249025381187,288.08509228002566,288.03701354836574,287.8688905935573,287.2925388420881,287.2416673669479,287.2114920329554,287.13921126325016,286.8375553906223,286.8024985916696,286.68751509248426,286.5824157238621,286.2255909139091,285.329188853459,284.6403312755537,284.46523101173045,284.40015119054146,284.20919325025,283.7793299248081,283.62314724491284,283.58497063907464,283.57153469605277,283.3769679328532,283.21378479563816,283.181373373802,282.9154311965191,281.8158660543939,281.05582595422425,279.7374605149945,279.596880284756,279.48734862778235,278.78875821780014,278.72387426728386,278.388909324734,277.73130326446363,277.44305689920117,277.42828289157177,276.7428622999921,276.39057488681897,276.3136119415275,275.8056477861886,275.71537107624806,275.351965121743,274.9256735167923,274.7676368375713,274.5508018148294,274.3078304606344,274.2079032953517,273.6191133815099,273.59355788027955,273.5271194063192,272.9363512521714,272.78231310151796,272.4818012104181,272.4639921896089,272.14700073536784,272.11490863992856,272.0382339265048,271.7656265774222,271.4371929642804,270.9851961971146,270.7676362169463,270.6697761454735,270.3391554032742,270.13755340448773,270.0909427771885,269.6786822929021,269.50863716565357,268.62739190343717,268.24038750597197,267.9505752460702,267.8318608488185,267.56505396638164,267.5581765094327,267.5546064688367,267.4283139463477,267.19090296081976,266.87083729422795,266.8132142193844,266.5108961058102,266.3783249080439,266.0990631831931,265.99972687684135,265.95136834222853,265.62121329994716,265.55559956653445,265.3668004557692,265.108326344869,264.92246428719426,264.88455111767547,264.79593935595904,264.59795356718615,264.208309316689,264.07803293796565,263.9909822679244,263.6430111407656,263.3235435045787,263.3118243199923,263.21156530452026,262.3842365966359,262.14483849378087,261.94097683242506,261.26841747052214,261.18441948484815,261.15097591830244,260.7497093417566,260.6117864706008,260.6113589672468,260.53862165327695,259.8585659535613,259.8421794954213,259.6819983552287,259.2917441327206,258.74653387379635,258.60049099299994,258.3070225601861,258.24847212274295,258.012331363285,257.87475600091017,257.22596742815085,256.57357486221196,256.316978890819,255.7155637091765,255.63532678667175,255.51538910101237,254.73865010520348,254.66994719405835,254.4451355320172,254.2755617545253,254.19947263493972,253.22311999007854,252.65092367101877,252.43804197392106,252.14882690499894,252.14836287125704,252.08478888974034,252.082180012281,252.0454737746941,252.02700408783247,252.0139930887201,251.98919947836495,251.98532767572672,251.9762640342925,251.97576784393087,251.9435024040495,251.93312913329362,251.89862727300306,251.87755175126685,251.83767738170093,251.8355485234104,251.820623821807,251.80524081481815,251.80261769798534,251.78673027154238,251.7326701927437,251.72589298741562,251.71622243400486,251.69108820849672,251.67662197035915,251.67340571058102,251.66708187466153,251.65947880690797,251.65899294180832,251.64787368347956,251.63464390247083,251.6278861294397,251.62317688322338,251.61761507293343,251.61490680313258,251.5991331899347,251.59164402178678,251.5649362124968,251.55917138655494,251.55610899551684,251.55438961386085,251.5521287842448,251.53329322135085,251.51539594894328,251.5128425051517,251.50197814609152,251.49494241037536,251.45450178150313,251.45345879663816,251.38695888458295,251.36209465889502,251.3386100421128,251.33511980544728,251.3203558216272,251.25407491895413,251.23775365997366,251.23161200824728,251.21259729728428,251.19147750092696,251.18497592232492,251.1751456368835,251.17173719536171,251.16367548856732,251.1634953784649,251.1373493393634,251.1351833340375,251.12012709489997,251.01474664824326,250.99267810046177,250.95283694611172,250.92907625925005,250.69774037317276,250.6920672566321,250.65891057186036,250.64280061004058,250.58799674654773,250.49407004584322,250.42456554746684,250.4113547738963,250.38289513165316,250.37049944649937,250.31836665249045,250.299473547287,250.24833496503328,250.13821334307121,250.11679104083188,250.11436588566164,250.09854540922936,250.03287509467523,250.0280197425589,250.00912600883157,250.0061170062922,249.99820395803326,249.99397273699705,249.9757711928449,249.93622163355766,249.9237443875998,249.8745494553534,249.8403317579074,249.76631757247833,249.69897513197904,249.64258271217653,249.601907793346,249.59131314427128,249.5735774690165,249.5509299024034,249.54692793312284,249.53623637628513,249.5315097522781,249.44254341051024,249.43876303267456,249.42302083654877,249.34208972513176,249.32770551478106,249.28645107797837,249.23439908755157,249.23132229744155,249.19359148446614,249.1756398764256,249.12347595752763,249.06806432008224,249.06779752508456,249.05408404307911,249.0466532510028,249.03338437324015,249.0293595944898,249.0069577721323,248.95594860673717,248.93818874382856,248.85001767649072,248.84710600757313,248.81731370746866,248.81200095864,248.715255170957,248.6474533334307,248.5946229637861,248.5453320253374,248.10470480063816,248.036342192946,247.99805432418344,247.95478667624351,247.91756451103944,247.8459031344397,247.84531741155521,247.82797608195597,247.72913237974583,247.6880292939696,247.67714930782367,247.54850067707508,247.45189428526166,247.3228768969651,247.2824252557445,247.23430022708123,247.2187599525613,247.21499060270344,247.18417549805056,247.08454171776089,247.07379694904435,246.9483978961449,246.93819203588805,246.9329806542321,246.9297936915134,246.91549929183475,246.88889621439566,246.87693350036517,246.87014495233652,246.85491335216122,246.8466754656345,246.8330326712435,246.7975324811852,246.7966328595265,246.7708219799998,246.76748419962024,246.70039001233718,246.63240544718477,246.5530239003809,246.54491836043098,246.52900412052946,246.52724877182894,246.5202473940606,246.49526997934808,246.45061583368354,246.39669281924515,246.39233446682547,246.3646076924235,246.3248684592748,246.12247225927254,246.06786130705956,245.9386287282104,245.8952288776615,245.87293792033617,245.8291107660423,245.81131393947123,245.59531440545396,245.2506779087967,245.24306360624274,245.04272389006618,245.03444932443062,245.0044282830369,245.00032730186857,244.89882525825007,244.87001046662323,244.83133140613947,244.8130822219351,244.735056033697,244.71048809207963,244.67191282806547,244.60336304511281,244.5503947417949,244.52933839535277,244.51484992619018,244.42747413847346,244.3925754563647,244.37427435558823,244.31833372042385,244.18352159639994,244.18151482607672,244.11856720348536,244.0433079813144,243.9926569876066,243.89976499514603,243.81303888262792,243.71787989513362,243.5578486116136,243.4844016420297,243.41518004974213,243.06320452451152,242.59257262799576,242.5575976058383,242.53811607060751,242.39496755297253,242.3126724182856,242.24112981266077,242.13325884191954,241.35515509650668,241.22292863924312,241.01633277427834,240.44873366986144,239.65353027330644,239.41757172809807,238.45025830574502,237.81243088650433,237.56902180189667,237.1921106731761,236.746084696873,236.62024877143563,236.5784901259227,236.54455753590486,236.29767152715198,236.1251088808414,235.71217827168843,235.59815470978322,235.56659562702953,235.5064054737806,235.50200178084023,235.32363624859826,235.1530817941213,234.78883621201365,234.7842264416342,233.88968100995518,233.86534580648097,233.73250530662142,233.35861679862694,232.40501233581278,232.2452978162451,232.09178683059363,230.83581148730883,230.26122628450884,228.92777064317576,228.80629052816326,226.83386867318737,226.51751873373857,224.9226386564568,224.80153432311596,224.0748308570321,219.49713383251495,219.20987282025638,218.77993702337105,218.41806688953807,217.80025690977425,217.40827672714298,216.6821882290363,215.7922045784447,215.64139788548187,214.3229148696165,213.89638644471287,207.2404111788672,206.53254668600772,206.47654484786344,206.3714721596984,206.33784872823287,205.37754641281364,205.23876419568765,205.1286620683715,204.19719396680864,203.41388936963338,202.8998814703424,202.6602470781357,202.22338701335968,202.05550719212576,201.73223320146295,201.6414990954393,201.50942960890572)
                par(mfrow=c(1,2))
                L = length(ts)

                # # First plot
                # plot(ts, 1:L , xlim=c(-max(ts)-1,-190), pch=20, type="n", main=title,xlab="Time (Ma)",ylab="Lineages")
                # for (i in 1:L){segments(x0=-te[i],y0=i,x1=-ts[i],y1=i)}  

                # Create data frame for diversity trajectory
                diversity_df <- data.frame(
                    time = -time_events,
                    diversity = div_traj
                    )  

                # Function to format axis labels without negative signs
                format_labels <- function(x) {
                return(sprintf("%.0f", abs(x)))
                }

                # Plot 2: Diversity trajectory
                p2 <- ggplot(diversity_df, aes(x = time, y = diversity)) +
                coord_geo(xlim = c(-300, -200), expand=FALSE, clip = "on",
                        dat = list("international epochs", "international periods"), abbrv = list(TRUE, FALSE), 
                        pos = list("bottom", "bottom"), alpha = 1, height = unit(2, "line"),
                        rot = 0, size = list(6,5), neg = T) +
                geom_step() +
                geom_vline(xintercept = c(-65, -200, -251, -367, -445), 
                            linetype = "dashed", color = "gray") +
                scale_x_continuous(limits = c(-max(ts)-1, -200),
                                    breaks = seq(-300, -200, by = 10),
                                    labels = format_labels) +
                labs(title = "Temnospondyli Diversity trajectory",
                    x = "Time (Ma)",
                    y = "Number of lineages") +
                theme_classic() +
                theme(plot.margin = unit(c(2, 1, 1, 1), "cm"),
                    plot.title = element_text(size = 32, face = "bold", hjust = 0.5, margin = margin(b = 30)),
                    axis.title = element_text(size = 24, face = "bold", margin = margin(t = 20, r = 20, b = 20, l = 20)),
                    axis.text = element_text(size = 20, face = "bold"))

                # Display plots in RStudio
                grid.arrange(p2, ncol = 1)

                # Save to PDF
                pdf("C:\\Users\\SimoesLabAdmin\\Documents\\BDNN_Arielli\\temnospondyli\\mcmc_no_predictors\\RJMCMC\\temnospondyli_LTT.pdf", width = 20, height = 20)
                grid.arrange(p2, ncol = 1)
                dev.off()