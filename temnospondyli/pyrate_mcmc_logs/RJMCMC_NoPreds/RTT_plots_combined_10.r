

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/temnospondyli/pyrate_mcmc_logs/RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-203.049067095, -204.11947328500003,-205.189879475,-206.26028566500003,-207.330691855,-208.40109804500003,-209.471504235,-210.54191042500003,-211.612316615,-212.68272280500003,-213.753128995,-214.82353518500003,-215.893941375,-216.96434756500003,-218.034753755,-219.10515994500003,-220.175566135,-221.24597232500003,-222.316378515,-223.38678470500003,-224.457190895,-225.52759708500002,-226.598003275,-227.66840946500002,-228.738815655,-229.80922184500002,-230.879628035,-231.95003422500002,-233.020440415,-234.09084660500002,-235.161252795,-236.23165898500002,-237.302065175,-238.37247136500002,-239.442877555,-240.51328374500002,-241.583689935,-242.65409612500002,-243.724502315,-244.79490850500002,-245.865314695,-246.93572088500002,-248.006127075,-249.07653326500002,-250.146939455,-251.21734564500002,-252.287751835,-253.35815802500002,-254.428564215,-255.49897040500002,-256.56937659500005,-257.639782785,-258.710188975,-259.780595165,-260.85100135500005,-261.921407545,-262.991813735,-264.062219925,-265.13262611500005,-266.203032305,-267.273438495,-268.343844685,-269.41425087500005,-270.484657065,-271.555063255,-272.625469445,-273.69587563500005,-274.766281825,-275.836688015,-276.907094205,-277.97750039500005,-279.047906585,-280.118312775,-281.188718965,-282.25912515500005,-283.329531345,-284.399937535,-285.470343725,-286.54074991500005,-287.611156105,-288.681562295,-289.751968485,-290.82237467500005,-291.892780865,-292.963187055,-294.033593245,-295.10399943500005,-296.174405625,-297.244811815,-298.315218005,-299.38562419500005,-300.456030385,-301.526436575,-302.596842765,-303.66724895500005,-304.737655145,-305.808061335,-306.878467525,-307.94887371500005,-309.019279905)
rate=c(0.02418712352950747, 0.02416526015265455,0.024158825108776434,0.024158825108776434,0.02415943995885243,0.0241599154402284,0.024159922373254684,0.024160971087713465,0.02416236273161705,0.024163714802773045,0.024165816998243696,0.024173497563970234,0.02418448748147939,0.024199443897796935,0.024211857151744964,0.02422827609694233,0.02424560645142779,0.024282100451159822,0.02432976154912806,0.024387237971664755,0.02452197733084148,0.024848273913091398,0.025303301399661554,0.025725043124976053,0.02619488091959979,0.02690725722673236,0.027983939263885593,0.029221776292478897,0.031386490611770956,0.03724827476612283,0.11624186748875011,0.17702605527303567,0.22349402542492935,0.22550980705800633,0.22600367293589596,0.22721065083005776,0.22762948651966938,0.22859155080988958,0.23094826407749686,0.23770956712983177,0.26072850989505825,0.3011449612107728,0.30510208105407954,0.30398817136319656,0.3039011579877309,0.30852988976270435,1.9264791944227753,0.11697652558664029,0.09246013352731378,0.09156141920772223,0.0914877028632062,0.09143063822501961,0.09142032997410687,0.0913484784923054,0.09120387812715022,0.09105978575314642,0.09085437827543252,0.09062845471960561,0.09056019635412922,0.09047010428520244,0.09020306051797039,0.08779802848773818,0.08476313732432102,0.08245766929734483,0.08091820187770012,0.07976662470257326,0.07858898417196458,0.07607171190433043,0.07372897060372212,0.07182979979080636,0.06848874574843372,0.06534943057909172,0.0640385897081617,0.06366670837916114,0.06354049504923479,0.06347583900377572,0.06344930300223862,0.06344930300223862,0.06349439596345435,0.06365743243227648,0.0638893207610183,0.06434530059821152,0.06460130228545075,0.06473222155492217,0.06498374370406705,0.0651566422906682,0.06543371631401235,0.06633425012641525,0.0729069480926264,0.0924337484396473,0.2842409308746611,0.2981120705283432,0.3037499181389608,0.3073290175291431,0.30847304047137625,0.3085448786818368,0.3086451889975679,0.30876811221883504,0.31189493371347055,0.33793115357445447)
minHPD=c(0.007531274290502142, 0.00753622990671462,0.007649910678998141,0.007567477482754343,0.007568870325054388,0.0075935331977245646,0.007599723887775216,0.007611786846115032,0.007531274290502142,0.007611786846115032,0.007610937465487986,0.007608722545017287,0.0075935331977245646,0.007568870325054388,0.00767755770345168,0.0076189430546379,0.007681191215750186,0.007676875502820546,0.0075631481154083855,0.0075653132366769685,0.00720922649374376,0.006129948152560766,0.003528637487108255,0.005909860015400134,0.00767755770345168,0.007933049017420866,0.008410720735350107,0.00877539142524024,0.00877539142524024,0.008884647015435133,0.011775100905627897,0.015534377258507934,0.08393562410128472,0.08676927190467426,0.08644869312330057,0.08737086855272184,0.08746471071220037,0.08737086855272184,0.08737086855272184,0.08662979920683504,0.09034472932102998,0.1308498410832844,0.20431470543398103,0.20592729753752023,0.20652639546388651,0.1959408564281656,1.0330355184337525,0.045767771168885765,0.050999987743032334,0.05168786169570942,0.05242496715759512,0.05259312456971181,0.05168786169570942,0.051818726264590866,0.05177390067750504,0.05242496715759512,0.051818726264590866,0.05173273493858286,0.05177390067750504,0.05153388033731122,0.05073098643268271,0.0487631720204029,0.04574130679718441,0.04314049643763425,0.04236802517001539,0.04040501526828131,0.03917574169163644,0.03774945929963532,0.0361198889861233,0.03486582005145578,0.028843370990684177,0.024081358420064848,0.024796662644830134,0.025448179697492593,0.02545710383444905,0.02568785653378891,0.02576060163002052,0.026061255316347086,0.027431269756419668,0.027876365593263272,0.029013078658278887,0.03034498080028249,0.031011852646028373,0.030931816626894013,0.031008948438542846,0.030431973216047195,0.02955243941549357,0.022952209044503652,0.030118343362656244,0.03334455065073734,0.04778432224494453,0.07170186587659277,0.1728194656400393,0.1784055917637081,0.18154360207118475,0.17964085602248894,0.17964085602248894,0.17880128655168084,0.16369982109381306,0.16358686547452764)
maxHPD=c(0.04354837535958902, 0.043320489844819496,0.043320489844819496,0.04319850121638267,0.04317903435004532,0.043185160392153386,0.04318132684299908,0.04317903435004532,0.043093514308327203,0.04317903435004532,0.04317903435004532,0.04318132684299908,0.043185160392153386,0.043176240195019644,0.043320489844819496,0.043324995614562906,0.043502893655917446,0.04372179388053163,0.04384514665740728,0.044290896115968,0.04522201552124802,0.04804725824948675,0.07139157257950533,0.09997895953388165,0.11326684484686322,0.12557741394578045,0.1380843130108084,0.14899127776667825,0.17285064214162696,0.24014667443022514,0.2854289250008776,0.3111408687567717,0.3350939741534418,0.330907498737883,0.3292700386070069,0.32861342892822465,0.32861342892822465,0.32892951247820934,0.33112158344904025,0.3415809833162391,0.3972025568018397,0.5044439570982041,0.47599468648264565,0.46511693670603915,0.4652532401866321,0.49966503770517506,3.0241912878913793,1.9002306863483356,0.19295965650523578,0.18270004696486522,0.18274129881169812,0.18251591147339274,0.18144577477629897,0.18126511227531591,0.18067398071667637,0.1808391730265163,0.1796691495305325,0.1790488696206697,0.1790488696206697,0.1791109432148444,0.1790488696206697,0.1763112855366342,0.17112945846795968,0.16553823915919094,0.16321437229038063,0.16026675880293625,0.1578170320570442,0.151084442538062,0.14301220736762094,0.137230120541602,0.12531809883997214,0.10824890720148485,0.10228341678541099,0.10109809586593688,0.10028661538705617,0.10029705305552772,0.10025649123403811,0.10028661538705617,0.10046818039263875,0.09881113018167997,0.09809728255555432,0.09727302933061259,0.09723730325736085,0.09726517453128557,0.09763382509496103,0.09809179624975817,0.10022956997160196,0.17862097983964617,0.30074296601444567,0.3432609950509072,0.42131962680414115,0.4366755666484208,0.4885427280102973,0.46479462829643625,0.4659208194420687,0.4657478429299226,0.46943139082128194,0.47378300739504847,0.5264527671892592,1.528683726773804)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.3266104166805173), xlim = c(-309.554483,-202.513864), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (combined_10_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-203.0544731868687, -204.13569156060606,-205.21690993434345,-206.2981283080808,-207.3793466818182,-208.46056505555555,-209.54178342929293,-210.62300180303032,-211.70422017676768,-212.78543855050506,-213.86665692424242,-214.9478752979798,-216.02909367171716,-217.11031204545455,-218.19153041919193,-219.2727487929293,-220.35396716666668,-221.43518554040404,-222.51640391414142,-223.5976222878788,-224.67884066161616,-225.76005903535355,-226.8412774090909,-227.9224957828283,-229.00371415656568,-230.08493253030304,-231.16615090404042,-232.24736927777778,-233.32858765151516,-234.40980602525252,-235.4910243989899,-236.57224277272726,-237.65346114646465,-238.73467952020204,-239.8158978939394,-240.89711626767678,-241.97833464141414,-243.05955301515152,-244.1407713888889,-245.22198976262627,-246.30320813636365,-247.384426510101,-248.4656448838384,-249.54686325757578,-250.62808163131314,-251.7093000050505,-252.79051837878788,-253.87173675252527,-254.95295512626262,-256.03417350000007,-257.1153918737374,-258.1966102474747,-259.27782862121217,-260.3590469949495,-261.4402653686868,-262.52148374242427,-263.6027021161616,-264.68392048989904,-265.76513886363637,-266.8463572373737,-267.92757561111114,-269.00879398484847,-270.0900123585859,-271.17123073232324,-272.25244910606057,-273.333667479798,-274.41488585353534,-275.4961042272728,-276.5773226010101,-277.65854097474744,-278.7397593484849,-279.8209777222222,-280.90219609595965,-281.983414469697,-283.0646328434343,-284.14585121717175,-285.2270695909091,-286.3082879646465,-287.38950633838385,-288.4707247121212,-289.5519430858586,-290.63316145959595,-291.7143798333334,-292.7955982070707,-293.87681658080805,-294.9580349545455,-296.0392533282828,-297.12047170202027,-298.2016900757576,-299.2829084494949,-300.36412682323237,-301.4453451969697,-302.52656357070714,-303.60778194444447,-304.6890003181818,-305.77021869191924,-306.85143706565657,-307.9326554393939,-309.01387381313134)
counts=c(0.001550561797752809, 0.0009662921348314607,0.0005393258426966292,0.00044943820224719103,0.00047191011235955056,0.0002584269662921348,0.00023595505617977528,0.0002696629213483146,0.00021348314606741572,0.00041573033707865167,0.0004606741573033708,0.0006179775280898876,0.0009887640449438202,0.0010112359550561798,0.0011685393258426967,0.0014157303370786517,0.002303370786516854,0.00250561797752809,0.0035393258426966293,0.008224719101123596,0.019112359550561796,0.020617977528089887,0.021280898876404494,0.027157303370786517,0.042853932584269665,0.05302247191011236,0.05543820224719101,0.09149438202247191,0.12021348314606742,0.22886516853932584,0.2297191011235955,0.07376404494382023,0.004887640449438202,0.005044943820224719,0.004887640449438202,0.003056179775280899,0.0063370786516853935,0.014662921348314607,0.05203370786516854,0.18965168539325844,0.20152808988764045,0.034764044943820224,0.004022471910112359,0.003764044943820225,0.39164044943820225,0.6713932584269663,0.8722359550561798,0.06555056179775282,0.00451685393258427,0.0016067415730337078,0.0014831460674157304,0.001101123595505618,0.0017303370786516854,0.0024719101123595504,0.002044943820224719,0.002966292134831461,0.0022247191011235956,0.002112359550561798,0.002764044943820225,0.01357303370786517,0.033134831460674155,0.03451685393258427,0.027089887640449437,0.01955056179775281,0.018348314606741575,0.03506741573033708,0.0540561797752809,0.042853932584269665,0.0608314606741573,0.07877528089887641,0.03995505617977528,0.011191011235955057,0.00447191011235955,0.0020674157303370785,0.0011573033707865169,0.0011123595505617978,0.0026292134831460675,0.005786516853932585,0.006561797752808989,0.010606741573033708,0.008719101123595505,0.0032808988764044945,0.00698876404494382,0.005123595505617978,0.00903370786516854,0.033651685393258426,0.15407865168539325,0.22432584269662922,0.37747191011235953,0.1272247191011236,0.04706741573033708,0.025348314606741574,0.01196629213483146,0.004685393258426966,0.003797752808988764,0.004808988764044944,0.027112359550561797,0.17084269662921348,0.6472584269662921)
plot(mids,counts,type = 'h', xlim = c(-309.554483,-202.513864), ylim=c(0,0.8722359550561798), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03424893048592237
bf6 = 0.2076332959200362
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-203.049067095, -204.11947328500003,-205.189879475,-206.26028566500003,-207.330691855,-208.40109804500003,-209.471504235,-210.54191042500003,-211.612316615,-212.68272280500003,-213.753128995,-214.82353518500003,-215.893941375,-216.96434756500003,-218.034753755,-219.10515994500003,-220.175566135,-221.24597232500003,-222.316378515,-223.38678470500003,-224.457190895,-225.52759708500002,-226.598003275,-227.66840946500002,-228.738815655,-229.80922184500002,-230.879628035,-231.95003422500002,-233.020440415,-234.09084660500002,-235.161252795,-236.23165898500002,-237.302065175,-238.37247136500002,-239.442877555,-240.51328374500002,-241.583689935,-242.65409612500002,-243.724502315,-244.79490850500002,-245.865314695,-246.93572088500002,-248.006127075,-249.07653326500002,-250.146939455,-251.21734564500002,-252.287751835,-253.35815802500002,-254.428564215,-255.49897040500002,-256.56937659500005,-257.639782785,-258.710188975,-259.780595165,-260.85100135500005,-261.921407545,-262.991813735,-264.062219925,-265.13262611500005,-266.203032305,-267.273438495,-268.343844685,-269.41425087500005,-270.484657065,-271.555063255,-272.625469445,-273.69587563500005,-274.766281825,-275.836688015,-276.907094205,-277.97750039500005,-279.047906585,-280.118312775,-281.188718965,-282.25912515500005,-283.329531345,-284.399937535,-285.470343725,-286.54074991500005,-287.611156105,-288.681562295,-289.751968485,-290.82237467500005,-291.892780865,-292.963187055,-294.033593245,-295.10399943500005,-296.174405625,-297.244811815,-298.315218005,-299.38562419500005,-300.456030385,-301.526436575,-302.596842765,-303.66724895500005,-304.737655145,-305.808061335,-306.878467525,-307.94887371500005,-309.019279905)
rate=c(0.4130314146352023, 0.051015764410797734,0.04378287096112472,0.04019509796288638,0.03856850978911769,0.038228648971374964,0.03816546537937909,0.03813903971273122,0.03811903114312526,0.03810586767506108,0.038101866416856936,0.038102478839768424,0.03810586767506108,0.03811607779270446,0.038137777187102886,0.03816021100819254,0.03820883340235487,0.0382918764228614,0.03832626500814389,0.03837303074592044,0.038446111331607594,0.0385599965428783,0.038700114371874046,0.03896644237902143,0.039346982455753514,0.03989204341652407,0.04055205171920674,0.04188986054025788,0.04385110463965587,0.045450184412539354,0.048633994953126966,0.05242818645758376,0.06515276815680826,0.1359066104178435,0.14871479741747773,0.1591566382961101,0.23580843851089847,0.3797432382228385,0.3818809591785406,0.38376830776282234,0.38789770830072035,0.39641423701250345,0.41309135071665554,0.4057304528062148,0.4058017954116231,0.40721565335982646,0.42934076372266594,0.41028248777683274,0.3911921332016697,0.31748101607987245,0.15547256933909454,0.12691952102221551,0.11555013378455205,0.11350646690834712,0.11234685351093987,0.11174835538905911,0.11142331757375938,0.11085987103344361,0.10674423359057167,0.10003080669013095,0.09769863461815678,0.09702328933706246,0.09651765905920567,0.09603542672692414,0.09561816859483319,0.09512501747608797,0.09439239595577381,0.09328131730658662,0.09155646384974052,0.08974525696803241,0.08833611486671605,0.08740840671122742,0.08695406912587861,0.08670315021601521,0.08652797225547787,0.08642262039396771,0.08631331164383954,0.08623560840112904,0.0861677473414658,0.086105686061384,0.08606722870819386,0.08605208761954321,0.08603949776404524,0.08603507121327131,0.08603904646216362,0.08604422861936314,0.08605306768046941,0.08607732886190611,0.0861542834947572,0.08628548405642131,0.08685410752554637,0.08845786460721076,0.08906585079891344,0.08918283200248335,0.0894624726910338,0.09018067551901887,0.09293299500269137,0.09808778156469619,0.5031761103134161,0.5243255149854191)
minHPD=c(0.0029981636438845554, 6.184892426516235e-06,0.002159094752672523,6.184892426516235e-06,0.009111524127604579,0.009957630854288033,0.01092943508589366,0.01092943508589366,0.011051197658184074,0.01092943508589366,0.011035599449806949,0.011051975477775177,0.011080643914757281,0.0110853981644967,0.011087255333831845,0.011035599449806949,0.011076432014019682,0.011072543840926003,0.011059814728801154,0.011044993184485036,0.0110853981644967,0.011051197658184074,0.011097822329980633,0.010485892818468377,0.010314177905774375,0.009235326143916148,0.007706695371059864,0.007663556725564933,0.009758267320137086,0.010077983957248144,0.009128383430344694,0.012891124999270472,0.020922071778256262,0.02519612263995899,0.0265425319205037,0.027467799450976802,0.02857539625086351,0.1483266001990327,0.15531933290345132,0.16362311435711024,0.1673723676173281,0.1731903047630816,0.24919959154229493,0.27614393132088605,0.27614393132088605,0.2750336374527667,0.2666113609253544,0.07910577001631075,0.0775995950065893,0.07345585010230855,0.07211776066664508,0.07026576441563144,0.07034240295089232,0.07016435500638774,0.0700995479515686,0.07034011583684947,0.07026576441563144,0.06934812701216438,0.06618264976037125,0.05945036237733298,0.062355144246523914,0.062417117012657355,0.062403729372750474,0.06180161659550168,0.06231841502954851,0.061137418768980635,0.06118931711304754,0.0581196575011675,0.05545603711224187,0.05109764103880086,0.04899835429595621,0.050990969480381176,0.05297994343468534,0.05320306462965874,0.05448248477132658,0.05481951137916173,0.0555282851320574,0.05545603711224187,0.05551188367122914,0.05551188367122914,0.0555336965783079,0.05551188367122914,0.05551278959853054,0.05552461308849902,0.05560174078693684,0.05559457677712725,0.05559457677712725,0.05552461308849902,0.05552461308849902,0.05549046413368662,0.05259069563211943,0.046001965119303365,0.04849670895210948,0.04986913508978784,0.049662866374372304,0.049812192225909734,0.0506115300909486,0.05057835393149616,0.06531674710016036,0.17194322542077828)
maxHPD=c(1.9043110300383437, 1.0876755309113346,0.5826726748571851,0.27031371897838585,0.07108875687456286,0.0682680692604187,0.0685582354323586,0.06825311490669245,0.06817496998954305,0.06790844555367334,0.06793345967269344,0.06791234684669646,0.06791234684669646,0.06791234684669646,0.06790420442972758,0.0678140543962487,0.06779477554565912,0.06779477554565912,0.06783406082935609,0.06791171133704568,0.06812334336431226,0.06843319128195008,0.06905443465935632,0.06964130721000375,0.07136182489783158,0.07439233262673711,0.08196865229720325,0.12688206607774266,0.16910167057151881,0.19598190382504946,0.26452138191827373,0.3198829258071758,0.3838455200117149,0.41120245825683344,0.41476915100885714,0.41895112515102617,0.4447069659099905,0.5052473033515864,0.5048469938915596,0.5109781208448838,0.5150819005174138,0.5380653077956598,1.3218494329931583,0.5496570435173754,0.5493586821607914,0.5628547215234935,1.1478053352966848,0.745783345070285,0.5621157576157871,0.49338058471802143,0.4373298267289903,0.4080014331477894,0.39222473320144013,0.3868045721857568,0.3831650348550487,0.38231984080995784,0.3817543641234693,0.3801976353425681,0.3658888887311163,0.2655957366373177,0.21998895194183615,0.2140286703009947,0.2113150389092639,0.20860649692859481,0.2079119981734033,0.20508688408099685,0.2026867115459717,0.19400032951296842,0.18127782932004985,0.1589912096605309,0.13424560326372798,0.11943330637359244,0.11701811588520236,0.11545775160845642,0.11537305304087614,0.11507369072978178,0.11518028115706784,0.11475533817010773,0.11455869083150248,0.11436357877886624,0.1143506469396821,0.11430002426184427,0.11428658888247434,0.11428590745301193,0.1143506469396821,0.11436357877886624,0.11436191800620027,0.11436357877886624,0.11468217559167274,0.115215708161325,0.11620177381159257,0.19713728184016713,0.22766673826753814,0.2351495025774724,0.2494422643900455,0.287951353554717,0.4354021496385959,0.5556867456352106,0.8996063365860086,0.9568602996300126)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.0947421330421783), xlim = c(-309.554483,-202.513864), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-203.0544731868687, -204.13569156060606,-205.21690993434345,-206.2981283080808,-207.3793466818182,-208.46056505555555,-209.54178342929293,-210.62300180303032,-211.70422017676768,-212.78543855050506,-213.86665692424242,-214.9478752979798,-216.02909367171716,-217.11031204545455,-218.19153041919193,-219.2727487929293,-220.35396716666668,-221.43518554040404,-222.51640391414142,-223.5976222878788,-224.67884066161616,-225.76005903535355,-226.8412774090909,-227.9224957828283,-229.00371415656568,-230.08493253030304,-231.16615090404042,-232.24736927777778,-233.32858765151516,-234.40980602525252,-235.4910243989899,-236.57224277272726,-237.65346114646465,-238.73467952020204,-239.8158978939394,-240.89711626767678,-241.97833464141414,-243.05955301515152,-244.1407713888889,-245.22198976262627,-246.30320813636365,-247.384426510101,-248.4656448838384,-249.54686325757578,-250.62808163131314,-251.7093000050505,-252.79051837878788,-253.87173675252527,-254.95295512626262,-256.03417350000007,-257.1153918737374,-258.1966102474747,-259.27782862121217,-260.3590469949495,-261.4402653686868,-262.52148374242427,-263.6027021161616,-264.68392048989904,-265.76513886363637,-266.8463572373737,-267.92757561111114,-269.00879398484847,-270.0900123585859,-271.17123073232324,-272.25244910606057,-273.333667479798,-274.41488585353534,-275.4961042272728,-276.5773226010101,-277.65854097474744,-278.7397593484849,-279.8209777222222,-280.90219609595965,-281.983414469697,-283.0646328434343,-284.14585121717175,-285.2270695909091,-286.3082879646465,-287.38950633838385,-288.4707247121212,-289.5519430858586,-290.63316145959595,-291.7143798333334,-292.7955982070707,-293.87681658080805,-294.9580349545455,-296.0392533282828,-297.12047170202027,-298.2016900757576,-299.2829084494949,-300.36412682323237,-301.4453451969697,-302.52656357070714,-303.60778194444447,-304.6890003181818,-305.77021869191924,-306.85143706565657,-307.9326554393939,-309.01387381313134)
counts=c(0.2570674157303371, 0.17348314606741572,0.1197752808988764,0.052764044943820226,0.01301123595505618,0.00350561797752809,0.0017865168539325843,0.00149438202247191,0.0009213483146067416,0.0007415730337078652,0.0006067415730337079,0.0006629213483146068,0.0006853932584269663,0.0008539325842696629,0.0011348314606741572,0.0022696629213483145,0.0021573033707865167,0.0014382022471910113,0.0017865168539325843,0.002258426966292135,0.003112359550561798,0.004797752808988764,0.00798876404494382,0.010674157303370787,0.014224719101123596,0.019224719101123597,0.03807865168539326,0.045539325842696626,0.048741573033707866,0.07024719101123596,0.0948876404494382,0.145,0.08789887640449438,0.016213483146067416,0.0361123595505618,0.25502247191011235,0.23504494382022473,0.012258426966292134,0.017370786516853934,0.0389438202247191,0.11991011235955056,0.06079775280898876,0.028247191011235954,0.0039101123595505615,0.14259550561797754,0.06219101123595506,0.11421348314606741,0.1603370786516854,0.2742022471910112,0.14391011235955056,0.06312359550561798,0.027112359550561797,0.011067415730337078,0.008134831460674157,0.00401123595505618,0.004426966292134831,0.009741573033707865,0.08197752808988765,0.0738314606741573,0.023157303370786517,0.012752808988764045,0.011808988764044943,0.011168539325842696,0.011325842696629214,0.01656179775280899,0.024415730337078653,0.039269662921348314,0.04978651685393259,0.04396629213483146,0.031696629213483145,0.016853932584269662,0.008056179775280899,0.006146067415730337,0.004179775280898876,0.0034719101123595504,0.003089887640449438,0.0023932584269662923,0.0018651685393258426,0.001898876404494382,0.0009101123595505618,0.0006853932584269663,0.000550561797752809,0.00047191011235955056,0.0007078651685393258,0.0007303370786516854,0.0010112359550561798,0.002460674157303371,0.004022471910112359,0.014303370786516854,0.043808988764044945,0.026213483146067414,0.0057752808988764046,0.010943820224719101,0.026674157303370787,0.08947191011235955,0.12779775280898875,0.6028426966292135,0.06769662921348314,0.007707865168539326)
plot(mids,counts,type = 'h', xlim = c(-309.554483,-202.513864), ylim=c(0,0.6028426966292135), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-203.049067095, -204.11947328500003,-205.189879475,-206.26028566500003,-207.330691855,-208.40109804500003,-209.471504235,-210.54191042500003,-211.612316615,-212.68272280500003,-213.753128995,-214.82353518500003,-215.893941375,-216.96434756500003,-218.034753755,-219.10515994500003,-220.175566135,-221.24597232500003,-222.316378515,-223.38678470500003,-224.457190895,-225.52759708500002,-226.598003275,-227.66840946500002,-228.738815655,-229.80922184500002,-230.879628035,-231.95003422500002,-233.020440415,-234.09084660500002,-235.161252795,-236.23165898500002,-237.302065175,-238.37247136500002,-239.442877555,-240.51328374500002,-241.583689935,-242.65409612500002,-243.724502315,-244.79490850500002,-245.865314695,-246.93572088500002,-248.006127075,-249.07653326500002,-250.146939455,-251.21734564500002,-252.287751835,-253.35815802500002,-254.428564215,-255.49897040500002,-256.56937659500005,-257.639782785,-258.710188975,-259.780595165,-260.85100135500005,-261.921407545,-262.991813735,-264.062219925,-265.13262611500005,-266.203032305,-267.273438495,-268.343844685,-269.41425087500005,-270.484657065,-271.555063255,-272.625469445,-273.69587563500005,-274.766281825,-275.836688015,-276.907094205,-277.97750039500005,-279.047906585,-280.118312775,-281.188718965,-282.25912515500005,-283.329531345,-284.399937535,-285.470343725,-286.54074991500005,-287.611156105,-288.681562295,-289.751968485,-290.82237467500005,-291.892780865,-292.963187055,-294.033593245,-295.10399943500005,-296.174405625,-297.244811815,-298.315218005,-299.38562419500005,-300.456030385,-301.526436575,-302.596842765,-303.66724895500005,-304.737655145,-305.808061335,-306.878467525,-307.94887371500005,-309.019279905)
net_rate=c(-0.5609629032404865, -0.24318576335205772,-0.10073729537755335,-0.03634136418336248,-0.018176487894685026,-0.014705777141677652,-0.014117730101008986,-0.013920814158152914,-0.01380720395513796,-0.013734882365648505,-0.013692826678096069,-0.013673230988352138,-0.013659718769089241,-0.013643215727450054,-0.013631372568526959,-0.013612979802691954,-0.013616491443576522,-0.013600760852366604,-0.013483119170800487,-0.013319917189362927,-0.012850419648943382,-0.011524296331125802,-0.009685043126247695,-0.00820286287058657,-0.006635370234931697,-0.004005551996254554,-0.00020393532092685088,0.0018680673181838692,0.005031542538947415,0.018199373232478153,0.04161843207107558,0.08410718769078923,0.07136869274389508,0.03526362678317655,0.029133938454069634,0.02417978849850956,-0.018361173612375353,-0.14749396343595775,-0.14964998821786488,-0.146510977070638,-0.12320946806169751,-0.05356198705234775,-0.16232384921943116,-0.08885992154387069,-0.0890398999273968,-0.06180058347509843,1.468413641277199,0.08219732627193223,-0.24834794201788368,-0.1748147473801095,-0.10328105223279396,-0.07763473573088102,-0.06545746701628256,-0.06170597348440511,-0.05948919332590297,-0.058664961169979435,-0.05840770339838641,-0.057888189397984485,-0.04852416486223214,-0.023963014741327105,-0.013786695752188605,-0.014125670105680237,-0.016373761958315785,-0.018151730170672935,-0.019224289172436734,-0.019524181547465665,-0.019203429256224227,-0.0200809423881323,-0.019286344222644376,-0.01749152715504706,-0.01994583103625293,-0.02338373654353351,-0.024413527500299455,-0.02439669291240666,-0.024213552070294093,-0.024046636948705888,-0.023855176476582206,-0.023695558110297246,-0.02344537178988926,-0.02301251859487697,-0.022534801352745167,-0.021690140129678234,-0.02116389550788343,-0.02088845887815745,-0.020276358708678253,-0.01964035565301384,-0.018179020129492678,-0.01132286805440534,0.025513339835123747,0.07720427536620769,0.1791846732360661,0.19820568024833574,0.20679164628329336,0.21395612258173155,0.21440849356470737,0.20688463446526115,0.17662001763208157,0.12490820639511681,-0.17759876923353024,-0.03381524086096408)
net_minHPD=c(-1.8818046220363187, -1.0673116623645296,-0.5634511506869334,-0.2517703904956368,-0.05067000567173807,-0.04764815553809995,-0.047676926951191884,-0.046594263521239576,-0.046504026402709175,-0.04634524793589088,-0.04626380129155584,-0.04630147545344236,-0.04626380129155584,-0.04626380129155584,-0.04630147545344236,-0.04646743526568907,-0.04659283871819911,-0.04687811897165017,-0.047389040298495486,-0.04817744029308231,-0.050352959530707585,-0.05410780668350986,-0.06580249966388159,-0.05724101766804496,-0.0572904281050636,-0.057169303970091144,-0.060868161328597535,-0.10029874955421339,-0.14800603641204213,-0.1394334882842106,-0.16631142932741208,-0.1722340824140166,-0.20640712722299673,-0.21684922126858772,-0.21844430563038056,-0.2252107001110523,-0.26524708647632633,-0.3494923540674771,-0.3460623621175132,-0.3506393934343154,-0.34535979649040605,-0.32001099510810305,-0.8829376190793021,-0.2675682689353751,-0.2675456044040333,-0.3162591848748595,0.42498129889447256,-0.8380386468122706,-0.5374565979192821,-0.41912308653178654,-0.35191047268784104,-0.3200999318983351,-0.3025410761471953,-0.2938670042614443,-0.29022542766290743,-0.2898599513510083,-0.29024473444265225,-0.2898599513510083,-0.27292944666269126,-0.15657363495561993,-0.11367447805356054,-0.1142200247593694,-0.11436603224952503,-0.12064771594267815,-0.1216343711365741,-0.12164337076067817,-0.12136658421014454,-0.12777726303375017,-0.1177407037076712,-0.09458486556675104,-0.08243487719224937,-0.07867765773416172,-0.07216829082119436,-0.0719289837028095,-0.06955316621986707,-0.06843000249440832,-0.06764018515124573,-0.06719811457635673,-0.06724147890245669,-0.06614640800163751,-0.06461760722995465,-0.06386579505180623,-0.06391104179976635,-0.06385840801601952,-0.06386280970564442,-0.06386579505180623,-0.06666079832069163,-0.07880617063577453,-0.06527035616914728,-0.05846596506892196,-0.038149632925157634,-0.02599808628546707,-0.01382765243842285,0.03879472892484903,0.030937446142514646,-0.01821478597521975,-0.17167266655157348,-0.3048653359715505,-0.6773060167342446,-0.767278387395649)
net_maxHPD=c(0.034154881639850795, 0.03561751538633587,0.03463732213530891,0.03572044001348852,0.02141677985207269,0.01965483499766666,0.018829633761082452,0.019564908800210532,0.01939503317906833,0.0193887499416375,0.019360114087386297,0.019297187028698155,0.019321023156807348,0.019368668606225665,0.01938816394593229,0.019314184483354625,0.019321023156807348,0.0193640786431291,0.0193887499416375,0.019527101174262415,0.019867543479806248,0.023928997519179963,0.04171507723133079,0.07618286811336794,0.08892365864298331,0.10474226558536595,0.12376399425264069,0.13962047981165188,0.15308661596633735,0.23883891625407858,0.2780443303544262,0.29870494825532456,0.2885861376088448,0.27637558268025986,0.2759027329187939,0.2752238037278585,0.27024767219479445,0.061925523376671454,0.05512868063483117,0.05655527058508472,0.11296620723597675,0.24009394405413556,0.20652072578976355,0.12021299832935067,0.11922329340333743,0.17255723825540403,2.636872130895943,1.6606990791706862,0.055418525354517176,0.0452578574602714,0.055049614671057165,0.05650547437266237,0.05733965013111314,0.06032797000856191,0.06094622179601432,0.0605354370122715,0.06046889644854479,0.06122130056482922,0.06762051217411884,0.09266993799558805,0.08795774858946888,0.08087319766726205,0.07919768536093058,0.07441512016495908,0.07441512016495908,0.07441512016495908,0.07443784198662688,0.07120798212067547,0.07081450106157641,0.0679458595521928,0.05261083809339147,0.026965590737829864,0.020839520833921113,0.01719268938229218,0.017188170655527357,0.017260303768082755,0.017136664977149885,0.016990625761050163,0.01618430106138119,0.01620908647939863,0.016990625761050163,0.017196086333553545,0.017305571769474823,0.0180000258197425,0.019091993128962426,0.02093784523579076,0.022606043801451224,0.09065808638393268,0.2170411620598199,0.2634356338808605,0.3428035026184158,0.35066543406257317,0.36100089995099416,0.3988364369721715,0.40731905193300755,0.41510170591147094,0.4081705229080055,0.4021122257116708,0.29615818713418113,1.0131508860008667)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-2.0699850842399505, 2.9005593439855373), xlim = c(-309.554483,-202.513864), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-203.049067095, -204.11947328500003,-205.189879475,-206.26028566500003,-207.330691855,-208.40109804500003,-209.471504235,-210.54191042500003,-211.612316615,-212.68272280500003,-213.753128995,-214.82353518500003,-215.893941375,-216.96434756500003,-218.034753755,-219.10515994500003,-220.175566135,-221.24597232500003,-222.316378515,-223.38678470500003,-224.457190895,-225.52759708500002,-226.598003275,-227.66840946500002,-228.738815655,-229.80922184500002,-230.879628035,-231.95003422500002,-233.020440415,-234.09084660500002,-235.161252795,-236.23165898500002,-237.302065175,-238.37247136500002,-239.442877555,-240.51328374500002,-241.583689935,-242.65409612500002,-243.724502315,-244.79490850500002,-245.865314695,-246.93572088500002,-248.006127075,-249.07653326500002,-250.146939455,-251.21734564500002,-252.287751835,-253.35815802500002,-254.428564215,-255.49897040500002,-256.56937659500005,-257.639782785,-258.710188975,-259.780595165,-260.85100135500005,-261.921407545,-262.991813735,-264.062219925,-265.13262611500005,-266.203032305,-267.273438495,-268.343844685,-269.41425087500005,-270.484657065,-271.555063255,-272.625469445,-273.69587563500005,-274.766281825,-275.836688015,-276.907094205,-277.97750039500005,-279.047906585,-280.118312775,-281.188718965,-282.25912515500005,-283.329531345,-284.399937535,-285.470343725,-286.54074991500005,-287.611156105,-288.681562295,-289.751968485,-290.82237467500005,-291.892780865,-292.963187055,-294.033593245,-295.10399943500005,-296.174405625,-297.244811815,-298.315218005,-299.38562419500005,-300.456030385,-301.526436575,-302.596842765,-303.66724895500005,-304.737655145,-305.808061335,-306.878467525,-307.94887371500005,-309.019279905)
rate=c(1.7048775970947674, 3.7267043472042265,7.955104601036087,16.31617368909301,23.18955917648405,25.22187277808005,25.601684807210937,25.731317320772888,25.807030395368802,25.853705672821146,25.880193298403118,25.888030056435568,25.88726621559945,25.878613229116137,25.862460449371707,25.841470020231473,25.793047540417234,25.717102109170327,25.67899685598657,25.628126965260435,25.557913042097532,25.44874045143391,25.266849017784686,24.91024080541243,24.40075205607164,23.58376562795538,22.53329336523718,20.481988362034052,17.62649314479801,15.654362210139995,12.59236639312283,10.34178382581458,7.194814508331174,5.669409007359601,5.468690173754649,5.295681257210755,4.317387084627907,2.767394584015693,2.737393939376046,2.7156999521972405,2.6669516003193787,2.561984357050718,2.040440452636722,2.4479131876569444,2.4486303991193066,2.425966558388971,1.9579489263936216,2.357511093104032,2.707393589556248,3.57313408769579,4.807142636227682,5.487886160534552,5.881914856684817,6.017349452599693,6.106371730662146,6.144737929127816,6.163876290095808,6.192082875521526,6.57456592898577,7.837117587615808,8.505348843960064,8.695114518574995,8.80481228081619,8.909375029690816,8.996225509108829,9.101044968920888,9.273690544876288,9.568029468774325,10.042932666213554,10.590962391571766,11.047028221482671,11.34802966441383,11.489148367325768,11.556880249703674,11.604953647522803,11.636417519396796,11.665770167306704,11.68530316102202,11.699686613090705,11.712319207485317,11.722879555005386,11.7267026278903,11.728915573083933,11.72965196226603,11.728831118360272,11.727696982055434,11.724837543146766,11.71741943629112,11.689803331885871,11.638925979732484,11.317352997419956,10.307950188568514,9.961612534705722,9.869316637897194,9.644491706482869,8.979698475061396,7.036498456888172,5.138415577250926,1.9503673972984097,1.8341026714086315)
minHPD=c(1.7048775970947674, 3.7267043472042265,7.955104601036087,16.31617368909301,23.18955917648405,25.22187277808005,25.601684807210937,25.731317320772888,25.807030395368802,25.853705672821146,25.880193298403118,25.888030056435568,25.88726621559945,25.878613229116137,25.862460449371707,25.841470020231473,25.793047540417234,25.717102109170327,25.67899685598657,25.628126965260435,25.557913042097532,25.44874045143391,25.266849017784686,24.91024080541243,24.40075205607164,23.58376562795538,22.53329336523718,20.481988362034052,17.62649314479801,15.654362210139995,12.59236639312283,10.34178382581458,7.194814508331174,5.669409007359601,5.468690173754649,5.295681257210755,4.317387084627907,2.767394584015693,2.737393939376046,2.7156999521972405,2.6669516003193787,2.561984357050718,2.040440452636722,2.4479131876569444,2.4486303991193066,2.425966558388971,1.9579489263936216,2.357511093104032,2.707393589556248,3.57313408769579,4.807142636227682,5.487886160534552,5.881914856684817,6.017349452599693,6.106371730662146,6.144737929127816,6.163876290095808,6.192082875521526,6.57456592898577,7.837117587615808,8.505348843960064,8.695114518574995,8.80481228081619,8.909375029690816,8.996225509108829,9.101044968920888,9.273690544876288,9.568029468774325,10.042932666213554,10.590962391571766,11.047028221482671,11.34802966441383,11.489148367325768,11.556880249703674,11.604953647522803,11.636417519396796,11.665770167306704,11.68530316102202,11.699686613090705,11.712319207485317,11.722879555005386,11.7267026278903,11.728915573083933,11.72965196226603,11.728831118360272,11.727696982055434,11.724837543146766,11.71741943629112,11.689803331885871,11.638925979732484,11.317352997419956,10.307950188568514,9.961612534705722,9.869316637897194,9.644491706482869,8.979698475061396,7.036498456888172,5.138415577250926,1.9503673972984097,1.8341026714086315)
maxHPD=c(1.7048775970947674, 3.7267043472042265,7.955104601036087,16.31617368909301,23.18955917648405,25.22187277808005,25.601684807210937,25.731317320772888,25.807030395368802,25.853705672821146,25.880193298403118,25.888030056435568,25.88726621559945,25.878613229116137,25.862460449371707,25.841470020231473,25.793047540417234,25.717102109170327,25.67899685598657,25.628126965260435,25.557913042097532,25.44874045143391,25.266849017784686,24.91024080541243,24.40075205607164,23.58376562795538,22.53329336523718,20.481988362034052,17.62649314479801,15.654362210139995,12.59236639312283,10.34178382581458,7.194814508331174,5.669409007359601,5.468690173754649,5.295681257210755,4.317387084627907,2.767394584015693,2.737393939376046,2.7156999521972405,2.6669516003193787,2.561984357050718,2.040440452636722,2.4479131876569444,2.4486303991193066,2.425966558388971,1.9579489263936216,2.357511093104032,2.707393589556248,3.57313408769579,4.807142636227682,5.487886160534552,5.881914856684817,6.017349452599693,6.106371730662146,6.144737929127816,6.163876290095808,6.192082875521526,6.57456592898577,7.837117587615808,8.505348843960064,8.695114518574995,8.80481228081619,8.909375029690816,8.996225509108829,9.101044968920888,9.273690544876288,9.568029468774325,10.042932666213554,10.590962391571766,11.047028221482671,11.34802966441383,11.489148367325768,11.556880249703674,11.604953647522803,11.636417519396796,11.665770167306704,11.68530316102202,11.699686613090705,11.712319207485317,11.722879555005386,11.7267026278903,11.728915573083933,11.72965196226603,11.728831118360272,11.727696982055434,11.724837543146766,11.71741943629112,11.689803331885871,11.638925979732484,11.317352997419956,10.307950188568514,9.961612534705722,9.869316637897194,9.644491706482869,8.979698475061396,7.036498456888172,5.138415577250926,1.9503673972984097,1.8341026714086315)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 28.476833062079127), xlim = c(-309.554483,-202.513864), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()