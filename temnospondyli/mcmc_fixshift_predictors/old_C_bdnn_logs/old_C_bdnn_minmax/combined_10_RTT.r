pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/temnospondyli/mcmc_fixshift_predictors/C_bdnn_minmax/tem_combined_10_RTT.pdf', width = 9, height = 6, useDingbats = FALSE)

layout(matrix(1:4, ncol = 2, nrow = 2, byrow = TRUE))
par(las = 1, mar = c(4.5, 4.5, 0.5, 0.5), oma=c(0,0,4,0))

time_vec=c(311.20731101509807, 290.10001,290.1,283.50001,283.5,273.00001,273.0,264.30001,264.3,259.50001,259.5,252.00001,252.0,247.00001,247.0,242.00001,242.0,237.00001,237.0,227.00001,227.0,217.00001,217.0,208.00001,208.0,198.55715924526797)
sp_mean=c(0.18778986855681645, 0.18778986855681645,0.026061031811873758,0.026061031811873758,0.028712607113352853,0.028712607113352853,0.08259380050137514,0.08259380050137514,0.10002785334935009,0.10002785334935009,0.14981638434279068,0.14981638434279068,0.5053237238450999,0.5053237238450999,0.16486159985148513,0.16486159985148513,0.09137130483298206,0.09137130483298206,0.029353560577735784,0.029353560577735784,0.013855392560201173,0.013855392560201173,0.012957980837138346,0.012957980837138346,0.01488678666044368,0.01488678666044368)
sp_lwr=c(0.14405483807821343, 0.14405483807821343,0.0074652812800636075,0.0074652812800636075,0.00952832286284204,0.00952832286284204,0.019376988262584556,0.019376988262584556,0.013873986912934221,0.013873986912934221,0.04081978946126249,0.04081978946126249,0.32371021062454747,0.32371021062454747,0.03412256574068065,0.03412256574068065,0.012501052399208557,0.012501052399208557,0.0019715851182838385,0.0019715851182838385,0.0010662574985771916,0.0010662574985771916,0.0005585327128303529,0.0005585327128303529,0.0007458542638310459,0.0007458542638310459)
sp_upr=c(0.23371421766426323, 0.23371421766426323,0.04749912290751781,0.04749912290751781,0.05078102804544808,0.05078102804544808,0.15486114740256535,0.15486114740256535,0.20177670030459244,0.20177670030459244,0.26783410060350055,0.26783410060350055,0.7111209768173072,0.7111209768173072,0.2937850698828,0.2937850698828,0.18004496955421337,0.18004496955421337,0.06446902998660849,0.06446902998660849,0.030109117184964833,0.030109117184964833,0.03034496816494323,0.03034496816494323,0.03449712054242382,0.03449712054242382)
ex_mean=c(0.10740017641672867, 0.10740017641672867,0.0633659514705236,0.0633659514705236,0.07378838048944122,0.07378838048944122,0.17205610353796283,0.17205610353796283,0.14502973518171494,0.14502973518171494,0.12068207174630582,0.12068207174630582,0.524181298632171,0.524181298632171,0.25990705733307595,0.25990705733307595,0.1296726558128996,0.1296726558128996,0.05792821086370863,0.05792821086370863,0.04296396433644786,0.04296396433644786,0.06752623495222013,0.06752623495222013,0.10696078664229632,0.10696078664229632)
ex_lwr=c(0.07465793391631595, 0.07465793391631595,0.02883484886661333,0.02883484886661333,0.03480581805330753,0.03480581805330753,0.0698844228031944,0.0698844228031944,0.07140049303667807,0.07140049303667807,0.0638206900074738,0.0638206900074738,0.3567110070103303,0.3567110070103303,0.1402113891037504,0.1402113891037504,0.04500943182438196,0.04500943182438196,0.021747813807199524,0.021747813807199524,0.010461181189684782,0.010461181189684782,0.02322677594392916,0.02322677594392916,0.03699159747876759,0.03699159747876759)
ex_upr=c(0.14234519358447614, 0.14234519358447614,0.09931705824332518,0.09931705824332518,0.11236443736509748,0.11236443736509748,0.285355421772809,0.285355421772809,0.2296524231559305,0.2296524231559305,0.1838547269881221,0.1838547269881221,0.7031428643307982,0.7031428643307982,0.3892754484896349,0.3892754484896349,0.2283779642904192,0.2283779642904192,0.09641847226136835,0.09641847226136835,0.07558233905332556,0.07558233905332556,0.11370822428543328,0.11370822428543328,0.20168632216753107,0.20168632216753107)
div_mean=c(0.08038969214008775, 0.08038969214008775,-0.037304919658649835,-0.037304919658649835,-0.04507577337608787,-0.04507577337608787,-0.08946230303658745,-0.08946230303658745,-0.045001881832366156,-0.045001881832366156,0.029134312596483403,0.029134312596483403,-0.018857574787064187,-0.018857574787064187,-0.09504545748159035,-0.09504545748159035,-0.03830135097991822,-0.03830135097991822,-0.028574650285973346,-0.028574650285973346,-0.029108571776247705,-0.029108571776247705,-0.0545682541150818,-0.0545682541150818,-0.09207399998185359,-0.09207399998185359)
div_lwr=c(0.02622686061840465, 0.02622686061840465,-0.07805627487060453,-0.07805627487060453,-0.08819109867828112,-0.08819109867828112,-0.2203313607578206,-0.2203313607578206,-0.17424493473133584,-0.17424493473133584,-0.09682263810773598,-0.09682263810773598,-0.21859574452372044,-0.21859574452372044,-0.27323496229852995,-0.27323496229852995,-0.16318880192419194,-0.16318880192419194,-0.07939482410507952,-0.07939482410507952,-0.06630148962688713,-0.06630148962688713,-0.10210371337426033,-0.10210371337426033,-0.19124016323230922,-0.19124016323230922)
div_upr=c(0.13424664469271486, 0.13424664469271486,-0.0006392409253071531,-0.0006392409253071531,-0.0035518531914695353,-0.0035518531914695353,0.02968485608259451,0.02968485608259451,0.08691256609109366,0.08691256609109366,0.15333938026258176,0.15333938026258176,0.1808014702941081,0.1808014702941081,0.07812542164780562,0.07812542164780562,0.08353998153245681,0.08353998153245681,0.024280758076402127,0.024280758076402127,0.005709802141953392,0.005709802141953392,-0.009965958025669151,-0.009965958025669151,-0.02022546335092145,-0.02022546335092145)
long_mean=c(9.562846149417862, 9.562846149417862,17.346639507341994,17.346639507341994,14.735486779023212,14.735486779023212,6.527497175931201,6.527497175931201,7.454435249222874,7.454435249222874,8.87213537794263,8.87213537794263,1.9644027961969461,1.9644027961969461,4.10373796640853,4.10373796640853,9.029965845138362,9.029965845138362,19.533355110206063,19.533355110206063,29.055018395269776,29.055018395269776,17.041201613786637,17.041201613786637,11.004497646219402,11.004497646219402)
long_lwr=c(6.672818119103517, 6.672818119103517,8.748862390083744,8.748862390083744,7.551672012481965,7.551672012481965,2.801859440221859,2.801859440221859,3.6434507175011572,3.6434507175011572,4.788400734258349,4.788400734258349,1.345529377388748,1.345529377388748,2.23255682756331,2.23255682756331,3.4174896336963374,3.4174896336963374,8.239949954678737,8.239949954678737,10.15021123736873,10.15021123736873,6.8693073832257685,6.8693073832257685,3.6572400371924045,3.6572400371924045)
long_upr=c(12.723066003948563, 12.723066003948563,29.110225272681795,29.110225272681795,23.946469108259,23.946469108259,11.161368347566778,11.161368347566778,11.61167475464465,11.61167475464465,13.683772960584921,13.683772960584921,2.647561347630737,2.647561347630737,6.218472591555901,6.218472591555901,16.759393187479674,16.759393187479674,34.279934666822946,34.279934666822946,61.63880666267853,61.63880666267853,31.221076230552544,31.221076230552544,19.741672063935116,19.741672063935116)
xlim = c(311.20731101509807, 198.55715924526797)
ylim = c(0.0005585327128303529, 0.7111209768173072)
not_NA = !is.na(sp_mean)
plot(time_vec[not_NA], sp_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Speciation rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(sp_lwr[not_NA], rev(sp_upr[not_NA])), col = adjustcolor('#4c4cec', alpha = 0.5), border = NA)
lines(time_vec[not_NA], sp_mean[not_NA], col = '#4c4cec', lwd = 2)
mtext("Temnospondyli BDNN", outer = TRUE, line = 0.5, cex = 2, font = 2)

ylim = c(0.010461181189684782, 0.7031428643307982)
not_NA = !is.na(ex_mean)
plot(time_vec[not_NA], ex_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Extinction rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(ex_lwr[not_NA], rev(ex_upr[not_NA])), col = adjustcolor('#e34a33', alpha = 0.5), border = NA)
lines(time_vec[not_NA], ex_mean[not_NA], col = '#e34a33', lwd = 2)
ylim = c(-0.27323496229852995, 0.1808014702941081)
not_NA = !is.na(div_mean)
plot(time_vec[not_NA], div_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Net diversification rate')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(div_lwr[not_NA], rev(div_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], div_mean[not_NA], col = 'black', lwd = 2)
abline(h = 0, col = 'red', lty = 2)
ylim = c(1.345529377388748, 61.63880666267853)
not_NA = !is.na(long_mean)
plot(time_vec[not_NA], long_mean[not_NA], type = 'n', xlim = xlim, ylim = ylim, xlab = 'Time (Ma)', ylab = 'Longevity (Myr)')
polygon(c(time_vec[not_NA], rev(time_vec[not_NA])), c(long_lwr[not_NA], rev(long_upr[not_NA])), col = adjustcolor('black', alpha = 0.3), border = NA)
lines(time_vec[not_NA], long_mean[not_NA], col = 'black', lwd = 2)
dev.off()