# Required libraries
library(ggplot2)
library(gridExtra)
library(deeptime)   # For coordinate system


# Data preparation
ts=c(117.01521080584229, 76.51431319961331,119.51112900914453,123.43630586932078,121.86355857192858,130.1759510271781,133.63437762427358,57.05062440152668,135.0642910248447,94.72929790956566,61.63454022823587,127.40357571734131,77.39815083586485,104.30866050057222,86.86580809031211,125.68294738101535,61.434950729952554,127.48781313845708,76.64942190962122,77.82872615842399,50.692506209246766,124.02384064904058,74.46720864347382,97.56701320225781,127.9340939480661,127.2508672158246,125.55636244411605,92.01445258127312,91.41658518805767,77.30573592597696,91.88121227483639,74.74701435271503,76.90850493622152,76.47472795226614,74.90514562680697,76.73404584573161,126.88463357665086,73.03361307598973,84.92596372203023,75.37670410023446,131.11085813373478,134.69267893457706,119.09718348151645,122.3789086173513,78.45148157558418,71.37579104147825,74.39519078520873,115.1116969588884,45.931324187179854,65.2437738529317,70.26808392181023,133.62614915202388,69.69324415461281,78.10629688187646,123.00659443120479,96.17880782495362,126.86624391056564,70.5671900172224,52.1574622922477,77.51702123949156,104.0668068039978,135.1715468142757,91.12855289306547,58.8960783962155,123.57125150576118,73.10732576120846,70.66069003310038,70.72500037667086,74.72690057229525,122.55061214461271,126.78858280413114,75.24616862865142,77.42438295868844,76.94077721405793,78.03093091869908,117.04434118537985,114.25253715135723,56.77083196168848,90.63868727134745,122.67030802352248,77.53563850322782,127.47882562807365,118.9565530508561,72.10207897949977,57.15839269919666,74.62019182528694,126.85888252532804,135.1115894405049,130.3256944114157,74.96738240118223,71.69493006167846,74.91522221883578,133.8889630865454,69.89408968050756,95.46170046479405,126.41043029506993,41.52902351465016,112.13598333422593,104.7315890308559,68.45058463760708,124.19030524785829,129.06201976560848,71.42647294574385,31.363714833709267,69.6461426581073,62.36424365705176,76.41695186210958,73.96444298648873,99.94656322102468,91.4788143664485,135.45581120382448,70.08742814917943,92.00278544543829,76.57412954713942,76.1378603149035,98.62284488314315,73.95297904943388,92.36486285910955,90.05193345746063,121.29866605197836,49.705349341359344,73.81722699353327,82.44011975137501,127.90629891412127,69.49373984930943,76.64853017472417,118.58429654163936,134.9436923254703,136.265566991011,78.91089698954433,85.23446147909421,77.0484581559684,133.8129299382104,133.90907669332995,77.20046293101034,75.36691378146425,71.38028698025533,71.41500080192002,63.62090526451404,126.8245725062834,75.79856001448906,100.38149613726819,69.89820760540672,62.49996530055889,60.509165630784786,61.00146838411537,59.22022175874176,73.67917579316436,127.73725572340804,77.67600500064445,71.76671966772965,126.33962612423471,133.62944520750233,133.45798681995356,93.80467516847963,117.04697859965113,76.56360677683085,123.00418488719876,79.77255811874578,94.46660607891197,69.28109895015498,135.64574694466606,73.09866410565672,72.68144149057211,71.83490565752953,128.51998839391547,118.75328336923742,61.04018310153447,71.03806882308692,89.46505315797953,121.55181032047021,75.91034559445107,75.07922091044345,118.06445422158023,57.90318740402672,84.72325904625608,77.4053725712508,105.74465822736919,120.48434544448274,76.83065185478728,71.55009980428672,44.82865666596295,71.630301849765,68.56885280777564,65.02657379497549,71.9755775196391,128.7914643978822,99.32343220195779,134.8967723161591,75.22152108715653,120.60656677936423,115.5757703867265,77.86017252762808,126.15255168879654,134.0122111853132,104.56363712980145,116.43515678406428,49.26281472091912,76.25288457425081,78.56190834182603,71.85210104653385,92.06599747134968,118.6546490599451,77.60333882656472,71.30242292981032,82.09338181512018,89.20171086457626,77.35016712211245,89.63429289429882,75.92812037527084,75.32108342923812,50.356285564695156,111.71145799711108,76.6007594150824,119.72183215177947,78.28775263496262,76.6377355271503,73.66398556930632,120.75328390211004,123.18695729916998,125.77036528931433,75.44262706002289,78.04223621978022,104.8408172418138,133.57002680762008,71.23773237595974,72.918563291281,69.46632121062456,135.01424102645584,123.91100258011755,73.19130297433303,78.46686146571628,70.2769369280992,100.05298252421692,78.48931094487716,112.21629668492982,65.84093921923576,120.2515099167324,76.67222459622887,77.7271384428827,76.5602509226547,76.86788759847332,112.54202842381581,76.81768458175092,75.88084303836709,64.74879800343338,82.58742497769975,73.18684119674663,75.02569803150034,78.56687768308538,75.63510763900709,60.50796340402671,126.13736148769429,82.8243247382971,124.80493452286136,91.64168994744385,83.88177907535638,77.42694599442217,89.30555369655217,81.1793960596451,49.070532914010165,70.35437594534385,71.69194413451261,74.6902574745275,74.74625638552652,74.71812088603207,76.76001152213912,76.66445846516073,77.54939743290481,78.28381621666907,73.71779923144702,76.98273973039701,76.67355861044011,71.76799279976446,75.69418197793308,70.22626703702265,127.40638995629953,98.3221259478772)
te=c(116.8376060426227, 76.39487532860365,87.1191330083112,113.21581570337447,108.6738558923766,130.00716080860897,133.46601304586716,55.748976668140756,131.9185299543106,92.97181834232603,29.851810480738678,127.23413138992656,70.65925870887453,103.10781106925631,85.44929332875923,125.51389814335714,28.317135838087093,87.29118622030245,72.12697888127647,75.35740077957534,49.65195897612196,107.36659323126923,74.35481157370637,96.20124589931,95.36573640066003,100.49716045412727,125.387423688541,83.53743670845232,90.18839968346315,76.24485531924799,90.1953799463994,67.5014346822298,70.89417020144668,66.62396430474783,74.80075536320403,72.18946345236058,126.71485857298414,72.9247175397282,76.69352416334625,75.27010152095023,113.12880089795442,119.41657610323446,118.9207161167013,96.44473421670241,73.39723724456938,58.94221862271803,74.29449199453329,99.01076800361115,44.303165612140134,59.66011187487637,69.83739654081714,133.45695374758606,69.16879278643097,74.76995280006444,87.37619147564973,94.50934772050799,106.8258342373804,67.29608655070612,31.259824887643198,76.21304989704332,97.18268114887944,132.14283651411682,89.66009015779065,34.267972218391314,110.59944359586218,73.01529261800687,24.802002533217042,70.26518656861744,74.62896640190446,98.10837555420615,125.4771370298781,75.14747840534893,76.14913537720419,71.84758801175569,76.15704678463094,95.65559910161224,98.45996639727109,55.50411397214414,80.53340575623062,109.7155454602051,74.53592110169001,102.73637723501373,113.43112311249014,67.35926272176357,55.94556525460282,74.52120079255324,126.68933863150703,131.98780031562572,86.67173187592086,65.33827141789352,68.33817412710141,74.80990135413727,133.7207634126268,69.34484231208125,89.53498982986477,126.24205533007033,39.846730716041286,111.53729080265336,103.754622409849,25.753151725652504,109.01581058477315,128.89327158486208,71.02524883750931,29.436867981133123,69.15311244562719,48.91307574768607,74.11841393516596,71.73722548453871,99.01848006398961,89.81774171790798,95.30906367524082,69.62152474260824,89.04066874271938,76.44470166422961,71.74786383942043,93.13382196559961,73.84844467352971,86.8513334017489,83.19400810056779,121.12947248641652,33.34178736700408,73.71832612911255,81.09160801674463,123.86491608028976,69.01188868398539,76.50771571005234,108.70394273348592,124.64144251373904,111.30336304713384,74.02235563719596,72.24186974859721,73.70086419716885,133.64562253383926,133.73911249504994,74.35920897829978,75.2606054527717,27.180355916799076,67.881498850165,62.92467198362204,89.80972602210024,71.4944431535017,88.83328326578074,69.3426046804409,26.014946729674772,52.46910313013477,42.20069463500706,31.237712574284163,72.71228403443371,110.13580666777408,72.3506278038756,67.58130558543985,126.17097775616395,133.46049546982746,133.28883710270114,91.89870069507438,116.74373037227078,76.43382295695505,105.94256160570673,77.37601334375937,92.63255741618241,68.77797907454527,123.50774266039623,73.00105868044089,72.58020295998844,68.50885323212479,88.8327722393582,118.57307115034612,37.075737725796955,67.49568025916953,88.16204344697165,99.1295497625418,71.94115387788753,74.98899219353547,106.5929986309181,41.04556017599084,79.47380035328169,73.93799954607275,104.73559851965021,104.56822866799634,76.60298357099522,61.45081474565273,24.010920787097636,62.54152486477627,54.75676328591429,56.75215470839675,71.68267831260347,104.55640550280556,85.91178204234492,132.07610402963365,75.1171178319759,120.43822594638829,115.11698985766509,76.17717979547551,125.98389825066945,133.84357105886733,103.85023941367126,116.12417476379738,48.170222595606624,71.68546649051657,72.15754172345247,69.84763192346581,89.10234082063134,118.47798101002235,76.16137525582508,70.90066217667975,80.79718457769532,80.06841604121156,71.40382762020688,78.70960871136346,70.42516154702831,75.22150668381872,37.666035241480465,111.11346589669886,76.466771109279,119.55153486602073,77.30738012896812,76.419337150535,73.5633814350715,120.5848735533506,108.81173533689262,107.27637485445395,72.4200224688052,76.00542091027677,93.96688708831208,133.40127437925977,67.4409507718419,70.15505520056891,69.14252927758086,131.7312387863865,123.74120218417981,39.66629125156946,76.06097568054089,69.79520645043834,99.1419728578762,73.10585987868753,111.61594366560739,60.984086195524384,96.50847124544718,74.23118763427371,74.36146070140781,76.44648971571905,72.05474200085558,100.57255759841775,76.64362564739608,73.46520870699675,61.05713534785942,24.779911735897066,73.08463046582739,72.04257294719942,74.37449857833975,75.49255147088301,59.46994781639797,86.29999093493262,81.49809607057857,124.6352074929388,83.86244361331794,75.07727268571874,76.19366359873999,87.79074811439015,79.9403540437116,47.945604442627136,69.86101194316605,69.9546052284581,74.58059726846966,74.63541346406072,74.61301302121136,74.18805076491961,76.46885128445874,76.22109591577683,70.77517594778831,72.3362872990811,72.08361790437671,76.50077767509639,67.09253449731665,70.99181360981788,67.87180473259704,95.85821917165748,88.9881988512539)
div_traj=c(0, 1,2,3,4,5,6,7,8,9,10,11,12,13,12,13,12,11,10,11,12,13,14,13,12,13,12,11,10,9,8,7,6,5,6,7,8,7,8,7,8,9,10,11,12,13,14,15,16,17,16,17,18,19,20,21,20,19,20,21,20,19,20,21,20,21,22,23,22,21,20,21,20,19,20,21,22,21,20,21,20,21,22,23,24,25,26,27,28,29,30,29,30,31,30,31,30,31,32,31,32,31,32,33,32,33,34,35,34,33,34,35,36,37,36,35,36,35,36,35,36,37,36,35,34,35,36,37,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,23,24,23,24,23,24,23,24,25,24,23,22,21,20,19,20,21,22,23,22,21,20,19,20,19,20,19,20,19,18,17,16,17,16,15,16,15,14,15,14,15,14,15,14,13,12,13,14,15,16,15,16,17,18,19,20,21,20,19,20,19,18,17,18,17,18,19,20,19,18,17,16,15,14,13,12,11,10,11,10,9,8,7,6,7,8,9,10,9,8,7,8,9,10,11,10,11,10,9,8,7,6,7,6,7,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,27,28,27,28,29,30,31,32,33,34,35,36,37,38,37,38,39,40,41,42,41,42,41,42,43,44,45,46,45,44,45,44,43,42,41,40,39,40,39,40,39,38,37,36,35,34,33,32,33,32,31,32,33,34,35,36,37,36,37,38,39,38,39,38,37,38,39,38,37,36,37,36,37,36,37,38,39,38,37,36,37,38,39,40,41,40,39,40,39,38,37,36,37,38,37,36,35,34,33,32,31,30,29,30,31,30,29,30,29,30,29,30,31,30,29,28,29,30,31,30,31,30,31,30,29,28,29,28,29,28,27,26,25,24,23,22,21,22,21,20,19,20,19,20,19,20,21,22,21,20,21,22,21,20,21,22,21,22,23,22,23,24,25,26,27,26,25,24,23,22,23,24,23,24,23,24,25,26,25,26,25,26,25,26,27,26,25,24,23,24,25,24,25,26,25,24,25,24,23,22,21,20,21,20,21,20,19,18,17,16,15,14,13,12,11,10,11,10,11,12,13,14,13,12,13,14,15,14,15,14,15,16,15,16,17,16,15,16,15,16,17,18,19,20,19,18,17,16,15,14,15,16,17,18,17,18,19,18,17,16,17,18,17,16,17,16,15,14,13,12,11,10,11,10,9,8,7,6,5,4,3,2,1)
time_events=c(136.265566991011, 135.64574694466606,135.45581120382448,135.1715468142757,135.1115894405049,135.0642910248447,135.01424102645584,134.9436923254703,134.8967723161591,134.69267893457706,134.0122111853132,133.90907669332995,133.8889630865454,133.84357105886733,133.8129299382104,133.73911249504994,133.7207634126268,133.64562253383926,133.63437762427358,133.62944520750233,133.62614915202388,133.57002680762008,133.46601304586716,133.46049546982746,133.45798681995356,133.45695374758606,133.40127437925977,133.28883710270114,132.14283651411682,132.07610402963365,131.98780031562572,131.9185299543106,131.7312387863865,131.11085813373478,130.3256944114157,130.1759510271781,130.00716080860897,129.06201976560848,128.89327158486208,128.7914643978822,128.51998839391547,127.9340939480661,127.90629891412127,127.73725572340804,127.48781313845708,127.47882562807365,127.40638995629953,127.40357571734131,127.2508672158246,127.23413138992656,126.88463357665086,126.86624391056564,126.85888252532804,126.8245725062834,126.78858280413114,126.71485857298414,126.68933863150703,126.41043029506993,126.33962612423471,126.24205533007033,126.17097775616395,126.15255168879654,126.13736148769429,125.98389825066945,125.77036528931433,125.68294738101535,125.55636244411605,125.51389814335714,125.4771370298781,125.387423688541,124.80493452286136,124.64144251373904,124.6352074929388,124.19030524785829,124.02384064904058,123.91100258011755,123.86491608028976,123.74120218417981,123.57125150576118,123.50774266039623,123.43630586932078,123.18695729916998,123.00659443120479,123.00418488719876,122.67030802352248,122.55061214461271,122.3789086173513,121.86355857192858,121.55181032047021,121.29866605197836,121.12947248641652,120.75328390211004,120.60656677936423,120.5848735533506,120.48434544448274,120.43822594638829,120.2515099167324,119.72183215177947,119.55153486602073,119.51112900914453,119.41657610323446,119.09718348151645,118.9565530508561,118.9207161167013,118.75328336923742,118.6546490599451,118.58429654163936,118.57307115034612,118.47798101002235,118.06445422158023,117.04697859965113,117.04434118537985,117.01521080584229,116.8376060426227,116.74373037227078,116.43515678406428,116.12417476379738,115.5757703867265,115.11698985766509,115.1116969588884,114.25253715135723,113.43112311249014,113.21581570337447,113.12880089795442,112.54202842381581,112.21629668492982,112.13598333422593,111.71145799711108,111.61594366560739,111.53729080265336,111.30336304713384,111.11346589669886,110.59944359586218,110.13580666777408,109.7155454602051,109.01581058477315,108.81173533689262,108.70394273348592,108.6738558923766,107.36659323126923,107.27637485445395,106.8258342373804,106.5929986309181,105.94256160570673,105.74465822736919,104.8408172418138,104.73559851965021,104.7315890308559,104.56822866799634,104.56363712980145,104.55640550280556,104.30866050057222,104.0668068039978,103.85023941367126,103.754622409849,103.10781106925631,102.73637723501373,100.57255759841775,100.49716045412727,100.38149613726819,100.05298252421692,99.94656322102468,99.32343220195779,99.1419728578762,99.1295497625418,99.01848006398961,99.01076800361115,98.62284488314315,98.45996639727109,98.3221259478772,98.10837555420615,97.56701320225781,97.18268114887944,96.50847124544718,96.44473421670241,96.20124589931,96.17880782495362,95.85821917165748,95.65559910161224,95.46170046479405,95.36573640066003,95.30906367524082,94.72929790956566,94.50934772050799,94.46660607891197,93.96688708831208,93.80467516847963,93.13382196559961,92.97181834232603,92.63255741618241,92.36486285910955,92.06599747134968,92.01445258127312,92.00278544543829,91.89870069507438,91.88121227483639,91.64168994744385,91.4788143664485,91.41658518805767,91.12855289306547,90.63868727134745,90.1953799463994,90.18839968346315,90.05193345746063,89.81774171790798,89.80972602210024,89.66009015779065,89.63429289429882,89.53498982986477,89.46505315797953,89.30555369655217,89.20171086457626,89.10234082063134,89.04066874271938,88.9881988512539,88.83328326578074,88.8327722393582,88.16204344697165,87.79074811439015,87.37619147564973,87.29118622030245,87.1191330083112,86.86580809031211,86.8513334017489,86.67173187592086,86.29999093493262,85.91178204234492,85.44929332875923,85.23446147909421,84.92596372203023,84.72325904625608,83.88177907535638,83.86244361331794,83.53743670845232,83.19400810056779,82.8243247382971,82.58742497769975,82.44011975137501,82.09338181512018,81.49809607057857,81.1793960596451,81.09160801674463,80.79718457769532,80.53340575623062,80.06841604121156,79.9403540437116,79.77255811874578,79.47380035328169,78.91089698954433,78.70960871136346,78.56687768308538,78.56190834182603,78.48931094487716,78.46686146571628,78.45148157558418,78.28775263496262,78.28381621666907,78.10629688187646,78.04223621978022,78.03093091869908,77.86017252762808,77.82872615842399,77.7271384428827,77.67600500064445,77.60333882656472,77.54939743290481,77.53563850322782,77.51702123949156,77.42694599442217,77.42438295868844,77.4053725712508,77.39815083586485,77.37601334375937,77.35016712211245,77.30738012896812,77.30573592597696,77.20046293101034,77.0484581559684,76.98273973039701,76.94077721405793,76.90850493622152,76.86788759847332,76.83065185478728,76.81768458175092,76.76001152213912,76.73404584573161,76.69352416334625,76.67355861044011,76.67222459622887,76.66445846516073,76.64942190962122,76.64853017472417,76.64362564739608,76.6377355271503,76.60298357099522,76.6007594150824,76.57412954713942,76.56360677683085,76.5602509226547,76.51431319961331,76.50771571005234,76.50077767509639,76.47472795226614,76.46885128445874,76.466771109279,76.44648971571905,76.44470166422961,76.43382295695505,76.419337150535,76.41695186210958,76.39487532860365,76.25288457425081,76.24485531924799,76.22109591577683,76.21304989704332,76.19366359873999,76.17717979547551,76.16137525582508,76.15704678463094,76.14913537720419,76.1378603149035,76.06097568054089,76.00542091027677,75.92812037527084,75.91034559445107,75.88084303836709,75.79856001448906,75.69418197793308,75.63510763900709,75.49255147088301,75.44262706002289,75.37670410023446,75.36691378146425,75.35740077957534,75.32108342923812,75.27010152095023,75.2606054527717,75.24616862865142,75.22152108715653,75.22150668381872,75.14747840534893,75.1171178319759,75.07922091044345,75.07727268571874,75.02569803150034,74.98899219353547,74.96738240118223,74.91522221883578,74.90514562680697,74.80990135413727,74.80075536320403,74.76995280006444,74.74701435271503,74.74625638552652,74.72690057229525,74.71812088603207,74.6902574745275,74.63541346406072,74.62896640190446,74.62019182528694,74.61301302121136,74.58059726846966,74.53592110169001,74.52120079255324,74.46720864347382,74.39519078520873,74.37449857833975,74.36146070140781,74.35920897829978,74.35481157370637,74.29449199453329,74.23118763427371,74.18805076491961,74.11841393516596,74.02235563719596,73.96444298648873,73.95297904943388,73.93799954607275,73.84844467352971,73.81722699353327,73.71832612911255,73.71779923144702,73.70086419716885,73.67917579316436,73.66398556930632,73.5633814350715,73.46520870699675,73.39723724456938,73.19130297433303,73.18684119674663,73.10732576120846,73.10585987868753,73.09866410565672,73.08463046582739,73.03361307598973,73.01529261800687,73.00105868044089,72.9247175397282,72.918563291281,72.71228403443371,72.68144149057211,72.58020295998844,72.4200224688052,72.3506278038756,72.3362872990811,72.24186974859721,72.18946345236058,72.15754172345247,72.12697888127647,72.10207897949977,72.08361790437671,72.05474200085558,72.04257294719942,71.9755775196391,71.94115387788753,71.85210104653385,71.84758801175569,71.83490565752953,71.76799279976446,71.76671966772965,71.74786383942043,71.73722548453871,71.69493006167846,71.69194413451261,71.68546649051657,71.68267831260347,71.630301849765,71.55009980428672,71.4944431535017,71.42647294574385,71.41500080192002,71.40382762020688,71.38028698025533,71.37579104147825,71.30242292981032,71.23773237595974,71.03806882308692,71.02524883750931,70.99181360981788,70.90066217667975,70.89417020144668,70.77517594778831,70.72500037667086,70.66069003310038,70.65925870887453,70.5671900172224,70.42516154702831,70.35437594534385,70.2769369280992,70.26808392181023,70.26518656861744,70.22626703702265,70.15505520056891,70.08742814917943,69.9546052284581,69.89820760540672,69.89408968050756,69.86101194316605,69.84763192346581,69.83739654081714,69.79520645043834,69.69324415461281,69.6461426581073,69.62152474260824,69.49373984930943,69.46632121062456,69.34484231208125,69.3426046804409,69.28109895015498,69.16879278643097,69.15311244562719,69.14252927758086,69.01188868398539,68.77797907454527,68.56885280777564,68.50885323212479,68.45058463760708,68.33817412710141,67.881498850165,67.87180473259704,67.58130558543985,67.5014346822298,67.49568025916953,67.4409507718419,67.35926272176357,67.29608655070612,67.09253449731665,66.62396430474783,65.84093921923576,65.33827141789352,65.2437738529317,65.02657379497549,64.74879800343338,63.62090526451404,62.92467198362204,62.54152486477627,62.49996530055889,62.36424365705176,61.63454022823587,61.45081474565273,61.434950729952554,61.05713534785942,61.04018310153447,61.00146838411537,60.984086195524384,60.509165630784786,60.50796340402671,59.66011187487637,59.46994781639797,59.22022175874176,58.94221862271803,58.8960783962155,57.90318740402672,57.15839269919666,57.05062440152668,56.77083196168848,56.75215470839675,55.94556525460282,55.748976668140756,55.50411397214414,54.75676328591429,52.46910313013477,52.1574622922477,50.692506209246766,50.356285564695156,49.705349341359344,49.65195897612196,49.26281472091912,49.070532914010165,48.91307574768607,48.170222595606624,47.945604442627136,45.931324187179854,44.82865666596295,44.303165612140134,42.20069463500706,41.52902351465016,41.04556017599084,39.846730716041286,39.66629125156946,37.666035241480465,37.075737725796955,34.267972218391314,33.34178736700408,31.363714833709267,31.259824887643198,31.237712574284163,29.851810480738678,29.436867981133123,28.317135838087093,27.180355916799076,26.014946729674772,25.753151725652504,24.802002533217042,24.779911735897066,24.010920787097636)

# Add 175 to all time values
ts <- ts + 175
te <- te + 175
time_events <- time_events + 175

# Create data frame for lineages plot
lineages_df <- data.frame(
  start = -te,
  end = -ts,
  y = 1:length(ts)
)

# Create data frame for diversity trajectory
diversity_df <- data.frame(
  time = -time_events,
  diversity = div_traj
)
# Function to format axis labels without negative signs
format_labels <- function(x) {
 return(sprintf("%.0f", abs(x)))
}

# Plot 2: Diversity trajectory
p2 <- ggplot(diversity_df, aes(x = time, y = diversity)) +
 coord_geo(xlim = c(-300, -200), expand=FALSE, clip = "on",
           dat = list("international epochs", "international periods"), abbrv = list(TRUE, FALSE), 
           pos = list("bottom", "bottom"), alpha = 1, height = unit(2, "line"),
           rot = 0, size = list(6,5), neg = T) +
 geom_step() +
 geom_vline(xintercept = c(-65, -200, -251, -367, -445), 
            linetype = "dashed", color = "gray") +
 scale_x_continuous(limits = c(-max(ts)-1, -200),
                    breaks = seq(-300, -200, by = 10),
                    labels = format_labels) +
 labs(title = "Temnospondyli Diversity trajectory",
      x = "Time (Ma)",
      y = "Number of lineages") +
 theme_classic() +
 theme(plot.margin = unit(c(2, 1, 1, 1), "cm"),
       plot.title = element_text(size = 30, face = "bold", hjust = 0.5, margin = margin(b = 30)),
       axis.title.x = element_text(size = 22, face = "bold", margin = margin(t = 30)),
       axis.title.y = element_text(size = 22, face = "bold", margin = margin(r = 26)),
       axis.text = element_text(size = 18, face = "bold"))

# Display plots in RStudio
grid.arrange(p2, ncol = 1)

# Save to PDF
pdf("C:\\Users\\SimoesLabAdmin\\Documents\\BDNN_Arielli\\temnospondyli\\mcmc_fixshift_predictors\\C_bdnn_minmax\\temnospondyli_ltt.pdf", width = 10, height = 10)
print(p2)
dev.off()