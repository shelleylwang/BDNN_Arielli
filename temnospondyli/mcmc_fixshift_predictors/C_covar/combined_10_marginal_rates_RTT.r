# 1 files combined:
# 	C:\Users\SimoesLabAdmin\Documents\BDNN_Arielli\temnospondyli\mcmc_fixshift_predictors\C_covar/combined_10_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/temnospondyli/mcmc_fixshift_predictors/C_covar/C_covar_tem_combined_10_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.0,7.4e-05,7.4e-05,7.4e-05,7.4e-05,7.4e-05,7.4e-05,2.3e-05,2.3e-05,2.3e-05,2.3e-05,2.3e-05,2.3e-05,2.3e-05,2.3e-05,2.3e-05,0.000865,0.000865,0.000865,0.000865,0.000865,0.000865,0.000865,0.000865,0.000865,0.000865,0.031675,0.031675,0.031675,0.031675,0.031675,0.031675,0.031675,0.031675,0.031675,0.031675,0.037579,0.037579,0.037579,0.037579,0.037579,0.142837,0.142837,0.142837,0.142837,0.142837,0.381638,0.381638,0.381638,0.381638,0.381638,0.152704,0.152704,0.152704,0.152704,0.152704,0.152704,0.152704,0.000171,0.000171,0.000171,0.000171,0.000171,0.065113,0.065113,0.065113,0.065113,0.065113,0.065113,0.065113,0.065113,0.065113,0.020647,0.020647,0.020647,0.020647,0.020647,0.020647,0.020647,0.020647,0.020647,0.020647,0.007553,0.007553,0.007553,0.007553,0.007553,0.007553,0.007553,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114,0.146114)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.066252,0.072539,0.072539,0.072539,0.072539,0.072539,0.072539,0.069191,0.069191,0.069191,0.069191,0.069191,0.069191,0.069191,0.069191,0.069191,0.056572,0.056572,0.056572,0.056572,0.056572,0.056572,0.056572,0.056572,0.056572,0.056572,0.14262,0.14262,0.14262,0.14262,0.14262,0.14262,0.14262,0.14262,0.14262,0.14262,0.260995,0.260995,0.260995,0.260995,0.260995,0.356597,0.356597,0.356597,0.356597,0.356597,0.698765,0.698765,0.698765,0.698765,0.698765,0.44453,0.44453,0.44453,0.44453,0.44453,0.44453,0.44453,0.181458,0.181458,0.181458,0.181458,0.181458,0.203643,0.203643,0.203643,0.203643,0.203643,0.203643,0.203643,0.203643,0.203643,0.083612,0.083612,0.083612,0.083612,0.083612,0.083612,0.083612,0.083612,0.083612,0.083612,0.064456,0.064456,0.064456,0.064456,0.064456,0.064456,0.064456,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517,0.233517)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.0,0.087695,0.087695,0.087695,0.087695,0.087695,0.087695,4e-06,4e-06,4e-06,4e-06,4e-06,4e-06,4e-06,4e-06,4e-06,0.000552,0.000552,0.000552,0.000552,0.000552,0.000552,0.000552,0.000552,0.000552,0.000552,0.027411,0.027411,0.027411,0.027411,0.027411,0.027411,0.027411,0.027411,0.027411,0.027411,0.01983,0.01983,0.01983,0.01983,0.01983,0.171548,0.171548,0.171548,0.171548,0.171548,0.388866,0.388866,0.388866,0.388866,0.388866,0.069707,0.069707,0.069707,0.069707,0.069707,0.069707,0.069707,0.060715,0.060715,0.060715,0.060715,0.060715,0.039816,0.039816,0.039816,0.039816,0.039816,0.039816,0.039816,0.039816,0.039816,0.030057,0.030057,0.030057,0.030057,0.030057,0.030057,0.030057,0.030057,0.030057,0.030057,0.019042,0.019042,0.019042,0.019042,0.019042,0.019042,0.019042,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891,0.079891)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.34991,0.363656,0.363656,0.363656,0.363656,0.363656,0.363656,0.097396,0.097396,0.097396,0.097396,0.097396,0.097396,0.097396,0.097396,0.097396,0.078649,0.078649,0.078649,0.078649,0.078649,0.078649,0.078649,0.078649,0.078649,0.078649,0.13097,0.13097,0.13097,0.13097,0.13097,0.13097,0.13097,0.13097,0.13097,0.13097,0.267649,0.267649,0.267649,0.267649,0.267649,0.442218,0.442218,0.442218,0.442218,0.442218,0.679501,0.679501,0.679501,0.679501,0.679501,0.273719,0.273719,0.273719,0.273719,0.273719,0.273719,0.273719,0.352538,0.352538,0.352538,0.352538,0.352538,0.259449,0.259449,0.259449,0.259449,0.259449,0.259449,0.259449,0.259449,0.259449,0.139993,0.139993,0.139993,0.139993,0.139993,0.139993,0.139993,0.139993,0.139993,0.139993,0.104288,0.104288,0.104288,0.104288,0.104288,0.104288,0.104288,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038,0.147038)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.317741,-0.331404,-0.331404,-0.331404,-0.331404,-0.331404,-0.331404,-0.064244,-0.064244,-0.064244,-0.064244,-0.064244,-0.064244,-0.064244,-0.064244,-0.064244,-0.065663,-0.065663,-0.065663,-0.065663,-0.065663,-0.065663,-0.065663,-0.065663,-0.065663,-0.065663,-0.047918,-0.047918,-0.047918,-0.047918,-0.047918,-0.047918,-0.047918,-0.047918,-0.047918,-0.047918,-0.178588,-0.178588,-0.178588,-0.178588,-0.178588,-0.220793,-0.220793,-0.220793,-0.220793,-0.220793,-0.199028,-0.199028,-0.199028,-0.199028,-0.199028,-0.054495,-0.054495,-0.054495,-0.054495,-0.054495,-0.054495,-0.054495,-0.297894,-0.297894,-0.297894,-0.297894,-0.297894,-0.161777,-0.161777,-0.161777,-0.161777,-0.161777,-0.161777,-0.161777,-0.161777,-0.161777,-0.089891,-0.089891,-0.089891,-0.089891,-0.089891,-0.089891,-0.089891,-0.089891,-0.089891,-0.089891,-0.073201,-0.073201,-0.073201,-0.073201,-0.073201,-0.073201,-0.073201,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833,0.024833)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.0,-0.06207,-0.06207,-0.06207,-0.06207,-0.06207,-0.06207,0.050081,0.050081,0.050081,0.050081,0.050081,0.050081,0.050081,0.050081,0.050081,0.039681,0.039681,0.039681,0.039681,0.039681,0.039681,0.039681,0.039681,0.039681,0.039681,0.089323,0.089323,0.089323,0.089323,0.089323,0.089323,0.089323,0.089323,0.089323,0.089323,0.158126,0.158126,0.158126,0.158126,0.158126,0.098083,0.098083,0.098083,0.098083,0.098083,0.154165,0.154165,0.154165,0.154165,0.154165,0.279458,0.279458,0.279458,0.279458,0.279458,0.279458,0.279458,0.066254,0.066254,0.066254,0.066254,0.066254,0.087639,0.087639,0.087639,0.087639,0.087639,0.087639,0.087639,0.087639,0.087639,0.02627,0.02627,0.02627,0.02627,0.02627,0.02627,0.02627,0.02627,0.02627,0.02627,0.023897,0.023897,0.023897,0.023897,0.023897,0.023897,0.023897,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324,0.13324)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.019763271,0.02635693,0.02635693,0.02635693,0.02635693,0.02635693,0.02635693,0.028162032,0.028162032,0.028162032,0.028162032,0.028162032,0.028162032,0.028162032,0.028162032,0.028162032,0.025425906,0.025425906,0.025425906,0.025425906,0.025425906,0.025425906,0.025425906,0.025425906,0.025425906,0.025425906,0.084495048,0.084495048,0.084495048,0.084495048,0.084495048,0.084495048,0.084495048,0.084495048,0.084495048,0.084495048,0.142432349,0.142432349,0.142432349,0.142432349,0.142432349,0.241623748,0.241623748,0.241623748,0.241623748,0.241623748,0.529950295,0.529950295,0.529950295,0.529950295,0.529950295,0.277743574,0.277743574,0.277743574,0.277743574,0.277743574,0.277743574,0.277743574,0.07380735,0.07380735,0.07380735,0.07380735,0.07380735,0.133795552,0.133795552,0.133795552,0.133795552,0.133795552,0.133795552,0.133795552,0.133795552,0.133795552,0.053313906,0.053313906,0.053313906,0.053313906,0.053313906,0.053313906,0.053313906,0.053313906,0.053313906,0.053313906,0.033956146,0.033956146,0.033956146,0.033956146,0.033956146,0.033956146,0.033956146,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321,0.191293321)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.159494667,0.22051126,0.22051126,0.22051126,0.22051126,0.22051126,0.22051126,0.034790751,0.034790751,0.034790751,0.034790751,0.034790751,0.034790751,0.034790751,0.034790751,0.034790751,0.035991095,0.035991095,0.035991095,0.035991095,0.035991095,0.035991095,0.035991095,0.035991095,0.035991095,0.035991095,0.072249815,0.072249815,0.072249815,0.072249815,0.072249815,0.072249815,0.072249815,0.072249815,0.072249815,0.072249815,0.140958286,0.140958286,0.140958286,0.140958286,0.140958286,0.300356383,0.300356383,0.300356383,0.300356383,0.300356383,0.534168956,0.534168956,0.534168956,0.534168956,0.534168956,0.166086396,0.166086396,0.166086396,0.166086396,0.166086396,0.166086396,0.166086396,0.200001795,0.200001795,0.200001795,0.200001795,0.200001795,0.14634105,0.14634105,0.14634105,0.14634105,0.14634105,0.14634105,0.14634105,0.14634105,0.14634105,0.086329247,0.086329247,0.086329247,0.086329247,0.086329247,0.086329247,0.086329247,0.086329247,0.086329247,0.086329247,0.059127559,0.059127559,0.059127559,0.059127559,0.059127559,0.059127559,0.059127559,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742,0.111742742)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.139731387,-0.19415431,-0.19415431,-0.19415431,-0.19415431,-0.19415431,-0.19415431,-0.00662871,-0.00662871,-0.00662871,-0.00662871,-0.00662871,-0.00662871,-0.00662871,-0.00662871,-0.00662871,-0.010565191,-0.010565191,-0.010565191,-0.010565191,-0.010565191,-0.010565191,-0.010565191,-0.010565191,-0.010565191,-0.010565191,0.012245189,0.012245189,0.012245189,0.012245189,0.012245189,0.012245189,0.012245189,0.012245189,0.012245189,0.012245189,0.001474073,0.001474073,0.001474073,0.001474073,0.001474073,-0.058732617,-0.058732617,-0.058732617,-0.058732617,-0.058732617,-0.004218647,-0.004218647,-0.004218647,-0.004218647,-0.004218647,0.1116572,0.1116572,0.1116572,0.1116572,0.1116572,0.1116572,0.1116572,-0.126194429,-0.126194429,-0.126194429,-0.126194429,-0.126194429,-0.012545527,-0.012545527,-0.012545527,-0.012545527,-0.012545527,-0.012545527,-0.012545527,-0.012545527,-0.012545527,-0.033015347,-0.033015347,-0.033015347,-0.033015347,-0.033015347,-0.033015347,-0.033015347,-0.033015347,-0.033015347,-0.033015347,-0.025171425,-0.025171425,-0.025171425,-0.025171425,-0.025171425,-0.025171425,-0.025171425,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596,0.079550596)
trans=0.5
age=(0:(134-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.7686415), xlim = c(-140.7,-20.3), ylab = 'Speciation rate', xlab = 'Ma',main='Temnospondyli Marginal RTT' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.7474511), xlim = c(-140.7,-20.3), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.3645444, 0.3074038), xlim = c(-140.7,-20.3), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,rev(1/M_mean),type = 'n', xlim = c(-140.7,-20.3), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()